!function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return n(r?r:t)},l,l.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t){return new a["default"](t)}var o=t("./src/draw"),a=i(o);console.log("running"),window.mapboxgl?mapboxgl.Draw=n:e.exports=n},{"./src/draw":147}],2:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],3:[function(t,e,r){function i(){if(!s){s=!0;for(var t,e=a.length;e;){t=a,a=[];for(var r=-1;++r<e;)t[r]();e=a.length}s=!1}}function n(){}var o=e.exports={},a=[],s=!1;o.nextTick=function(t){a.push(t),s||setTimeout(i,0)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=n,o.addListener=n,o.once=n,o.off=n,o.removeListener=n,o.removeAllListeners=n,o.emit=n,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],4:[function(t,e,r){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],5:[function(t,e,r){(function(e,i){function n(t,e){var i={seen:[],stylize:a};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(e)?i.showHidden=e:e&&r._extend(i,e),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),u(i,t,i.depth)}function o(t,e){var r=n.styles[e];return r?"["+n.colors[r][0]+"m"+t+"["+n.colors[r][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function u(t,e,i){if(t.customInspect&&e&&T(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var n=e.inspect(i,t);return y(n)||(n=u(t,n,i)),n}var o=h(t,e);if(o)return o;var a=Object.keys(e),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),E(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(e);if(0===a.length){if(T(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(E(e))return l(e)}var _="",g=!1,x=["{","}"];if(p(e)&&(g=!0,x=["[","]"]),T(e)){var b=e.name?": "+e.name:"";_=" [Function"+b+"]"}if(w(e)&&(_=" "+RegExp.prototype.toString.call(e)),M(e)&&(_=" "+Date.prototype.toUTCString.call(e)),E(e)&&(_=" "+l(e)),0===a.length&&(!g||0==e.length))return x[0]+_+x[1];if(0>i)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var S;return S=g?c(t,e,i,m,a):a.map(function(r){return f(t,e,i,m,r,g)}),t.seen.pop(),d(S,_,x)}function h(t,e){if(b(e))return t.stylize("undefined","undefined");if(y(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return g(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function c(t,e,r,i,n){for(var o=[],a=0,s=e.length;s>a;++a)L(e,String(a))?o.push(f(t,e,r,i,String(a),!0)):o.push("");return n.forEach(function(n){n.match(/^\d+$/)||o.push(f(t,e,r,i,n,!0))}),o}function f(t,e,r,i,n,o){var a,s,h;if(h=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},h.get?s=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(s=t.stylize("[Setter]","special")),L(i,n)||(a="["+n+"]"),s||(t.seen.indexOf(h.value)<0?(s=v(r)?u(t,h.value,null):u(t,h.value,r-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),b(a)){if(o&&n.match(/^\d+$/))return s;a=JSON.stringify(""+n),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t,e,r){var i=0,n=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function v(t){return null===t}function _(t){return null==t}function g(t){return"number"==typeof t}function y(t){return"string"==typeof t}function x(t){return"symbol"==typeof t}function b(t){return void 0===t}function w(t){return S(t)&&"[object RegExp]"===A(t)}function S(t){return"object"==typeof t&&null!==t}function M(t){return S(t)&&"[object Date]"===A(t)}function E(t){return S(t)&&("[object Error]"===A(t)||t instanceof Error)}function T(t){return"function"==typeof t}function z(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function A(t){return Object.prototype.toString.call(t)}function P(t){return 10>t?"0"+t.toString(10):t.toString(10)}function I(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var k=/%[sdj%]/g;r.format=function(t){if(!y(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(n(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,o=i.length,a=String(t).replace(k,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(e){return"[Circular]"}default:return t}}),s=i[r];o>r;s=i[++r])a+=v(s)||!S(s)?" "+s:" "+n(s);return a},r.deprecate=function(t,n){function o(){if(!a){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),a=!0}return t.apply(this,arguments)}if(b(i.process))return function(){return r.deprecate(t,n).apply(this,arguments)};if(e.noDeprecation===!0)return t;var a=!1;return o};var D,R={};r.debuglog=function(t){if(b(D)&&(D=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(D)){var i=e.pid;R[t]=function(){var e=r.format.apply(r,arguments);console.error("%s %d: %s",t,i,e)}}else R[t]=function(){};return R[t]},r.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=p,r.isBoolean=m,r.isNull=v,r.isNullOrUndefined=_,r.isNumber=g,r.isString=y,r.isSymbol=x,r.isUndefined=b,r.isRegExp=w,r.isObject=S,r.isDate=M,r.isError=E,r.isFunction=T,r.isPrimitive=z,r.isBuffer=t("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",I(),r.format.apply(r,arguments))},r.inherits=t("inherits"),r._extend=function(t,e){if(!e||!S(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,_process:3,inherits:2}],6:[function(t,e,r){var i=e.exports=function(t,e){if(e||(e=16),void 0===t&&(t=128),0>=t)return"0";for(var r=Math.log(Math.pow(2,t))/Math.log(e),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,t/n))/Math.log(e)*n;for(var o=r-Math.floor(r),a="",n=0;n<Math.floor(r);n++){var s=Math.floor(Math.random()*e).toString(e);a=s+a}if(o){var u=Math.pow(e,o),s=Math.floor(Math.random()*u).toString(e);a=s+a}var h=parseInt(a,e);return h!==1/0&&h>=Math.pow(2,t)?i(t,e):a};i.rack=function(t,e,r){var n=function(n){var a=0;do{if(a++>10){if(!r)throw new Error("too many ID collisions, use more bits");t+=r}var s=i(t,e)}while(Object.hasOwnProperty.call(o,s));return o[s]=n,s},o=n.hats={};return n.get=function(t){return n.hats[t]},n.set=function(t,e){return n.hats[t]=e,n},n.bits=t||128,n.base=e||16,n}},{}],7:[function(t,e,r){!function(t,i){"object"==typeof r&&"undefined"!=typeof e?e.exports=i():"function"==typeof define&&define.amd?define(i):t.Immutable=i()}(this,function(){"use strict";function t(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function e(t){return t.value=!1,t}function r(t){t&&(t.value=!0)}function i(){}function n(t,e){e=e||0;for(var r=Math.max(0,t.length-e),i=new Array(r),n=0;r>n;n++)i[n]=t[n+e];return i}function o(t){return void 0===t.size&&(t.size=t.__iterate(s)),t.size}function a(t,e){return e>=0?+e:o(t)+ +e}function s(){return!0}function u(t,e,r){return(0===t||void 0!==r&&-r>=t)&&(void 0===e||void 0!==r&&e>=r)}function h(t,e){return c(t,e,0)}function l(t,e){return c(t,e,e)}function c(t,e,r){return void 0===t?r:0>t?Math.max(0,e+t):void 0===e?t:Math.min(e,t)}function f(t){return v(t)?t:P(t)}function d(t){return _(t)?t:I(t)}function p(t){return g(t)?t:L(t)}function m(t){return v(t)&&!y(t)?t:k(t)}function v(t){return!(!t||!t[pr])}function _(t){return!(!t||!t[mr])}function g(t){return!(!t||!t[vr])}function y(t){return _(t)||g(t)}function x(t){return!(!t||!t[_r])}function b(t){this.next=t}function w(t,e,r,i){var n=0===t?e:1===t?r:[e,r];return i?i.value=n:i={value:n,done:!1},i}function S(){return{value:void 0,done:!0}}function M(t){return!!z(t)}function E(t){return t&&"function"==typeof t.next}function T(t){var e=z(t);return e&&e.call(t)}function z(t){var e=t&&(br&&t[br]||t[wr]);return"function"==typeof e?e:void 0}function A(t){return t&&"number"==typeof t.length}function P(t){return null===t||void 0===t?B():v(t)?t.toSeq():q(t)}function I(t){return null===t||void 0===t?B().toKeyedSeq():v(t)?_(t)?t.toSeq():t.fromEntrySeq():F(t)}function L(t){return null===t||void 0===t?B():v(t)?_(t)?t.entrySeq():t.toIndexedSeq():N(t)}function k(t){return(null===t||void 0===t?B():v(t)?_(t)?t.entrySeq():t:N(t)).toSetSeq()}function D(t){this._array=t,this.size=t.length}function R(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function O(t){this._iterable=t,this.size=t.length||t.size}function j(t){this._iterator=t,this._iteratorCache=[]}function C(t){return!(!t||!t[Mr])}function B(){return Er||(Er=new D([]))}function F(t){var e=Array.isArray(t)?new D(t).fromEntrySeq():E(t)?new j(t).fromEntrySeq():M(t)?new O(t).fromEntrySeq():"object"==typeof t?new R(t):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function N(t){var e=U(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function q(t){var e=U(t)||"object"==typeof t&&new R(t);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t);return e}function U(t){return A(t)?new D(t):E(t)?new j(t):M(t)?new O(t):void 0}function V(t,e,r,i){var n=t._cache;if(n){for(var o=n.length-1,a=0;o>=a;a++){var s=n[r?o-a:a];if(e(s[1],i?s[0]:a,t)===!1)return a+1}return a}return t.__iterateUncached(e,r)}function G(t,e,r,i){var n=t._cache;if(n){var o=n.length-1,a=0;return new b(function(){var t=n[r?o-a:a];return a++>o?S():w(e,i?t[0]:a-1,t[1])})}return t.__iteratorUncached(e,r)}function J(){throw TypeError("Abstract")}function Z(){}function H(){}function W(){}function X(t,e){if(t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if(t=t.valueOf(),e=e.valueOf(),t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1}return"function"==typeof t.equals&&"function"==typeof e.equals&&t.equals(e)?!0:!1}function Y(t,e){return e?K(e,t,"",{"":t}):$(t)}function K(t,e,r,i){return Array.isArray(e)?t.call(i,r,L(e).map(function(r,i){return K(t,r,i,e)})):Q(e)?t.call(i,r,I(e).map(function(r,i){return K(t,r,i,e)})):e}function $(t){return Array.isArray(t)?L(t).map($).toList():Q(t)?I(t).map($).toMap():t}function Q(t){return t&&(t.constructor===Object||void 0===t.constructor)}function tt(t){return t>>>1&1073741824|3221225471&t}function et(t){if(t===!1||null===t||void 0===t)return 0;if("function"==typeof t.valueOf&&(t=t.valueOf(),t===!1||null===t||void 0===t))return 0;if(t===!0)return 1;var e=typeof t;if("number"===e){var r=0|t;for(r!==t&&(r^=4294967295*t);t>4294967295;)t/=4294967295,r^=t;return tt(r)}return"string"===e?t.length>Dr?rt(t):it(t):"function"==typeof t.hashCode?t.hashCode():nt(t)}function rt(t){var e=jr[t];return void 0===e&&(e=it(t),Or===Rr&&(Or=0,jr={}),Or++,jr[t]=e),e}function it(t){for(var e=0,r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return tt(e)}function nt(t){var e;if(Ir&&(e=Tr.get(t),void 0!==e))return e;if(e=t[kr],void 0!==e)return e;if(!Pr){if(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[kr],void 0!==e)return e;if(e=ot(t),void 0!==e)return e}if(e=++Lr,1073741824&Lr&&(Lr=0),Ir)Tr.set(t,e);else{if(void 0!==Ar&&Ar(t)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(Pr)Object.defineProperty(t,kr,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[kr]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[kr]=e}}return e}function ot(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}function at(t,e){if(!t)throw new Error(e)}function st(t){at(t!==1/0,"Cannot perform this action with an infinite size.")}function ut(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function ht(t){this._iter=t,this.size=t.size}function lt(t){this._iter=t,this.size=t.size}function ct(t){this._iter=t,this.size=t.size}function ft(t){var e=Dt(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=Rt,e.__iterateUncached=function(e,r){var i=this;return t.__iterate(function(t,r){return e(r,t,i)!==!1},r)},e.__iteratorUncached=function(e,r){if(e===xr){var i=t.__iterator(e,r);return new b(function(){var t=i.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(e===yr?gr:yr,r)},e}function dt(t,e,r){var i=Dt(t);return i.size=t.size,i.has=function(e){return t.has(e)},i.get=function(i,n){var o=t.get(i,cr);return o===cr?n:e.call(r,o,i,t)},i.__iterateUncached=function(i,n){var o=this;return t.__iterate(function(t,n,a){return i(e.call(r,t,n,a),n,o)!==!1},n)},i.__iteratorUncached=function(i,n){var o=t.__iterator(xr,n);return new b(function(){var n=o.next();if(n.done)return n;var a=n.value,s=a[0];return w(i,s,e.call(r,a[1],s,t),n)})},i}function pt(t,e){var r=Dt(t);return r._iter=t,r.size=t.size,r.reverse=function(){return t},t.flip&&(r.flip=function(){var e=ft(t);return e.reverse=function(){return t.flip()},e}),r.get=function(r,i){return t.get(e?r:-1-r,i)},r.has=function(r){return t.has(e?r:-1-r)},r.includes=function(e){return t.includes(e)},r.cacheResult=Rt,r.__iterate=function(e,r){var i=this;return t.__iterate(function(t,r){return e(t,r,i)},!r)},r.__iterator=function(e,r){return t.__iterator(e,!r)},r}function mt(t,e,r,i){var n=Dt(t);return i&&(n.has=function(i){var n=t.get(i,cr);return n!==cr&&!!e.call(r,n,i,t)},n.get=function(i,n){var o=t.get(i,cr);return o!==cr&&e.call(r,o,i,t)?o:n}),n.__iterateUncached=function(n,o){var a=this,s=0;return t.__iterate(function(t,o,u){return e.call(r,t,o,u)?(s++,n(t,i?o:s-1,a)):void 0},o),s},n.__iteratorUncached=function(n,o){var a=t.__iterator(xr,o),s=0;return new b(function(){for(;;){var o=a.next();if(o.done)return o;var u=o.value,h=u[0],l=u[1];if(e.call(r,l,h,t))return w(n,i?h:s++,l,o)}})},n}function vt(t,e,r){var i=Ct().asMutable();return t.__iterate(function(n,o){i.update(e.call(r,n,o,t),0,function(t){return t+1})}),i.asImmutable()}function _t(t,e,r){var i=_(t),n=(x(t)?Se():Ct()).asMutable();t.__iterate(function(o,a){n.update(e.call(r,o,a,t),function(t){return t=t||[],t.push(i?[a,o]:o),t})});var o=kt(t);return n.map(function(e){return Pt(t,o(e))})}function gt(t,e,r,i){var n=t.size;if(u(e,r,n))return t;var o=h(e,n),s=l(r,n);if(o!==o||s!==s)return gt(t.toSeq().cacheResult(),e,r,i);var c,f=s-o;f===f&&(c=0>f?0:f);var d=Dt(t);return d.size=c,!i&&C(t)&&c>=0&&(d.get=function(e,r){return e=a(this,e),e>=0&&c>e?t.get(e+o,r):r}),d.__iterateUncached=function(e,r){var n=this;if(0===c)return 0;if(r)return this.cacheResult().__iterate(e,r);var a=0,s=!0,u=0;return t.__iterate(function(t,r){return s&&(s=a++<o)?void 0:(u++,e(t,i?r:u-1,n)!==!1&&u!==c)}),u},d.__iteratorUncached=function(e,r){if(0!==c&&r)return this.cacheResult().__iterator(e,r);var n=0!==c&&t.__iterator(e,r),a=0,s=0;return new b(function(){for(;a++<o;)n.next();if(++s>c)return S();var t=n.next();return i||e===yr?t:e===gr?w(e,s-1,void 0,t):w(e,s-1,t.value[1],t)})},d}function yt(t,e,r){var i=Dt(t);return i.__iterateUncached=function(i,n){var o=this;if(n)return this.cacheResult().__iterate(i,n);var a=0;return t.__iterate(function(t,n,s){return e.call(r,t,n,s)&&++a&&i(t,n,o)}),a},i.__iteratorUncached=function(i,n){var o=this;if(n)return this.cacheResult().__iterator(i,n);var a=t.__iterator(xr,n),s=!0;return new b(function(){if(!s)return S();var t=a.next();if(t.done)return t;var n=t.value,u=n[0],h=n[1];return e.call(r,h,u,o)?i===xr?t:w(i,u,h,t):(s=!1,S())})},i}function xt(t,e,r,i){var n=Dt(t);return n.__iterateUncached=function(n,o){var a=this;if(o)return this.cacheResult().__iterate(n,o);var s=!0,u=0;return t.__iterate(function(t,o,h){return s&&(s=e.call(r,t,o,h))?void 0:(u++,n(t,i?o:u-1,a))}),u},n.__iteratorUncached=function(n,o){var a=this;if(o)return this.cacheResult().__iterator(n,o);var s=t.__iterator(xr,o),u=!0,h=0;return new b(function(){var t,o,l;do{if(t=s.next(),t.done)return i||n===yr?t:n===gr?w(n,h++,void 0,t):w(n,h++,t.value[1],t);var c=t.value;o=c[0],l=c[1],u&&(u=e.call(r,l,o,a))}while(u);return n===xr?t:w(n,o,l,t)})},n}function bt(t,e){var r=_(t),i=[t].concat(e).map(function(t){return v(t)?r&&(t=d(t)):t=r?F(t):N(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===i.length)return t;if(1===i.length){var n=i[0];if(n===t||r&&_(n)||g(t)&&g(n))return n}var o=new D(i);return r?o=o.toKeyedSeq():g(t)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=i.reduce(function(t,e){if(void 0!==t){var r=e.size;if(void 0!==r)return t+r}},0),o}function wt(t,e,r){var i=Dt(t);return i.__iterateUncached=function(i,n){function o(t,u){var h=this;t.__iterate(function(t,n){return(!e||e>u)&&v(t)?o(t,u+1):i(t,r?n:a++,h)===!1&&(s=!0),!s},n)}var a=0,s=!1;return o(t,0),a},i.__iteratorUncached=function(i,n){var o=t.__iterator(i,n),a=[],s=0;return new b(function(){for(;o;){var t=o.next();if(t.done===!1){var u=t.value;if(i===xr&&(u=u[1]),e&&!(a.length<e)||!v(u))return r?t:w(i,s++,u,t);a.push(o),o=u.__iterator(i,n)}else o=a.pop()}return S()})},i}function St(t,e,r){var i=kt(t);return t.toSeq().map(function(n,o){return i(e.call(r,n,o,t))}).flatten(!0)}function Mt(t,e){var r=Dt(t);return r.size=t.size&&2*t.size-1,r.__iterateUncached=function(r,i){var n=this,o=0;return t.__iterate(function(t,i){return(!o||r(e,o++,n)!==!1)&&r(t,o++,n)!==!1},i),o},r.__iteratorUncached=function(r,i){var n,o=t.__iterator(yr,i),a=0;return new b(function(){return(!n||a%2)&&(n=o.next(),n.done)?n:a%2?w(r,a++,e):w(r,a++,n.value,n)})},r}function Et(t,e,r){e||(e=Ot);var i=_(t),n=0,o=t.toSeq().map(function(e,i){return[i,e,n++,r?r(e,i,t):e]}).toArray();return o.sort(function(t,r){return e(t[3],r[3])||t[2]-r[2]}).forEach(i?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),i?I(o):g(t)?L(o):k(o)}function Tt(t,e,r){if(e||(e=Ot),r){var i=t.toSeq().map(function(e,i){return[e,r(e,i,t)]}).reduce(function(t,r){return zt(e,t[1],r[1])?r:t});return i&&i[0]}return t.reduce(function(t,r){return zt(e,t,r)?r:t})}function zt(t,e,r){var i=t(r,e);return 0===i&&r!==e&&(void 0===r||null===r||r!==r)||i>0}function At(t,e,r){var i=Dt(t);return i.size=new D(r).map(function(t){return t.size}).min(),i.__iterate=function(t,e){for(var r,i=this.__iterator(yr,e),n=0;!(r=i.next()).done&&t(r.value,n++,this)!==!1;);return n},i.__iteratorUncached=function(t,i){var n=r.map(function(t){return t=f(t),T(i?t.reverse():t)}),o=0,a=!1;return new b(function(){var r;return a||(r=n.map(function(t){return t.next()}),a=r.some(function(t){return t.done})),a?S():w(t,o++,e.apply(null,r.map(function(t){return t.value})))})},i}function Pt(t,e){return C(t)?e:t.constructor(e)}function It(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Lt(t){return st(t.size),o(t)}function kt(t){return _(t)?d:g(t)?p:m}function Dt(t){return Object.create((_(t)?I:g(t)?L:k).prototype)}function Rt(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):P.prototype.cacheResult.call(this)}function Ot(t,e){return t>e?1:e>t?-1:0}function jt(t){var e=T(t);if(!e){if(!A(t))throw new TypeError("Expected iterable or array-like: "+t);e=T(f(t))}return e}function Ct(t){return null===t||void 0===t?Wt():Bt(t)?t:Wt().withMutations(function(e){var r=d(t);st(r.size),r.forEach(function(t,r){return e.set(r,t)})})}function Bt(t){return!(!t||!t[Cr])}function Ft(t,e){this.ownerID=t,this.entries=e}function Nt(t,e,r){this.ownerID=t,this.bitmap=e,this.nodes=r}function qt(t,e,r){this.ownerID=t,this.count=e,this.nodes=r}function Ut(t,e,r){this.ownerID=t,this.keyHash=e,this.entries=r}function Vt(t,e,r){this.ownerID=t,this.keyHash=e,this.entry=r}function Gt(t,e,r){this._type=e,this._reverse=r,this._stack=t._root&&Zt(t._root)}function Jt(t,e){return w(t,e[0],e[1])}function Zt(t,e){return{node:t,index:0,__prev:e}}function Ht(t,e,r,i){var n=Object.create(Br);return n.size=t,n._root=e,n.__ownerID=r,n.__hash=i,n.__altered=!1,n}function Wt(){return Fr||(Fr=Ht(0))}function Xt(t,r,i){var n,o;if(t._root){var a=e(fr),s=e(dr);if(n=Yt(t._root,t.__ownerID,0,void 0,r,i,a,s),!s.value)return t;o=t.size+(a.value?i===cr?-1:1:0)}else{if(i===cr)return t;o=1,n=new Ft(t.__ownerID,[[r,i]])}return t.__ownerID?(t.size=o,t._root=n,t.__hash=void 0,t.__altered=!0,t):n?Ht(o,n):Wt()}function Yt(t,e,i,n,o,a,s,u){return t?t.update(e,i,n,o,a,s,u):a===cr?t:(r(u),r(s),new Vt(e,n,[o,a]))}function Kt(t){return t.constructor===Vt||t.constructor===Ut}function $t(t,e,r,i,n){if(t.keyHash===i)return new Ut(e,i,[t.entry,n]);var o,a=(0===r?t.keyHash:t.keyHash>>>r)&lr,s=(0===r?i:i>>>r)&lr,u=a===s?[$t(t,e,r+ur,i,n)]:(o=new Vt(e,i,n),s>a?[t,o]:[o,t]);return new Nt(e,1<<a|1<<s,u)}function Qt(t,e,r,n){t||(t=new i);for(var o=new Vt(t,et(r),[r,n]),a=0;a<e.length;a++){var s=e[a];o=o.update(t,0,void 0,s[0],s[1])}return o}function te(t,e,r,i){for(var n=0,o=0,a=new Array(r),s=0,u=1,h=e.length;h>s;s++,u<<=1){var l=e[s];void 0!==l&&s!==i&&(n|=u,a[o++]=l)}return new Nt(t,n,a)}function ee(t,e,r,i,n){for(var o=0,a=new Array(hr),s=0;0!==r;s++,r>>>=1)a[s]=1&r?e[o++]:void 0;return a[i]=n,new qt(t,o+1,a)}function re(t,e,r){for(var i=[],n=0;n<r.length;n++){var o=r[n],a=d(o);v(o)||(a=a.map(function(t){return Y(t)})),i.push(a)}return ne(t,e,i)}function ie(t){return function(e,r,i){return e&&e.mergeDeepWith&&v(r)?e.mergeDeepWith(t,r):t?t(e,r,i):r}}function ne(t,e,r){return r=r.filter(function(t){return 0!==t.size}),0===r.length?t:0!==t.size||t.__ownerID||1!==r.length?t.withMutations(function(t){for(var i=e?function(r,i){t.update(i,cr,function(t){return t===cr?r:e(t,r,i)})}:function(e,r){t.set(r,e)},n=0;n<r.length;n++)r[n].forEach(i)}):t.constructor(r[0])}function oe(t,e,r,i){var n=t===cr,o=e.next();if(o.done){var a=n?r:t,s=i(a);return s===a?t:s}at(n||t&&t.set,"invalid keyPath");var u=o.value,h=n?cr:t.get(u,cr),l=oe(h,e,r,i);return l===h?t:l===cr?t.remove(u):(n?Wt():t).set(u,l)}function ae(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,127&t}function se(t,e,r,i){var o=i?t:n(t);return o[e]=r,o}function ue(t,e,r,i){var n=t.length+1;if(i&&e+1===n)return t[e]=r,t;for(var o=new Array(n),a=0,s=0;n>s;s++)s===e?(o[s]=r,a=-1):o[s]=t[s+a];return o}function he(t,e,r){var i=t.length-1;if(r&&e===i)return t.pop(),t;for(var n=new Array(i),o=0,a=0;i>a;a++)a===e&&(o=1),n[a]=t[a+o];return n}function le(t){var e=me();if(null===t||void 0===t)return e;if(ce(t))return t;var r=p(t),i=r.size;return 0===i?e:(st(i),i>0&&hr>i?pe(0,i,ur,null,new fe(r.toArray())):e.withMutations(function(t){t.setSize(i),r.forEach(function(e,r){return t.set(r,e)})}))}function ce(t){return!(!t||!t[Vr])}function fe(t,e){this.array=t,this.ownerID=e}function de(t,e){function r(t,e,r){return 0===e?i(t,r):n(t,e,r)}function i(t,r){var i=r===s?u&&u.array:t&&t.array,n=r>o?0:o-r,h=a-r;return h>hr&&(h=hr),function(){if(n===h)return Zr;var t=e?--h:n++;return i&&i[t]}}function n(t,i,n){var s,u=t&&t.array,h=n>o?0:o-n>>i,l=(a-n>>i)+1;return l>hr&&(l=hr),function(){for(;;){if(s){var t=s();if(t!==Zr)return t;s=null}if(h===l)return Zr;var o=e?--l:h++;s=r(u&&u[o],i-ur,n+(o<<i))}}}var o=t._origin,a=t._capacity,s=we(a),u=t._tail;return r(t._root,t._level,0)}function pe(t,e,r,i,n,o,a){var s=Object.create(Gr);return s.size=e-t,s._origin=t,s._capacity=e,s._level=r,s._root=i,s._tail=n,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function me(){return Jr||(Jr=pe(0,0,ur))}function ve(t,r,i){if(r=a(t,r),r>=t.size||0>r)return t.withMutations(function(t){0>r?xe(t,r).set(0,i):xe(t,0,r+1).set(r,i)});r+=t._origin;var n=t._tail,o=t._root,s=e(dr);return r>=we(t._capacity)?n=_e(n,t.__ownerID,0,r,i,s):o=_e(o,t.__ownerID,t._level,r,i,s),s.value?t.__ownerID?(t._root=o,t._tail=n,t.__hash=void 0,t.__altered=!0,t):pe(t._origin,t._capacity,t._level,o,n):t}function _e(t,e,i,n,o,a){var s=n>>>i&lr,u=t&&s<t.array.length;if(!u&&void 0===o)return t;var h;if(i>0){var l=t&&t.array[s],c=_e(l,e,i-ur,n,o,a);return c===l?t:(h=ge(t,e),h.array[s]=c,h)}return u&&t.array[s]===o?t:(r(a),h=ge(t,e),void 0===o&&s===h.array.length-1?h.array.pop():h.array[s]=o,h)}function ge(t,e){return e&&t&&e===t.ownerID?t:new fe(t?t.array.slice():[],e)}function ye(t,e){if(e>=we(t._capacity))return t._tail;if(e<1<<t._level+ur){for(var r=t._root,i=t._level;r&&i>0;)r=r.array[e>>>i&lr],i-=ur;return r}}function xe(t,e,r){var n=t.__ownerID||new i,o=t._origin,a=t._capacity,s=o+e,u=void 0===r?a:0>r?a+r:o+r;if(s===o&&u===a)return t;if(s>=u)return t.clear();for(var h=t._level,l=t._root,c=0;0>s+c;)l=new fe(l&&l.array.length?[void 0,l]:[],n),h+=ur,c+=1<<h;c&&(s+=c,o+=c,u+=c,a+=c);for(var f=we(a),d=we(u);d>=1<<h+ur;)l=new fe(l&&l.array.length?[l]:[],n),h+=ur;var p=t._tail,m=f>d?ye(t,u-1):d>f?new fe([],n):p;if(p&&d>f&&a>s&&p.array.length){l=ge(l,n);for(var v=l,_=h;_>ur;_-=ur){var g=f>>>_&lr;v=v.array[g]=ge(v.array[g],n)}v.array[f>>>ur&lr]=p}if(a>u&&(m=m&&m.removeAfter(n,0,u)),s>=d)s-=d,u-=d,h=ur,l=null,m=m&&m.removeBefore(n,0,s);else if(s>o||f>d){for(c=0;l;){var y=s>>>h&lr;if(y!==d>>>h&lr)break;y&&(c+=(1<<h)*y),h-=ur,l=l.array[y]}l&&s>o&&(l=l.removeBefore(n,h,s-c)),l&&f>d&&(l=l.removeAfter(n,h,d-c)),c&&(s-=c,u-=c)}return t.__ownerID?(t.size=u-s,t._origin=s,t._capacity=u,t._level=h,t._root=l,t._tail=m,t.__hash=void 0,t.__altered=!0,t):pe(s,u,h,l,m)}function be(t,e,r){for(var i=[],n=0,o=0;o<r.length;o++){var a=r[o],s=p(a);s.size>n&&(n=s.size),v(a)||(s=s.map(function(t){return Y(t)})),i.push(s)}return n>t.size&&(t=t.setSize(n)),ne(t,e,i)}function we(t){return hr>t?0:t-1>>>ur<<ur}function Se(t){return null===t||void 0===t?Te():Me(t)?t:Te().withMutations(function(e){var r=d(t);st(r.size),r.forEach(function(t,r){return e.set(r,t)})})}function Me(t){return Bt(t)&&x(t)}function Ee(t,e,r,i){var n=Object.create(Se.prototype);return n.size=t?t.size:0,n._map=t,n._list=e,n.__ownerID=r,n.__hash=i,n}function Te(){return Hr||(Hr=Ee(Wt(),me()))}function ze(t,e,r){var i,n,o=t._map,a=t._list,s=o.get(e),u=void 0!==s;if(r===cr){if(!u)return t;a.size>=hr&&a.size>=2*o.size?(n=a.filter(function(t,e){return void 0!==t&&s!==e}),i=n.toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(i.__ownerID=n.__ownerID=t.__ownerID)):(i=o.remove(e),n=s===a.size-1?a.pop():a.set(s,void 0))}else if(u){if(r===a.get(s)[1])return t;i=o,n=a.set(s,[e,r])}else i=o.set(e,a.size),n=a.set(a.size,[e,r]);return t.__ownerID?(t.size=i.size,t._map=i,t._list=n,t.__hash=void 0,t):Ee(i,n)}function Ae(t){return null===t||void 0===t?Le():Pe(t)?t:Le().unshiftAll(t)}function Pe(t){return!(!t||!t[Wr])}function Ie(t,e,r,i){var n=Object.create(Xr);return n.size=t,n._head=e,n.__ownerID=r,n.__hash=i,n.__altered=!1,n}function Le(){return Yr||(Yr=Ie(0))}function ke(t){return null===t||void 0===t?je():De(t)?t:je().withMutations(function(e){var r=m(t);st(r.size),r.forEach(function(t){return e.add(t)})})}function De(t){return!(!t||!t[Kr])}function Re(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function Oe(t,e){var r=Object.create($r);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}function je(){return Qr||(Qr=Oe(Wt()))}function Ce(t){return null===t||void 0===t?Ne():Be(t)?t:Ne().withMutations(function(e){var r=m(t);st(r.size),r.forEach(function(t){return e.add(t)})})}function Be(t){return De(t)&&x(t)}function Fe(t,e){var r=Object.create(ti);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}function Ne(){return ei||(ei=Fe(Te()))}function qe(t,e){var r,i=function(o){if(o instanceof i)return o;if(!(this instanceof i))return new i(o);if(!r){r=!0;var a=Object.keys(t);Ge(n,a),n.size=a.length,n._name=e,n._keys=a,n._defaultValues=t}this._map=Ct(o)},n=i.prototype=Object.create(ri);return n.constructor=i,i}function Ue(t,e,r){var i=Object.create(Object.getPrototypeOf(t));return i._map=e,i.__ownerID=r,i}function Ve(t){return t._name||t.constructor.name||"Record"}function Ge(t,e){try{e.forEach(Je.bind(void 0,t))}catch(r){}}function Je(t,e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){at(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}function Ze(t,e){if(t===e)return!0;if(!v(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||_(t)!==_(e)||g(t)!==g(e)||x(t)!==x(e))return!1;if(0===t.size&&0===e.size)return!0;var r=!y(t);if(x(t)){var i=t.entries();return e.every(function(t,e){var n=i.next().value;return n&&X(n[1],t)&&(r||X(n[0],e))})&&i.next().done}var n=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{n=!0;var o=t;t=e,e=o}var a=!0,s=e.__iterate(function(e,i){return(r?t.has(e):n?X(e,t.get(i,cr)):X(t.get(i,cr),e))?void 0:(a=!1,!1)});return a&&t.size===s}function He(t,e,r){if(!(this instanceof He))return new He(t,e,r);if(at(0!==r,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),r=void 0===r?1:Math.abs(r),t>e&&(r=-r),this._start=t,this._end=e,this._step=r,this.size=Math.max(0,Math.ceil((e-t)/r-1)+1),0===this.size){if(ii)return ii;ii=this}}function We(t,e){if(!(this instanceof We))return new We(t,e);if(this._value=t,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(ni)return ni;ni=this}}function Xe(t,e){var r=function(r){t.prototype[r]=e[r]};return Object.keys(e).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(r),t}function Ye(t,e){return e;
}function Ke(t,e){return[e,t]}function $e(t){return function(){return!t.apply(this,arguments)}}function Qe(t){return function(){return-t.apply(this,arguments)}}function tr(t){return"string"==typeof t?JSON.stringify(t):t}function er(){return n(arguments)}function rr(t,e){return e>t?1:t>e?-1:0}function ir(t){if(t.size===1/0)return 0;var e=x(t),r=_(t),i=e?1:0,n=t.__iterate(r?e?function(t,e){i=31*i+or(et(t),et(e))|0}:function(t,e){i=i+or(et(t),et(e))|0}:e?function(t){i=31*i+et(t)|0}:function(t){i=i+et(t)|0});return nr(n,i)}function nr(t,e){return e=zr(e,3432918353),e=zr(e<<15|e>>>-15,461845907),e=zr(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=zr(e^e>>>16,2246822507),e=zr(e^e>>>13,3266489909),e=tt(e^e>>>16)}function or(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}var ar=Array.prototype.slice,sr="delete",ur=5,hr=1<<ur,lr=hr-1,cr={},fr={value:!1},dr={value:!1};t(d,f),t(p,f),t(m,f),f.isIterable=v,f.isKeyed=_,f.isIndexed=g,f.isAssociative=y,f.isOrdered=x,f.Keyed=d,f.Indexed=p,f.Set=m;var pr="@@__IMMUTABLE_ITERABLE__@@",mr="@@__IMMUTABLE_KEYED__@@",vr="@@__IMMUTABLE_INDEXED__@@",_r="@@__IMMUTABLE_ORDERED__@@",gr=0,yr=1,xr=2,br="function"==typeof Symbol&&Symbol.iterator,wr="@@iterator",Sr=br||wr;b.prototype.toString=function(){return"[Iterator]"},b.KEYS=gr,b.VALUES=yr,b.ENTRIES=xr,b.prototype.inspect=b.prototype.toSource=function(){return this.toString()},b.prototype[Sr]=function(){return this},t(P,f),P.of=function(){return P(arguments)},P.prototype.toSeq=function(){return this},P.prototype.toString=function(){return this.__toString("Seq {","}")},P.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},P.prototype.__iterate=function(t,e){return V(this,t,e,!0)},P.prototype.__iterator=function(t,e){return G(this,t,e,!0)},t(I,P),I.prototype.toKeyedSeq=function(){return this},t(L,P),L.of=function(){return L(arguments)},L.prototype.toIndexedSeq=function(){return this},L.prototype.toString=function(){return this.__toString("Seq [","]")},L.prototype.__iterate=function(t,e){return V(this,t,e,!1)},L.prototype.__iterator=function(t,e){return G(this,t,e,!1)},t(k,P),k.of=function(){return k(arguments)},k.prototype.toSetSeq=function(){return this},P.isSeq=C,P.Keyed=I,P.Set=k,P.Indexed=L;var Mr="@@__IMMUTABLE_SEQ__@@";P.prototype[Mr]=!0,t(D,L),D.prototype.get=function(t,e){return this.has(t)?this._array[a(this,t)]:e},D.prototype.__iterate=function(t,e){for(var r=this._array,i=r.length-1,n=0;i>=n;n++)if(t(r[e?i-n:n],n,this)===!1)return n+1;return n},D.prototype.__iterator=function(t,e){var r=this._array,i=r.length-1,n=0;return new b(function(){return n>i?S():w(t,n,r[e?i-n++:n++])})},t(R,I),R.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},R.prototype.has=function(t){return this._object.hasOwnProperty(t)},R.prototype.__iterate=function(t,e){for(var r=this._object,i=this._keys,n=i.length-1,o=0;n>=o;o++){var a=i[e?n-o:o];if(t(r[a],a,this)===!1)return o+1}return o},R.prototype.__iterator=function(t,e){var r=this._object,i=this._keys,n=i.length-1,o=0;return new b(function(){var a=i[e?n-o:o];return o++>n?S():w(t,a,r[a])})},R.prototype[_r]=!0,t(O,L),O.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var r=this._iterable,i=T(r),n=0;if(E(i))for(var o;!(o=i.next()).done&&t(o.value,n++,this)!==!1;);return n},O.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var r=this._iterable,i=T(r);if(!E(i))return new b(S);var n=0;return new b(function(){var e=i.next();return e.done?e:w(t,n++,e.value)})},t(j,L),j.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var r=this._iterator,i=this._iteratorCache,n=0;n<i.length;)if(t(i[n],n++,this)===!1)return n;for(var o;!(o=r.next()).done;){var a=o.value;if(i[n]=a,t(a,n++,this)===!1)break}return n},j.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var r=this._iterator,i=this._iteratorCache,n=0;return new b(function(){if(n>=i.length){var e=r.next();if(e.done)return e;i[n]=e.value}return w(t,n,i[n++])})};var Er;t(J,f),t(Z,J),t(H,J),t(W,J),J.Keyed=Z,J.Indexed=H,J.Set=W;var Tr,zr="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){t=0|t,e=0|e;var r=65535&t,i=65535&e;return r*i+((t>>>16)*i+r*(e>>>16)<<16>>>0)|0},Ar=Object.isExtensible,Pr=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),Ir="function"==typeof WeakMap;Ir&&(Tr=new WeakMap);var Lr=0,kr="__immutablehash__";"function"==typeof Symbol&&(kr=Symbol(kr));var Dr=16,Rr=255,Or=0,jr={};t(ut,I),ut.prototype.get=function(t,e){return this._iter.get(t,e)},ut.prototype.has=function(t){return this._iter.has(t)},ut.prototype.valueSeq=function(){return this._iter.valueSeq()},ut.prototype.reverse=function(){var t=this,e=pt(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},ut.prototype.map=function(t,e){var r=this,i=dt(this,t,e);return this._useKeys||(i.valueSeq=function(){return r._iter.toSeq().map(t,e)}),i},ut.prototype.__iterate=function(t,e){var r,i=this;return this._iter.__iterate(this._useKeys?function(e,r){return t(e,r,i)}:(r=e?Lt(this):0,function(n){return t(n,e?--r:r++,i)}),e)},ut.prototype.__iterator=function(t,e){if(this._useKeys)return this._iter.__iterator(t,e);var r=this._iter.__iterator(yr,e),i=e?Lt(this):0;return new b(function(){var n=r.next();return n.done?n:w(t,e?--i:i++,n.value,n)})},ut.prototype[_r]=!0,t(ht,L),ht.prototype.includes=function(t){return this._iter.includes(t)},ht.prototype.__iterate=function(t,e){var r=this,i=0;return this._iter.__iterate(function(e){return t(e,i++,r)},e)},ht.prototype.__iterator=function(t,e){var r=this._iter.__iterator(yr,e),i=0;return new b(function(){var e=r.next();return e.done?e:w(t,i++,e.value,e)})},t(lt,k),lt.prototype.has=function(t){return this._iter.includes(t)},lt.prototype.__iterate=function(t,e){var r=this;return this._iter.__iterate(function(e){return t(e,e,r)},e)},lt.prototype.__iterator=function(t,e){var r=this._iter.__iterator(yr,e);return new b(function(){var e=r.next();return e.done?e:w(t,e.value,e.value,e)})},t(ct,I),ct.prototype.entrySeq=function(){return this._iter.toSeq()},ct.prototype.__iterate=function(t,e){var r=this;return this._iter.__iterate(function(e){if(e){It(e);var i=v(e);return t(i?e.get(1):e[1],i?e.get(0):e[0],r)}},e)},ct.prototype.__iterator=function(t,e){var r=this._iter.__iterator(yr,e);return new b(function(){for(;;){var e=r.next();if(e.done)return e;var i=e.value;if(i){It(i);var n=v(i);return w(t,n?i.get(0):i[0],n?i.get(1):i[1],e)}}})},ht.prototype.cacheResult=ut.prototype.cacheResult=lt.prototype.cacheResult=ct.prototype.cacheResult=Rt,t(Ct,Z),Ct.prototype.toString=function(){return this.__toString("Map {","}")},Ct.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},Ct.prototype.set=function(t,e){return Xt(this,t,e)},Ct.prototype.setIn=function(t,e){return this.updateIn(t,cr,function(){return e})},Ct.prototype.remove=function(t){return Xt(this,t,cr)},Ct.prototype.deleteIn=function(t){return this.updateIn(t,function(){return cr})},Ct.prototype.update=function(t,e,r){return 1===arguments.length?t(this):this.updateIn([t],e,r)},Ct.prototype.updateIn=function(t,e,r){r||(r=e,e=void 0);var i=oe(this,jt(t),e,r);return i===cr?void 0:i},Ct.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Wt()},Ct.prototype.merge=function(){return re(this,void 0,arguments)},Ct.prototype.mergeWith=function(t){var e=ar.call(arguments,1);return re(this,t,e)},Ct.prototype.mergeIn=function(t){var e=ar.call(arguments,1);return this.updateIn(t,Wt(),function(t){return"function"==typeof t.merge?t.merge.apply(t,e):e[e.length-1]})},Ct.prototype.mergeDeep=function(){return re(this,ie(void 0),arguments)},Ct.prototype.mergeDeepWith=function(t){var e=ar.call(arguments,1);return re(this,ie(t),e)},Ct.prototype.mergeDeepIn=function(t){var e=ar.call(arguments,1);return this.updateIn(t,Wt(),function(t){return"function"==typeof t.mergeDeep?t.mergeDeep.apply(t,e):e[e.length-1]})},Ct.prototype.sort=function(t){return Se(Et(this,t))},Ct.prototype.sortBy=function(t,e){return Se(Et(this,e,t))},Ct.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},Ct.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new i)},Ct.prototype.asImmutable=function(){return this.__ensureOwner()},Ct.prototype.wasAltered=function(){return this.__altered},Ct.prototype.__iterator=function(t,e){return new Gt(this,t,e)},Ct.prototype.__iterate=function(t,e){var r=this,i=0;return this._root&&this._root.iterate(function(e){return i++,t(e[1],e[0],r)},e),i},Ct.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Ht(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ct.isMap=Bt;var Cr="@@__IMMUTABLE_MAP__@@",Br=Ct.prototype;Br[Cr]=!0,Br[sr]=Br.remove,Br.removeIn=Br.deleteIn,Ft.prototype.get=function(t,e,r,i){for(var n=this.entries,o=0,a=n.length;a>o;o++)if(X(r,n[o][0]))return n[o][1];return i},Ft.prototype.update=function(t,e,i,o,a,s,u){for(var h=a===cr,l=this.entries,c=0,f=l.length;f>c&&!X(o,l[c][0]);c++);var d=f>c;if(d?l[c][1]===a:h)return this;if(r(u),(h||!d)&&r(s),!h||1!==l.length){if(!d&&!h&&l.length>=Nr)return Qt(t,l,o,a);var p=t&&t===this.ownerID,m=p?l:n(l);return d?h?c===f-1?m.pop():m[c]=m.pop():m[c]=[o,a]:m.push([o,a]),p?(this.entries=m,this):new Ft(t,m)}},Nt.prototype.get=function(t,e,r,i){void 0===e&&(e=et(r));var n=1<<((0===t?e:e>>>t)&lr),o=this.bitmap;return 0===(o&n)?i:this.nodes[ae(o&n-1)].get(t+ur,e,r,i)},Nt.prototype.update=function(t,e,r,i,n,o,a){void 0===r&&(r=et(i));var s=(0===e?r:r>>>e)&lr,u=1<<s,h=this.bitmap,l=0!==(h&u);if(!l&&n===cr)return this;var c=ae(h&u-1),f=this.nodes,d=l?f[c]:void 0,p=Yt(d,t,e+ur,r,i,n,o,a);if(p===d)return this;if(!l&&p&&f.length>=qr)return ee(t,f,h,s,p);if(l&&!p&&2===f.length&&Kt(f[1^c]))return f[1^c];if(l&&p&&1===f.length&&Kt(p))return p;var m=t&&t===this.ownerID,v=l?p?h:h^u:h|u,_=l?p?se(f,c,p,m):he(f,c,m):ue(f,c,p,m);return m?(this.bitmap=v,this.nodes=_,this):new Nt(t,v,_)},qt.prototype.get=function(t,e,r,i){void 0===e&&(e=et(r));var n=(0===t?e:e>>>t)&lr,o=this.nodes[n];return o?o.get(t+ur,e,r,i):i},qt.prototype.update=function(t,e,r,i,n,o,a){void 0===r&&(r=et(i));var s=(0===e?r:r>>>e)&lr,u=n===cr,h=this.nodes,l=h[s];if(u&&!l)return this;var c=Yt(l,t,e+ur,r,i,n,o,a);if(c===l)return this;var f=this.count;if(l){if(!c&&(f--,Ur>f))return te(t,h,f,s)}else f++;var d=t&&t===this.ownerID,p=se(h,s,c,d);return d?(this.count=f,this.nodes=p,this):new qt(t,f,p)},Ut.prototype.get=function(t,e,r,i){for(var n=this.entries,o=0,a=n.length;a>o;o++)if(X(r,n[o][0]))return n[o][1];return i},Ut.prototype.update=function(t,e,i,o,a,s,u){void 0===i&&(i=et(o));var h=a===cr;if(i!==this.keyHash)return h?this:(r(u),r(s),$t(this,t,e,i,[o,a]));for(var l=this.entries,c=0,f=l.length;f>c&&!X(o,l[c][0]);c++);var d=f>c;if(d?l[c][1]===a:h)return this;if(r(u),(h||!d)&&r(s),h&&2===f)return new Vt(t,this.keyHash,l[1^c]);var p=t&&t===this.ownerID,m=p?l:n(l);return d?h?c===f-1?m.pop():m[c]=m.pop():m[c]=[o,a]:m.push([o,a]),p?(this.entries=m,this):new Ut(t,this.keyHash,m)},Vt.prototype.get=function(t,e,r,i){return X(r,this.entry[0])?this.entry[1]:i},Vt.prototype.update=function(t,e,i,n,o,a,s){var u=o===cr,h=X(n,this.entry[0]);return(h?o===this.entry[1]:u)?this:(r(s),u?void r(a):h?t&&t===this.ownerID?(this.entry[1]=o,this):new Vt(t,this.keyHash,[n,o]):(r(a),$t(this,t,e,et(n),[n,o])))},Ft.prototype.iterate=Ut.prototype.iterate=function(t,e){for(var r=this.entries,i=0,n=r.length-1;n>=i;i++)if(t(r[e?n-i:i])===!1)return!1},Nt.prototype.iterate=qt.prototype.iterate=function(t,e){for(var r=this.nodes,i=0,n=r.length-1;n>=i;i++){var o=r[e?n-i:i];if(o&&o.iterate(t,e)===!1)return!1}},Vt.prototype.iterate=function(t,e){return t(this.entry)},t(Gt,b),Gt.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var r,i=e.node,n=e.index++;if(i.entry){if(0===n)return Jt(t,i.entry)}else if(i.entries){if(r=i.entries.length-1,r>=n)return Jt(t,i.entries[this._reverse?r-n:n])}else if(r=i.nodes.length-1,r>=n){var o=i.nodes[this._reverse?r-n:n];if(o){if(o.entry)return Jt(t,o.entry);e=this._stack=Zt(o,e)}continue}e=this._stack=this._stack.__prev}return S()};var Fr,Nr=hr/4,qr=hr/2,Ur=hr/4;t(le,H),le.of=function(){return this(arguments)},le.prototype.toString=function(){return this.__toString("List [","]")},le.prototype.get=function(t,e){if(t=a(this,t),0>t||t>=this.size)return e;t+=this._origin;var r=ye(this,t);return r&&r.array[t&lr]},le.prototype.set=function(t,e){return ve(this,t,e)},le.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},le.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=ur,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):me()},le.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(r){xe(r,0,e+t.length);for(var i=0;i<t.length;i++)r.set(e+i,t[i])})},le.prototype.pop=function(){return xe(this,0,-1)},le.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){xe(e,-t.length);for(var r=0;r<t.length;r++)e.set(r,t[r])})},le.prototype.shift=function(){return xe(this,1)},le.prototype.merge=function(){return be(this,void 0,arguments)},le.prototype.mergeWith=function(t){var e=ar.call(arguments,1);return be(this,t,e)},le.prototype.mergeDeep=function(){return be(this,ie(void 0),arguments)},le.prototype.mergeDeepWith=function(t){var e=ar.call(arguments,1);return be(this,ie(t),e)},le.prototype.setSize=function(t){return xe(this,0,t)},le.prototype.slice=function(t,e){var r=this.size;return u(t,e,r)?this:xe(this,h(t,r),l(e,r))},le.prototype.__iterator=function(t,e){var r=0,i=de(this,e);return new b(function(){var e=i();return e===Zr?S():w(t,r++,e)})},le.prototype.__iterate=function(t,e){for(var r,i=0,n=de(this,e);(r=n())!==Zr&&t(r,i++,this)!==!1;);return i},le.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?pe(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},le.isList=ce;var Vr="@@__IMMUTABLE_LIST__@@",Gr=le.prototype;Gr[Vr]=!0,Gr[sr]=Gr.remove,Gr.setIn=Br.setIn,Gr.deleteIn=Gr.removeIn=Br.removeIn,Gr.update=Br.update,Gr.updateIn=Br.updateIn,Gr.mergeIn=Br.mergeIn,Gr.mergeDeepIn=Br.mergeDeepIn,Gr.withMutations=Br.withMutations,Gr.asMutable=Br.asMutable,Gr.asImmutable=Br.asImmutable,Gr.wasAltered=Br.wasAltered,fe.prototype.removeBefore=function(t,e,r){if(r===e?1<<e:0===this.array.length)return this;var i=r>>>e&lr;if(i>=this.array.length)return new fe([],t);var n,o=0===i;if(e>0){var a=this.array[i];if(n=a&&a.removeBefore(t,e-ur,r),n===a&&o)return this}if(o&&!n)return this;var s=ge(this,t);if(!o)for(var u=0;i>u;u++)s.array[u]=void 0;return n&&(s.array[i]=n),s},fe.prototype.removeAfter=function(t,e,r){if(r===e?1<<e:0===this.array.length)return this;var i=r-1>>>e&lr;if(i>=this.array.length)return this;var n,o=i===this.array.length-1;if(e>0){var a=this.array[i];if(n=a&&a.removeAfter(t,e-ur,r),n===a&&o)return this}if(o&&!n)return this;var s=ge(this,t);return o||s.array.pop(),n&&(s.array[i]=n),s};var Jr,Zr={};t(Se,Ct),Se.of=function(){return this(arguments)},Se.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Se.prototype.get=function(t,e){var r=this._map.get(t);return void 0!==r?this._list.get(r)[1]:e},Se.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):Te()},Se.prototype.set=function(t,e){return ze(this,t,e)},Se.prototype.remove=function(t){return ze(this,t,cr)},Se.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Se.prototype.__iterate=function(t,e){var r=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],r)},e)},Se.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},Se.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),r=this._list.__ensureOwner(t);return t?Ee(e,r,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=r,this)},Se.isOrderedMap=Me,Se.prototype[_r]=!0,Se.prototype[sr]=Se.prototype.remove;var Hr;t(Ae,H),Ae.of=function(){return this(arguments)},Ae.prototype.toString=function(){return this.__toString("Stack [","]")},Ae.prototype.get=function(t,e){var r=this._head;for(t=a(this,t);r&&t--;)r=r.next;return r?r.value:e},Ae.prototype.peek=function(){return this._head&&this._head.value},Ae.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,r=arguments.length-1;r>=0;r--)e={value:arguments[r],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=void 0,this.__altered=!0,this):Ie(t,e)},Ae.prototype.pushAll=function(t){if(t=p(t),0===t.size)return this;st(t.size);var e=this.size,r=this._head;return t.reverse().forEach(function(t){e++,r={value:t,next:r}}),this.__ownerID?(this.size=e,this._head=r,this.__hash=void 0,this.__altered=!0,this):Ie(e,r)},Ae.prototype.pop=function(){return this.slice(1)},Ae.prototype.unshift=function(){return this.push.apply(this,arguments)},Ae.prototype.unshiftAll=function(t){return this.pushAll(t)},Ae.prototype.shift=function(){return this.pop.apply(this,arguments)},Ae.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Le()},Ae.prototype.slice=function(t,e){if(u(t,e,this.size))return this;var r=h(t,this.size),i=l(e,this.size);if(i!==this.size)return H.prototype.slice.call(this,t,e);for(var n=this.size-r,o=this._head;r--;)o=o.next;return this.__ownerID?(this.size=n,this._head=o,this.__hash=void 0,this.__altered=!0,this):Ie(n,o)},Ae.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Ie(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ae.prototype.__iterate=function(t,e){if(e)return this.reverse().__iterate(t);for(var r=0,i=this._head;i&&t(i.value,r++,this)!==!1;)i=i.next;return r},Ae.prototype.__iterator=function(t,e){if(e)return this.reverse().__iterator(t);var r=0,i=this._head;return new b(function(){if(i){var e=i.value;return i=i.next,w(t,r++,e)}return S()})},Ae.isStack=Pe;var Wr="@@__IMMUTABLE_STACK__@@",Xr=Ae.prototype;Xr[Wr]=!0,Xr.withMutations=Br.withMutations,Xr.asMutable=Br.asMutable,Xr.asImmutable=Br.asImmutable,Xr.wasAltered=Br.wasAltered;var Yr;t(ke,W),ke.of=function(){return this(arguments)},ke.fromKeys=function(t){return this(d(t).keySeq())},ke.prototype.toString=function(){return this.__toString("Set {","}")},ke.prototype.has=function(t){return this._map.has(t)},ke.prototype.add=function(t){return Re(this,this._map.set(t,!0))},ke.prototype.remove=function(t){return Re(this,this._map.remove(t))},ke.prototype.clear=function(){return Re(this,this._map.clear())},ke.prototype.union=function(){var t=ar.call(arguments,0);return t=t.filter(function(t){return 0!==t.size}),0===t.length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations(function(e){for(var r=0;r<t.length;r++)m(t[r]).forEach(function(t){return e.add(t)})}):this.constructor(t[0])},ke.prototype.intersect=function(){var t=ar.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return m(t)});var e=this;return this.withMutations(function(r){e.forEach(function(e){t.every(function(t){return t.includes(e)})||r.remove(e)})})},ke.prototype.subtract=function(){var t=ar.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return m(t)});var e=this;return this.withMutations(function(r){e.forEach(function(e){t.some(function(t){return t.includes(e)})&&r.remove(e)})})},ke.prototype.merge=function(){return this.union.apply(this,arguments)},ke.prototype.mergeWith=function(t){var e=ar.call(arguments,1);return this.union.apply(this,e)},ke.prototype.sort=function(t){return Ce(Et(this,t))},ke.prototype.sortBy=function(t,e){return Ce(Et(this,e,t))},ke.prototype.wasAltered=function(){return this._map.wasAltered()},ke.prototype.__iterate=function(t,e){var r=this;return this._map.__iterate(function(e,i){return t(i,i,r)},e)},ke.prototype.__iterator=function(t,e){return this._map.map(function(t,e){return e}).__iterator(t,e)},ke.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},ke.isSet=De;var Kr="@@__IMMUTABLE_SET__@@",$r=ke.prototype;$r[Kr]=!0,$r[sr]=$r.remove,$r.mergeDeep=$r.merge,$r.mergeDeepWith=$r.mergeWith,$r.withMutations=Br.withMutations,$r.asMutable=Br.asMutable,$r.asImmutable=Br.asImmutable,$r.__empty=je,$r.__make=Oe;var Qr;t(Ce,ke),Ce.of=function(){return this(arguments)},Ce.fromKeys=function(t){return this(d(t).keySeq())},Ce.prototype.toString=function(){return this.__toString("OrderedSet {","}")},Ce.isOrderedSet=Be;var ti=Ce.prototype;ti[_r]=!0,ti.__empty=Ne,ti.__make=Fe;var ei;t(qe,Z),qe.prototype.toString=function(){return this.__toString(Ve(this)+" {","}")},qe.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},qe.prototype.get=function(t,e){if(!this.has(t))return e;var r=this._defaultValues[t];return this._map?this._map.get(t,r):r},qe.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=this.constructor;return t._empty||(t._empty=Ue(this,Wt()))},qe.prototype.set=function(t,e){if(!this.has(t))throw new Error('Cannot set unknown key "'+t+'" on '+Ve(this));var r=this._map&&this._map.set(t,e);return this.__ownerID||r===this._map?this:Ue(this,r)},qe.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:Ue(this,e)},qe.prototype.wasAltered=function(){return this._map.wasAltered()},qe.prototype.__iterator=function(t,e){var r=this;return d(this._defaultValues).map(function(t,e){return r.get(e)}).__iterator(t,e)},qe.prototype.__iterate=function(t,e){var r=this;return d(this._defaultValues).map(function(t,e){return r.get(e)}).__iterate(t,e)},qe.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?Ue(this,e,t):(this.__ownerID=t,this._map=e,this)};var ri=qe.prototype;ri[sr]=ri.remove,ri.deleteIn=ri.removeIn=Br.removeIn,ri.merge=Br.merge,ri.mergeWith=Br.mergeWith,ri.mergeIn=Br.mergeIn,ri.mergeDeep=Br.mergeDeep,ri.mergeDeepWith=Br.mergeDeepWith,ri.mergeDeepIn=Br.mergeDeepIn,ri.setIn=Br.setIn,ri.update=Br.update,ri.updateIn=Br.updateIn,ri.withMutations=Br.withMutations,ri.asMutable=Br.asMutable,ri.asImmutable=Br.asImmutable,t(He,L),He.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"},He.prototype.get=function(t,e){return this.has(t)?this._start+a(this,t)*this._step:e},He.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},He.prototype.slice=function(t,e){return u(t,e,this.size)?this:(t=h(t,this.size),e=l(e,this.size),t>=e?new He(0,0):new He(this.get(t,this._end),this.get(e,this._end),this._step))},He.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step===0){var r=e/this._step;if(r>=0&&r<this.size)return r}return-1},He.prototype.lastIndexOf=function(t){return this.indexOf(t)},He.prototype.__iterate=function(t,e){for(var r=this.size-1,i=this._step,n=e?this._start+r*i:this._start,o=0;r>=o;o++){if(t(n,o,this)===!1)return o+1;n+=e?-i:i}return o},He.prototype.__iterator=function(t,e){var r=this.size-1,i=this._step,n=e?this._start+r*i:this._start,o=0;return new b(function(){var a=n;return n+=e?-i:i,o>r?S():w(t,o++,a)})},He.prototype.equals=function(t){return t instanceof He?this._start===t._start&&this._end===t._end&&this._step===t._step:Ze(this,t)};var ii;t(We,L),We.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},We.prototype.get=function(t,e){return this.has(t)?this._value:e},We.prototype.includes=function(t){return X(this._value,t)},We.prototype.slice=function(t,e){var r=this.size;return u(t,e,r)?this:new We(this._value,l(e,r)-h(t,r))},We.prototype.reverse=function(){return this},We.prototype.indexOf=function(t){return X(this._value,t)?0:-1},We.prototype.lastIndexOf=function(t){return X(this._value,t)?this.size:-1},We.prototype.__iterate=function(t,e){for(var r=0;r<this.size;r++)if(t(this._value,r,this)===!1)return r+1;return r},We.prototype.__iterator=function(t,e){var r=this,i=0;return new b(function(){return i<r.size?w(t,i++,r._value):S()})},We.prototype.equals=function(t){return t instanceof We?X(this._value,t._value):Ze(t)};var ni;f.Iterator=b,Xe(f,{toArray:function(){st(this.size);var t=new Array(this.size||0);return this.valueSeq().__iterate(function(e,r){t[r]=e}),t},toIndexedSeq:function(){return new ht(this)},toJS:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJS?t.toJS():t}).__toJS()},toJSON:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t}).__toJS()},toKeyedSeq:function(){return new ut(this,!0)},toMap:function(){return Ct(this.toKeyedSeq())},toObject:function(){st(this.size);var t={};return this.__iterate(function(e,r){t[r]=e}),t},toOrderedMap:function(){return Se(this.toKeyedSeq())},toOrderedSet:function(){return Ce(_(this)?this.valueSeq():this)},toSet:function(){return ke(_(this)?this.valueSeq():this)},toSetSeq:function(){return new lt(this)},toSeq:function(){return g(this)?this.toIndexedSeq():_(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Ae(_(this)?this.valueSeq():this)},toList:function(){return le(_(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){var t=ar.call(arguments,0);return Pt(this,bt(this,t))},contains:function(t){return this.includes(t)},includes:function(t){return this.some(function(e){return X(e,t)})},entries:function(){return this.__iterator(xr)},every:function(t,e){st(this.size);var r=!0;return this.__iterate(function(i,n,o){return t.call(e,i,n,o)?void 0:(r=!1,!1)}),r},filter:function(t,e){return Pt(this,mt(this,t,e,!0))},find:function(t,e,r){var i=this.findEntry(t,e);return i?i[1]:r},findEntry:function(t,e){var r;return this.__iterate(function(i,n,o){return t.call(e,i,n,o)?(r=[n,i],!1):void 0}),r},findLastEntry:function(t,e){return this.toSeq().reverse().findEntry(t,e)},forEach:function(t,e){return st(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){st(this.size),t=void 0!==t?""+t:",";var e="",r=!0;return this.__iterate(function(i){r?r=!1:e+=t,e+=null!==i&&void 0!==i?i.toString():""}),e},keys:function(){return this.__iterator(gr)},map:function(t,e){return Pt(this,dt(this,t,e))},reduce:function(t,e,r){st(this.size);var i,n;return arguments.length<2?n=!0:i=e,this.__iterate(function(e,o,a){n?(n=!1,i=e):i=t.call(r,i,e,o,a)}),i},reduceRight:function(t,e,r){var i=this.toKeyedSeq().reverse();return i.reduce.apply(i,arguments)},reverse:function(){return Pt(this,pt(this,!0))},slice:function(t,e){return Pt(this,gt(this,t,e,!0))},some:function(t,e){return!this.every($e(t),e)},sort:function(t){return Pt(this,Et(this,t))},values:function(){return this.__iterator(yr)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return o(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return vt(this,t,e)},equals:function(t){return Ze(this,t)},entrySeq:function(){var t=this;if(t._cache)return new D(t._cache);var e=t.toSeq().map(Ke).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter($e(t),e)},findLast:function(t,e,r){return this.toKeyedSeq().reverse().find(t,e,r)},first:function(){return this.find(s)},flatMap:function(t,e){return Pt(this,St(this,t,e))},flatten:function(t){return Pt(this,wt(this,t,!0))},fromEntrySeq:function(){return new ct(this)},get:function(t,e){return this.find(function(e,r){return X(r,t)},void 0,e)},getIn:function(t,e){for(var r,i=this,n=jt(t);!(r=n.next()).done;){var o=r.value;if(i=i&&i.get?i.get(o,cr):cr,i===cr)return e}return i},groupBy:function(t,e){return _t(this,t,e)},has:function(t){return this.get(t,cr)!==cr},hasIn:function(t){return this.getIn(t,cr)!==cr},isSubset:function(t){return t="function"==typeof t.includes?t:f(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return t="function"==typeof t.isSubset?t:f(t),t.isSubset(this)},keySeq:function(){return this.toSeq().map(Ye).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},max:function(t){return Tt(this,t)},maxBy:function(t,e){return Tt(this,e,t)},min:function(t){return Tt(this,t?Qe(t):rr)},minBy:function(t,e){return Tt(this,e?Qe(e):rr,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return Pt(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return Pt(this,xt(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile($e(t),e)},sortBy:function(t,e){return Pt(this,Et(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return Pt(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return Pt(this,yt(this,t,e))},takeUntil:function(t,e){return this.takeWhile($e(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=ir(this))}});var oi=f.prototype;oi[pr]=!0,oi[Sr]=oi.values,oi.__toJS=oi.toArray,oi.__toStringMapper=tr,oi.inspect=oi.toSource=function(){return this.toString()},oi.chain=oi.flatMap,function(){try{Object.defineProperty(oi,"length",{get:function(){if(!f.noLengthWarning){var t;try{throw new Error}catch(e){t=e.stack}if(-1===t.indexOf("_wrapObject"))return console&&console.warn&&console.warn("iterable.length has been deprecated, use iterable.size or iterable.count(). This warning will become a silent error in a future version. "+t),this.size}}})}catch(t){}}(),Xe(d,{flip:function(){return Pt(this,ft(this))},findKey:function(t,e){var r=this.findEntry(t,e);return r&&r[0]},findLastKey:function(t,e){return this.toSeq().reverse().findKey(t,e)},keyOf:function(t){return this.findKey(function(e){return X(e,t)})},lastKeyOf:function(t){return this.findLastKey(function(e){return X(e,t)})},mapEntries:function(t,e){var r=this,i=0;return Pt(this,this.toSeq().map(function(n,o){return t.call(e,[o,n],i++,r)}).fromEntrySeq())},mapKeys:function(t,e){var r=this;return Pt(this,this.toSeq().flip().map(function(i,n){return t.call(e,i,n,r)}).flip())}});var ai=d.prototype;ai[mr]=!0,ai[Sr]=oi.entries,ai.__toJS=oi.toObject,ai.__toStringMapper=function(t,e){return JSON.stringify(e)+": "+tr(t)},Xe(p,{toKeyedSeq:function(){return new ut(this,!1)},filter:function(t,e){return Pt(this,mt(this,t,e,!1))},findIndex:function(t,e){var r=this.findEntry(t,e);return r?r[0]:-1},indexOf:function(t){var e=this.toKeyedSeq().keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){return this.toSeq().reverse().indexOf(t)},reverse:function(){return Pt(this,pt(this,!1))},slice:function(t,e){return Pt(this,gt(this,t,e,!1))},splice:function(t,e){var r=arguments.length;if(e=Math.max(0|e,0),0===r||2===r&&!e)return this;t=h(t,this.size);var i=this.slice(0,t);return Pt(this,1===r?i:i.concat(n(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var r=this.toKeyedSeq().findLastKey(t,e);return void 0===r?-1:r},first:function(){return this.get(0)},flatten:function(t){return Pt(this,wt(this,t,!1))},get:function(t,e){return t=a(this,t),0>t||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find(function(e,r){
return r===t},void 0,e)},has:function(t){return t=a(this,t),t>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Pt(this,Mt(this,t))},interleave:function(){var t=[this].concat(n(arguments)),e=At(this.toSeq(),L.of,t),r=e.flatten(!0);return e.size&&(r.size=e.size*t.length),Pt(this,r)},last:function(){return this.get(-1)},skipWhile:function(t,e){return Pt(this,xt(this,t,e,!1))},zip:function(){var t=[this].concat(n(arguments));return Pt(this,At(this,er,t))},zipWith:function(t){var e=n(arguments);return e[0]=this,Pt(this,At(this,t,e))}}),p.prototype[vr]=!0,p.prototype[_r]=!0,Xe(m,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),m.prototype.has=oi.includes,Xe(I,d.prototype),Xe(L,p.prototype),Xe(k,m.prototype),Xe(Z,d.prototype),Xe(H,p.prototype),Xe(W,m.prototype);var si={Iterable:f,Seq:P,Collection:J,Map:Ct,OrderedMap:Se,List:le,Stack:Ae,Set:ke,OrderedSet:Ce,Record:qe,Range:He,Repeat:We,is:X,fromJS:Y};return si})},{}],8:[function(t,e,r){"use strict";function i(t){t?(this.array=t.array,this.pos=t.pos):(this.array=new ArrayBuffer(this.defaultLength),this.length=this.defaultLength,this.setupViews())}e.exports=i,i.prototype={pos:0,itemSize:4,defaultLength:8192,arrayType:"ARRAY_BUFFER",get index(){return this.pos/this.itemSize},setupViews:function(){this.ubytes=new Uint8Array(this.array),this.bytes=new Int8Array(this.array),this.ushorts=new Uint16Array(this.array),this.shorts=new Int16Array(this.array)},bind:function(t){var e=t[this.arrayType];this.buffer?t.bindBuffer(e,this.buffer):(this.buffer=t.createBuffer(),t.bindBuffer(e,this.buffer),t.bufferData(e,this.array.slice(0,this.pos),t.STATIC_DRAW),this.array=null)},destroy:function(t){this.buffer&&t.deleteBuffer(this.buffer)},resize:function(){if(this.length<this.pos+this.itemSize){for(;this.length<this.pos+this.itemSize;)this.length=2*Math.round(1.5*this.length/2);this.array=new ArrayBuffer(this.length);var t=new Uint8Array(this.array);t.set(this.ubytes),this.setupViews()}}}},{}],9:[function(t,e,r){"use strict";var i=t("./line_vertex_buffer"),n=t("./line_element_buffer"),o=t("./fill_vertex_buffer"),a=t("./triangle_element_buffer"),s=t("./outline_element_buffer"),u=t("./glyph_vertex_buffer"),h=t("./triangle_element_buffer"),l=t("./icon_vertex_buffer"),c=t("./triangle_element_buffer"),f=t("./collision_box_vertex_buffer");e.exports=function(t){return t=t||{},{glyphVertex:new u(t.glyphVertex),glyphElement:new h(t.glyphElement),iconVertex:new l(t.iconVertex),iconElement:new c(t.iconElement),fillVertex:new o(t.fillVertex),fillElement:new a(t.fillElement),outlineElement:new s(t.outlineElement),lineVertex:new i(t.lineVertex),lineElement:new n(t.lineElement),collisionBoxVertex:new f(t.collisionBoxVertex)}}},{"./collision_box_vertex_buffer":10,"./fill_vertex_buffer":11,"./glyph_vertex_buffer":12,"./icon_vertex_buffer":13,"./line_element_buffer":14,"./line_vertex_buffer":15,"./outline_element_buffer":16,"./triangle_element_buffer":17}],10:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{itemSize:12,defaultLength:32768,add:function(t,e,r,i){var n=this.pos,o=n/2,a=this.index;return this.resize(),this.shorts[o+0]=t.x,this.shorts[o+1]=t.y,this.shorts[o+2]=Math.round(e.x),this.shorts[o+3]=Math.round(e.y),this.ubytes[n+8]=Math.floor(10*r),this.ubytes[n+9]=Math.floor(10*i),this.pos+=this.itemSize,a}})},{"../../util/util":110,"./buffer":8}],11:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{itemSize:4,add:function(t,e){var r=this.pos/2;this.resize(),this.shorts[r+0]=t,this.shorts[r+1]=e,this.pos+=this.itemSize}})},{"../../util/util":110,"./buffer":8}],12:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{defaultLength:32768,itemSize:16,add:function(t,e,r,i,n,o,a,s,u){var h=this.pos,l=h/2;this.resize(),this.shorts[l+0]=t,this.shorts[l+1]=e,this.shorts[l+2]=Math.round(64*r),this.shorts[l+3]=Math.round(64*i),this.ubytes[h+8]=Math.floor(n/4),this.ubytes[h+9]=Math.floor(o/4),this.ubytes[h+10]=Math.floor(10*u),this.ubytes[h+12]=Math.floor(10*a),this.ubytes[h+13]=Math.floor(10*Math.min(s,25)),this.pos+=this.itemSize},bind:function(t,e,r){o.prototype.bind.call(this,t);var i=this.itemSize;t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,i,r+0),t.vertexAttribPointer(e.a_offset,2,t.SHORT,!1,i,r+4),t.vertexAttribPointer(e.a_data1,4,t.UNSIGNED_BYTE,!1,i,r+8),t.vertexAttribPointer(e.a_data2,2,t.UNSIGNED_BYTE,!1,i,r+12)}})},{"../../util/util":110,"./buffer":8}],13:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{defaultLength:32768,itemSize:16,add:function(t,e,r,i,n,o,a,s,u){var h=this.pos,l=h/2;this.resize(),this.shorts[l+0]=t,this.shorts[l+1]=e,this.shorts[l+2]=Math.round(64*r),this.shorts[l+3]=Math.round(64*i),this.ubytes[h+8]=n/4,this.ubytes[h+9]=o/4,this.ubytes[h+10]=Math.floor(10*(u||0)),this.ubytes[h+12]=Math.floor(10*(a||0)),this.ubytes[h+13]=Math.floor(10*Math.min(s||25,25)),this.pos+=this.itemSize},bind:function(t,e,r){o.prototype.bind.call(this,t);var i=this.itemSize;t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,i,r+0),t.vertexAttribPointer(e.a_offset,2,t.SHORT,!1,i,r+4),t.vertexAttribPointer(e.a_data1,4,t.UNSIGNED_BYTE,!1,i,r+8),t.vertexAttribPointer(e.a_data2,2,t.UNSIGNED_BYTE,!1,i,r+12)}})},{"../../util/util":110,"./buffer":8}],14:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e,r){var i=this.pos/2;this.resize(),this.ushorts[i+0]=t,this.ushorts[i+1]=e,this.ushorts[i+2]=r,this.pos+=this.itemSize}})},{"../../util/util":110,"./buffer":8}],15:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.extrudeScale=63,i.prototype=n.inherit(o,{itemSize:8,defaultLength:32768,add:function(t,e,r,n,o){var a=this.pos,s=a/2,u=this.index,h=i.extrudeScale;return this.resize(),this.shorts[s+0]=2*Math.floor(t.x)|r,this.shorts[s+1]=2*Math.floor(t.y)|n,this.bytes[a+4]=Math.round(h*e.x),this.bytes[a+5]=Math.round(h*e.y),this.bytes[a+6]=(o||0)/128,this.bytes[a+7]=(o||0)%128,this.pos+=this.itemSize,u}})},{"../../util/util":110,"./buffer":8}],16:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{itemSize:4,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e){var r=this.pos/2;this.resize(),this.ushorts[r+0]=t,this.ushorts[r+1]=e,this.pos+=this.itemSize}})},{"../../util/util":110,"./buffer":8}],17:[function(t,e,r){"use strict";function i(t){o.call(this,t)}var n=t("../../util/util"),o=t("./buffer");e.exports=i,i.prototype=n.inherit(o,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e,r){var i=this.pos/2;this.resize(),this.ushorts[i+0]=t,this.ushorts[i+1]=e,this.ushorts[i+2]=r,this.pos+=this.itemSize}})},{"../../util/util":110,"./buffer":8}],18:[function(t,e,r){"use strict";function i(t,e,r,i,l){var c=new h("layout",t.type,t.layout,{}).values(),f={lastIntegerZoom:1/0,lastIntegerZoomTime:0,lastZoom:0},d={};for(var p in c)d[p]=c[p].calculate(r,f);var m="line"===t.type?n:"fill"===t.type?o:"symbol"===t.type?a:null,v=new m(e,new s[t.type](d),i,r,l);return v.id=t.id,v.type=t.type,v["source-layer"]=t["source-layer"],v.interactive=t.interactive,v.minZoom=t.minzoom,v.maxZoom=t.maxzoom,v.filter=u(t.filter),v.features=[],v}e.exports=i;var n=t("./line_bucket"),o=t("./fill_bucket"),a=t("./symbol_bucket"),s=t("../style/layout_properties"),u=t("feature-filter"),h=t("../style/style_declaration_set")},{"../style/layout_properties":56,"../style/style_declaration_set":63,"./fill_bucket":21,"./line_bucket":22,"./symbol_bucket":23,"feature-filter":112}],19:[function(t,e,r){"use strict";function i(t,e,r){this.vertexBuffer=t,this.elementBuffer=e,this.secondElementBuffer=r,this.groups=[]}function n(t,e,r){this.vertexStartIndex=t,this.elementStartIndex=e,this.secondElementStartIndex=r,this.elementLength=0,this.vertexLength=0,this.secondElementLength=0}e.exports=i,i.prototype.makeRoomFor=function(t){(!this.current||this.current.vertexLength+t>65535)&&(this.current=new n(this.vertexBuffer.index,this.elementBuffer&&this.elementBuffer.index,this.secondElementBuffer&&this.secondElementBuffer.index),this.groups.push(this.current))}},{}],20:[function(t,e,r){"use strict";function i(t,e){this.x=t.x,this.y=t.y,this.z=t.z-Math.log(e)/Math.LN2,this.rtree=h(9),this.toBeInserted=[]}function n(t,e,r,i){return"Point"===e?u(t,r,i):"LineString"===e?a(t,r,i):"Polygon"===e?s(t,r)||a(t,r,i):!1}function o(t,e,r){var i=e.distSqr(r);if(0===i)return t.distSqr(e);var n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return 0>n?t.distSqr(e):n>1?t.distSqr(r):t.distSqr(r.sub(e)._mult(n)._add(e))}function a(t,e,r){for(var i=r*r,n=0;n<t.length;n++)for(var a=t[n],s=1;s<a.length;s++){var u=a[s-1],h=a[s];if(o(e,u,h)<i)return!0}return!1}function s(t,e){for(var r,i,n,o=!1,a=0;a<t.length;a++){r=t[a];for(var s=0,u=r.length-1;s<r.length;u=s++)i=r[s],n=r[u],i.y>e.y!=n.y>e.y&&e.x<(n.x-i.x)*(e.y-i.y)/(n.y-i.y)+i.x&&(o=!o)}return o}function u(t,e,r){for(var i=r*r,n=0;n<t.length;n++)for(var o=t[n],a=0;a<o.length;a++)if(o[a].distSqr(e)<=i)return!0;return!1}var h=t("rbush"),l=t("point-geometry"),c=t("vector-tile"),f=t("../util/util");e.exports=i,i.prototype.insert=function(t,e,r){t.layers=e,t.feature=r,this.toBeInserted.push(t)},i.prototype._load=function(){this.rtree.load(this.toBeInserted),this.toBeInserted=[]},i.prototype.query=function(t,e){this.toBeInserted.length&&this._load();for(var r=t.params||{},i=4096*(r.radius||0)/t.scale,o=t.x,a=t.y,s=[],u=this.rtree.search([o-i,a-i,o+i,a+i]),h=0;h<u.length;h++){var d=u[h].feature,p=u[h].layers,m=c.VectorTileFeature.types[d.type];if((!r.$type||m===r.$type)&&n(d.loadGeometry(),m,new l(o,a),i)){var v=d.toGeoJSON(this.x,this.y,this.z);r.includeGeometry||(v.geometry=null);for(var _=0;_<p.length;_++){var g=p[_];r.layer&&g!==r.layer.id||s.push(f.extend({layer:g},v))}}}e(null,s)}},{"../util/util":110,"point-geometry":137,rbush:138,"vector-tile":141}],21:[function(t,e,r){"use strict";function i(t){this.buffers=t,this.elementGroups=new n(t.fillVertex,t.fillElement,t.outlineElement)}var n=t("./element_groups");e.exports=i,i.prototype.addFeatures=function(){for(var t=this.features,e=0;e<t.length;e++){var r=t[e];this.addFeature(r.loadGeometry())}},i.prototype.addFeature=function(t){for(var e=0;e<t.length;e++)this.addFill(t[e])},i.prototype.addFill=function(t){if(!(t.length<3)){var e=t.length;this.elementGroups.makeRoomFor(e+1);for(var r,i,n,o=this.elementGroups.current,a=this.buffers.fillVertex,s=this.buffers.fillElement,u=this.buffers.outlineElement,h=a.index-o.vertexStartIndex,l=0;l<t.length;l++)i=a.index-o.vertexStartIndex,n=t[l],a.add(n.x,n.y),o.vertexLength++,l>=2&&(n.x!==t[0].x||n.y!==t[0].y)&&(s.add(h,r,i),o.elementLength++),l>=1&&(u.add(r,i),o.secondElementLength++),r=i}}},{"./element_groups":19}],22:[function(t,e,r){"use strict";function i(t,e){this.buffers=t,this.elementGroups=new n(t.lineVertex,t.lineElement),this.layoutProperties=e}var n=t("./element_groups");e.exports=i,i.prototype.addFeatures=function(){for(var t=this.features,e=0;e<t.length;e++){var r=t[e];this.addFeature(r.loadGeometry())}},i.prototype.addFeature=function(t){for(var e=this.layoutProperties,r=0;r<t.length;r++)this.addLine(t[r],e["line-join"],e["line-cap"],e["line-miter-limit"],e["line-round-limit"])},i.prototype.addLine=function(t,e,r,i,n){for(var o=t.length;o>2&&t[o-1].equals(t[o-2]);)o--;if(!(t.length<2)){"bevel"===e&&(i=1.05);var a=t[0],s=t[o-1],u=a.equals(s);if(this.elementGroups.makeRoomFor(10*o),2!==o||!u){var h,l,c,f,d,p,m,v=r,_=u?"butt":r,g=1,y=0,x=!0;this.e1=this.e2=this.e3=-1,u&&(h=t[o-2],d=a.sub(h)._unit()._perp());for(var b=0;o>b;b++)if(c=u&&b===o-1?t[1]:t[b+1],!c||!t[b].equals(c)){d&&(f=d),h&&(l=h),h=t[b],l&&(y+=h.dist(l)),d=c?c.sub(h)._unit()._perp():f,f=f||d;var w=f.add(d)._unit(),S=w.x*d.x+w.y*d.y,M=1/S,E=l&&c,T=E?e:c?v:_;if(E&&"round"===T&&(n>M?T="miter":2>=M&&(T="fakeround")),"miter"===T&&M>i&&(T="bevel"),"bevel"===T&&(M>2&&(T="flipbevel"),i>M&&(T="miter")),"miter"===T)w._mult(M),this.addCurrentVertex(h,g,y,w,0,0,!1);else if("flipbevel"===T){if(M>100)w=d.clone();else{var z=f.x*d.y-f.y*d.x>0?-1:1,A=M*f.add(d).mag()/f.sub(d).mag();w._perp()._mult(A*z)}this.addCurrentVertex(h,g,y,w,0,0,!1),g=-g}else if("bevel"===T||"fakeround"===T){var P=g*(f.x*d.y-f.y*d.x)>0,I=-Math.sqrt(M*M-1);if(P?(m=0,p=I):(p=0,m=I),x||this.addCurrentVertex(h,g,y,f,p,m,!1),"fakeround"===T){for(var L,k=Math.floor(8*(.5-(S-.5))),D=0;k>D;D++)L=d.mult((D+1)/(k+1))._add(f)._unit(),this.addPieSliceVertex(h,g,y,L,P);this.addPieSliceVertex(h,g,y,w,P);for(var R=k-1;R>=0;R--)L=f.mult((R+1)/(k+1))._add(d)._unit(),this.addPieSliceVertex(h,g,y,L,P)}c&&this.addCurrentVertex(h,g,y,d,-p,-m,!1)}else"butt"===T?(x||this.addCurrentVertex(h,g,y,f,0,0,!1),c&&this.addCurrentVertex(h,g,y,d,0,0,!1)):"square"===T?(x||(this.addCurrentVertex(h,g,y,f,1,1,!1),this.e1=this.e2=-1,g=1),c&&this.addCurrentVertex(h,g,y,d,-1,-1,!1)):"round"===T&&(x||(this.addCurrentVertex(h,g,y,f,0,0,!1),this.addCurrentVertex(h,g,y,f,1,1,!0),this.e1=this.e2=-1,g=1),c&&(this.addCurrentVertex(h,g,y,d,-1,-1,!0),this.addCurrentVertex(h,g,y,d,0,0,!1)));x=!1}}}},i.prototype.addCurrentVertex=function(t,e,r,i,n,o,a){var s,u=a?1:0,h=this.buffers.lineVertex,l=this.buffers.lineElement,c=this.elementGroups.current,f=this.elementGroups.current.vertexStartIndex;s=i.mult(e),n&&s._sub(i.perp()._mult(n)),this.e3=h.add(t,s,u,0,r)-f,this.e1>=0&&this.e2>=0&&(l.add(this.e1,this.e2,this.e3),c.elementLength++),this.e1=this.e2,this.e2=this.e3,s=i.mult(-e),o&&s._sub(i.perp()._mult(o)),this.e3=h.add(t,s,u,1,r)-f,this.e1>=0&&this.e2>=0&&(l.add(this.e1,this.e2,this.e3),c.elementLength++),this.e1=this.e2,this.e2=this.e3,c.vertexLength+=2},i.prototype.addPieSliceVertex=function(t,e,r,i,n){var o=this.buffers.lineVertex,a=this.buffers.lineElement,s=this.elementGroups.current,u=this.elementGroups.current.vertexStartIndex,h=n;i=i.mult(e*(n?-1:1)),this.e3=o.add(t,i,0,h,r)-u,s.vertexLength+=1,this.e1>=0&&this.e2>=0&&(a.add(this.e1,this.e2,this.e3),s.elementLength++),n?this.e2=this.e3:this.e1=this.e3}},{"./element_groups":19}],23:[function(t,e,r){"use strict";function i(t,e,r,i,n){this.buffers=t,this.layoutProperties=e,this.overscaling=r,this.zoom=i,this.collisionDebug=n;var o=512*r,a=4096;this.tilePixelRatio=a/o,this.compareText={},this.symbolInstances=[]}function n(t,e,r,i,n,o,a,s,u,h,l,c){this.x=t.x,this.y=t.y,this.hasText=!!r,this.hasIcon=!!i,this.hasText&&(this.glyphQuads=o?v(t,r,a,e,n,u):[],this.textCollisionFeature=new x(e,t,r,a,s,u)),this.hasIcon&&(this.iconQuads=o?_(t,i,h,e,n,c):[],this.iconCollisionFeature=new x(e,t,i,h,l,c))}var o=t("./element_groups"),a=t("../symbol/anchor"),s=t("../symbol/get_anchors"),u=t("../util/token"),h=t("../symbol/quads"),l=t("../symbol/shaping"),c=t("../symbol/resolve_text"),f=t("../symbol/resolve_icons"),d=t("../symbol/mergelines"),p=l.shapeText,m=l.shapeIcon,v=h.getGlyphQuads,_=h.getIconQuads,g=t("../symbol/clip_line"),y=t("point-geometry"),x=t("../symbol/collision_feature");e.exports=i,i.prototype.needsPlacement=!0,i.prototype.addFeatures=function(t){var e=this.layoutProperties,r=this.features,i=this.textFeatures,n=.5,o=.5;switch(e["text-anchor"]){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(e["text-anchor"]){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}for(var a="right"===e["text-justify"]?1:"left"===e["text-justify"]?0:.5,s=24,h=e["text-line-height"]*s,l="line"!==e["symbol-placement"]?e["text-max-width"]*s:0,c=e["text-letter-spacing"]*s,f=[e["text-offset"][0]*s,e["text-offset"][1]*s],v=e["text-font"],_=[],g=0;g<r.length;g++)_.push(r[g].loadGeometry());if("line"===e["symbol-placement"]){var y=d(r,i,_);_=y.geometries,r=y.features,i=y.textFeatures}for(var x,b,w=0;w<r.length;w++)if(_[w]){if(x=i[w]?p(i[w],this.stacks[v],l,h,n,o,a,c,f):null,e["icon-image"]){var S=u(r[w].properties,e["icon-image"]),M=this.icons[S];b=m(M,e),M&&(void 0===this.sdfIcons?this.sdfIcons=M.sdf:this.sdfIcons!==M.sdf&&console.warn("Style sheet warning: Cannot mix SDF and non-SDF icons in one bucket"))}else b=null;(x||b)&&this.addFeature(_[w],x,b)}this.placeFeatures(t,this.buffers,this.collisionDebug)},i.prototype.addFeature=function(t,e,r){var i=this.layoutProperties,o=24,u=i["text-max-size"]/o,h=this.tilePixelRatio*u,l=this.tilePixelRatio*i["icon-max-size"],c=this.tilePixelRatio*i["symbol-min-distance"],f=i["symbol-avoid-edges"],d=i["text-padding"]*this.tilePixelRatio,p=i["icon-padding"]*this.tilePixelRatio,m=i["text-max-angle"]/180*Math.PI,v="map"===i["text-rotation-alignment"]&&"line"===i["symbol-placement"],_="map"===i["icon-rotation-alignment"]&&"line"===i["symbol-placement"],y=i["text-allow-overlap"]||i["icon-allow-overlap"]||i["text-ignore-placement"]||i["icon-ignore-placement"],x="line"===i["symbol-placement"],b=c/2;x&&(t=g(t,0,0,4096,4096));for(var w=0;w<t.length;w++)for(var S=t[w],M=x?s(S,c,m,e,r,o,h,this.overscaling):[new a(S[0].x,S[0].y,0)],E=0,T=M.length;T>E;E++){var z=M[E];if(!(e&&x&&this.anchorIsTooClose(e.text,b,z))){var A=!(z.x<0||z.x>4096||z.y<0||z.y>4096);if(!f||A){var P=A||y;this.symbolInstances.push(new n(z,S,e,r,i,P,h,d,v,l,p,_))}}}},i.prototype.anchorIsTooClose=function(t,e,r){var i=this.compareText;if(t in i){for(var n=i[t],o=n.length-1;o>=0;o--)if(r.dist(n[o])<e)return!0}else i[t]=[];return i[t].push(r),!1},i.prototype.placeFeatures=function(t,e,r){this.buffers=e;var i=this.elementGroups={text:new o(e.glyphVertex,e.glyphElement),icon:new o(e.iconVertex,e.iconElement),sdfIcons:this.sdfIcons},n=this.layoutProperties,a=t.maxScale,s="map"===n["text-rotation-alignment"]&&"line"===n["symbol-placement"],u="map"===n["icon-rotation-alignment"]&&"line"===n["symbol-placement"],h=n["text-allow-overlap"]||n["icon-allow-overlap"]||n["text-ignore-placement"]||n["icon-ignore-placement"];if(h){var l=t.angle,c=Math.sin(l),f=Math.cos(l);this.symbolInstances.sort(function(t,e){var r=c*t.x+f*t.y,i=c*e.x+f*e.y;return i-r})}for(var d=0;d<this.symbolInstances.length;d++){var p=this.symbolInstances[d],m=p.hasText,v=p.hasIcon,_=n["text-optional"]||!m,g=n["icon-optional"]||!v,y=m&&!n["text-allow-overlap"]?t.placeCollisionFeature(p.textCollisionFeature):t.minScale,x=v&&!n["icon-allow-overlap"]?t.placeCollisionFeature(p.iconCollisionFeature):t.minScale;_||g?!g&&y?y=Math.max(x,y):!_&&x&&(x=Math.max(x,y)):x=y=Math.max(x,y),m&&(n["text-ignore-placement"]||t.insertCollisionFeature(p.textCollisionFeature,y),a>=y&&this.addSymbols(e.glyphVertex,e.glyphElement,i.text,p.glyphQuads,y,n["text-keep-upright"],s,t.angle)),v&&(n["icon-ignore-placement"]||t.insertCollisionFeature(p.iconCollisionFeature,x),a>=x&&this.addSymbols(e.iconVertex,e.iconElement,i.icon,p.iconQuads,x,n["icon-keep-upright"],u,t.angle))}r&&this.addToDebugBuffers(t)},i.prototype.addSymbols=function(t,e,r,i,n,o,a,s){r.makeRoomFor(4*i.length);for(var u=r.current,h=this.zoom,l=Math.max(Math.log(n)/Math.LN2+h,0),c=0;c<i.length;c++){var f=i[c],d=f.angle,p=(d+s+Math.PI)%(2*Math.PI);if(!(o&&a&&(p<=Math.PI/2||p>3*Math.PI/2))){var m=f.tl,v=f.tr,_=f.bl,g=f.br,y=f.tex,x=f.anchorPoint,b=Math.max(h+Math.log(f.minScale)/Math.LN2,l),w=Math.min(h+Math.log(f.maxScale)/Math.LN2,25);if(!(b>=w)){b===l&&(b=0);var S=t.index-u.vertexStartIndex;t.add(x.x,x.y,m.x,m.y,y.x,y.y,b,w,l),t.add(x.x,x.y,v.x,v.y,y.x+y.w,y.y,b,w,l),t.add(x.x,x.y,_.x,_.y,y.x,y.y+y.h,b,w,l),t.add(x.x,x.y,g.x,g.y,y.x+y.w,y.y+y.h,b,w,l),u.vertexLength+=4,e.add(S,S+1,S+2),e.add(S+1,S+2,S+3),u.elementLength+=2}}}},i.prototype.getDependencies=function(t,e,r){function i(t){return t||n?r(t):void(n=!0)}var n=!1;this.getTextDependencies(t,e,i),this.getIconDependencies(t,e,i)},i.prototype.getIconDependencies=function(t,e,r){function i(t,e){return t?r(t):(this.icons=e,void r())}if(this.layoutProperties["icon-image"]){var n=this.features,o=f(n,this.layoutProperties);o.length?e.send("get icons",{icons:o},i.bind(this)):r()}else r()},i.prototype.getTextDependencies=function(t,e,r){var i=this.features,n=this.layoutProperties["text-font"],o=this.stacks=t.stacks;void 0===o[n]&&(o[n]={});var a=o[n],s=c(i,this.layoutProperties,a);this.textFeatures=s.textFeatures,e.send("get glyphs",{uid:t.uid,fontstack:n,codepoints:s.codepoints},function(t,e){if(t)return r(t);for(var i in e)a[i]=e[i];r()})},i.prototype.addToDebugBuffers=function(t){this.elementGroups.collisionBox=new o(this.buffers.collisionBoxVertex),this.elementGroups.collisionBox.makeRoomFor(0);for(var e=this.buffers.collisionBoxVertex,r=-t.angle,i=t.yStretch,n=0;n<this.symbolInstances.length;n++)for(var a=0;2>a;a++){var s=this.symbolInstances[n][0===a?"textCollisionFeature":"iconCollisionFeature"];if(s)for(var u=s.boxes,h=0;h<u.length;h++){var l=u[h],c=l.anchorPoint,f=new y(l.x1,l.y1*i)._rotate(r),d=new y(l.x2,l.y1*i)._rotate(r),p=new y(l.x1,l.y2*i)._rotate(r),m=new y(l.x2,l.y2*i)._rotate(r),v=Math.max(0,Math.min(25,this.zoom+Math.log(l.maxScale)/Math.LN2)),_=Math.max(0,Math.min(25,this.zoom+Math.log(l.placementScale)/Math.LN2));e.add(c,f,v,_),e.add(c,d,v,_),e.add(c,d,v,_),e.add(c,m,v,_),e.add(c,m,v,_),e.add(c,p,v,_),e.add(c,p,v,_),e.add(c,f,v,_),this.elementGroups.collisionBox.current.vertexLength+=8}}}},{"../symbol/anchor":66,"../symbol/clip_line":69,"../symbol/collision_feature":71,"../symbol/get_anchors":73,"../symbol/mergelines":76,"../symbol/quads":77,"../symbol/resolve_icons":78,"../symbol/resolve_text":79,"../symbol/shaping":80,"../util/token":109,"./element_groups":19,"point-geometry":137}],24:[function(t,e,r){"use strict";function i(t,e,r){this.column=t,this.row=e,this.zoom=r}e.exports=i,i.prototype={clone:function(){return new i(this.column,this.row,this.zoom)},zoomTo:function(t){return this.clone()._zoomTo(t)},sub:function(t){return this.clone()._sub(t)},_zoomTo:function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},_sub:function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this}}},{}],25:[function(t,e,r){"use strict";function i(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e}e.exports=i;var n=t("../util/util").wrap;i.prototype.wrap=function(){return new i(this.lat,n(this.lng,-180,180))},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},{"../util/util":110}],26:[function(t,e,r){"use strict";function i(t,e){if(t)for(var r=e?[t,e]:t,i=0,n=r.length;n>i;i++)this.extend(r[i])}e.exports=i;var n=t("./lat_lng");i.prototype={extend:function(t){var e,r,o=this._sw,a=this._ne;if(t instanceof n)e=t,r=t;else{if(!(t instanceof i))return t?this.extend(n.convert(t)||i.convert(t)):this;if(e=t._sw,r=t._ne,!e||!r)return this}return o||a?(o.lat=Math.min(e.lat,o.lat),o.lng=Math.min(e.lng,o.lng),a.lat=Math.max(r.lat,a.lat),a.lng=Math.max(r.lng,a.lng)):(this._sw=new n(e.lat,e.lng),this._ne=new n(r.lat,r.lng)),this},getCenter:function(){return new n((this._sw.lat+this._ne.lat)/2,(this._sw.lng+this._ne.lng)/2)},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getNorthWest:function(){return new n(this.getNorth(),this.getWest())},getSouthEast:function(){return new n(this.getSouth(),this.getEast())},getWest:function(){return this._sw.lng},getSouth:function(){return this._sw.lat},getEast:function(){return this._ne.lng},getNorth:function(){return this._ne.lat}},i.convert=function(t){return!t||t instanceof i?t:new i(t)}},{"./lat_lng":25}],27:[function(t,e,r){"use strict";function i(t,e){this.tileSize=512,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this.zoom=0,this.center=new n(0,0),this.angle=0,this._altitude=1.5,this._pitch=0}var n=t("./lat_lng"),o=t("point-geometry"),a=t("./coordinate"),s=t("../util/util").wrap,u=t("../util/interpolate"),h=t("gl-matrix").vec4,l=t("gl-matrix").mat4;e.exports=i,i.prototype={get minZoom(){return this._minZoom},set minZoom(t){this._minZoom=t,this.zoom=Math.max(this.zoom,t)},get maxZoom(){return this._maxZoom},set maxZoom(t){this._maxZoom=t,this.zoom=Math.min(this.zoom,t)},get worldSize(){return this.tileSize*this.scale},get centerPoint(){return this.size._div(2)},get size(){return new o(this.width,this.height)},get bearing(){return-this.angle/Math.PI*180},set bearing(t){this.angle=-s(t,-180,180)*Math.PI/180},get pitch(){return this._pitch/Math.PI*180},set pitch(t){this._pitch=Math.min(60,t)/180*Math.PI},get altitude(){return this._altitude},set altitude(t){this._altitude=Math.max(.75,t)},get zoom(){return this._zoom},set zoom(t){t=Math.min(Math.max(t,this.minZoom),this.maxZoom),this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain()},zoomScale:function(t){return Math.pow(2,t)},scaleZoom:function(t){return Math.log(t)/Math.LN2},project:function(t,e){return new o(this.lngX(t.lng,e),this.latY(t.lat,e))},unproject:function(t,e){return new n(this.yLat(t.y,e),this.xLng(t.x,e))},get x(){return this.lngX(this.center.lng)},get y(){return this.latY(this.center.lat)},get point(){return new o(this.x,this.y)},lngX:function(t,e){return(180+t)*(e||this.worldSize)/360},latY:function(t,e){var r=180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360));return(180-r)*(e||this.worldSize)/360},xLng:function(t,e){return 360*t/(e||this.worldSize)-180},yLat:function(t,e){var r=180-360*t/(e||this.worldSize);return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90},panBy:function(t){var e=this.centerPoint._add(t);this.center=this.pointLocation(e),this._constrain()},setLocationAtPoint:function(t,e){var r=this.locationCoordinate(t),i=this.pointCoordinate(e),n=this.pointCoordinate(this.centerPoint),o=i._sub(r);this.center=this.coordinateLocation(n._sub(o)),this._constrain()},setZoomAround:function(t,e){var r;e&&(r=this.locationPoint(e)),this.zoom=t,e&&this.setLocationAtPoint(e,r)},setBearingAround:function(t,e){var r;e&&(r=this.locationPoint(e)),this.bearing=t,e&&this.setLocationAtPoint(e,r)},locationPoint:function(t){return this.coordinatePoint(this.locationCoordinate(t))},pointLocation:function(t){return this.coordinateLocation(this.pointCoordinate(t))},locationCoordinate:function(t){var e=this.zoomScale(this.tileZoom)/this.worldSize;return new a(this.lngX(t.lng)*e,this.latY(t.lat)*e,this.tileZoom)},coordinateLocation:function(t){var e=this.zoomScale(t.zoom);return new n(this.yLat(t.row,e),this.xLng(t.column,e))},pointCoordinate:function(t,e){void 0===e&&(e=0);var r=this.coordinatePointMatrix(this.tileZoom),i=l.invert(new Float64Array(16),r);if(!i)throw"failed to invert matrix";var n=h.transformMat4([],[t.x,t.y,0,1],i),o=h.transformMat4([],[t.x,t.y,1,1],i),s=n[3],c=o[3],f=n[0]/s,d=o[0]/c,p=n[1]/s,m=o[1]/c,v=n[2]/s,_=o[2]/c,g=v===_?0:(e-v)/(_-v);return new a(u(f,d,g),u(p,m,g),this.tileZoom)},coordinatePoint:function(t){var e=this.coordinatePointMatrix(t.zoom),r=h.transformMat4([],[t.column,t.row,0,1],e);return new o(r[0]/r[3],r[1]/r[3])},coordinatePointMatrix:function(t){var e=this.getProjMatrix(),r=this.worldSize/this.zoomScale(t);return l.scale(e,e,[r,r,1]),l.multiply(e,this.getPixelMatrix(),e),e},getPixelMatrix:function(){var t=l.create();return l.scale(t,t,[this.width/2,-this.height/2,1]),l.translate(t,t,[1,-1,0]),t},_constrain:function(){if(this.center){var t,e,r,i,n,a,s,u,h=this.size;this.latRange&&(t=this.latY(this.latRange[1]),e=this.latY(this.latRange[0]),n=e-t<h.y?h.y/(e-t):0),this.lngRange&&(r=this.lngX(this.lngRange[0]),i=this.lngX(this.lngRange[1]),a=i-r<h.x?h.x/(i-r):0);var l=Math.max(a||0,n||0);if(l)return this.center=this.unproject(new o(a?(i+r)/2:this.x,n?(e+t)/2:this.y)),void(this.zoom+=this.scaleZoom(l));if(this.latRange){var c=this.y,f=h.y/2;t>c-f&&(u=t+f),c+f>e&&(u=e-f)}if(this.lngRange){var d=this.x,p=h.x/2;r>d-p&&(s=r+p),d+p>i&&(s=i-p)}(void 0!==s||void 0!==u)&&(this.center=this.unproject(new o(void 0!==s?s:this.x,void 0!==u?u:this.y)))}},getProjMatrix:function(){var t=new Float64Array(16),e=Math.atan(.5/this.altitude),r=Math.sin(e)*this.altitude/Math.sin(Math.PI/2-this._pitch-e),i=Math.cos(Math.PI/2-this._pitch)*r+this.altitude;return l.perspective(t,2*Math.atan(this.height/2/this.altitude),this.width/this.height,.1,i),l.translate(t,t,[0,0,-this.altitude]),l.scale(t,t,[1,-1,1/this.height]),l.rotateX(t,t,this._pitch),l.rotateZ(t,t,this.angle),l.translate(t,t,[-this.x,-this.y,0]),t}}},{"../util/interpolate":106,"../util/util":110,"./coordinate":24,"./lat_lng":25,"gl-matrix":119,"point-geometry":137}],28:[function(t,e,r){"use strict";var i={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],
H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};e.exports=function(t,e,r,n){n=n||1;var o,a,s,u,h,l,c,f,d=[];for(o=0,a=t.length;a>o;o++)if(h=i[t[o]]){for(f=null,s=0,u=h[1].length;u>s;s+=2)-1===h[1][s]&&-1===h[1][s+1]?f=null:(l=e+h[1][s]*n,c=r-h[1][s+1]*n,f&&d.push(f.x,f.y,l,c),f={x:l,y:c});e+=h[0]*n}return d}},{}],29:[function(t,e,r){"use strict";var i=e.exports={};i.Map=t("./ui/map"),i.Control=t("./ui/control/control"),i.Navigation=t("./ui/control/navigation"),i.Attribution=t("./ui/control/attribution"),i.Popup=t("./ui/popup"),i.GeoJSONSource=t("./source/geojson_source"),i.VideoSource=t("./source/video_source"),i.Style=t("./style/style"),i.LatLng=t("./geo/lat_lng"),i.LatLngBounds=t("./geo/lat_lng_bounds"),i.Point=t("point-geometry"),i.Evented=t("./util/evented"),i.util=t("./util/util"),i.supported=t("./util/browser").supported;var n=t("./util/ajax");i.util.getJSON=n.getJSON,i.util.getArrayBuffer=n.getArrayBuffer;var o=t("./util/config");i.config=o,Object.defineProperty(i,"accessToken",{get:function(){return o.ACCESS_TOKEN},set:function(t){o.ACCESS_TOKEN=t}})},{"./geo/lat_lng":25,"./geo/lat_lng_bounds":26,"./source/geojson_source":43,"./source/video_source":51,"./style/style":59,"./ui/control/attribution":83,"./ui/control/control":84,"./ui/control/navigation":85,"./ui/map":95,"./ui/popup":96,"./util/ajax":98,"./util/browser":99,"./util/config":103,"./util/evented":104,"./util/util":110,"point-geometry":137}],30:[function(t,e,r){"use strict";function i(t,e,r){var i,o=t.gl,a=e.paint["background-color"],s=e.paint["background-image"],u=e.paint["background-opacity"],h=s?t.spriteAtlas.getPosition(s.from,!0):null,l=s?t.spriteAtlas.getPosition(s.to,!0):null;if(h&&l){i=t.patternShader,o.switchShader(i,r),o.uniform1i(i.u_image,0),o.uniform2fv(i.u_pattern_tl_a,h.tl),o.uniform2fv(i.u_pattern_br_a,h.br),o.uniform2fv(i.u_pattern_tl_b,l.tl),o.uniform2fv(i.u_pattern_br_b,l.br),o.uniform1f(i.u_opacity,u);var c=t.transform,f=h.size,d=l.size,p=c.locationCoordinate(c.center),m=1/Math.pow(2,c.zoomFraction);o.uniform1f(i.u_mix,s.t);var v=n.create();n.scale(v,v,[1/(f[0]*s.fromScale),1/(f[1]*s.fromScale)]),n.translate(v,v,[p.column*c.tileSize%(f[0]*s.fromScale),p.row*c.tileSize%(f[1]*s.fromScale)]),n.rotate(v,v,-c.angle),n.scale(v,v,[m*c.width/2,-m*c.height/2]);var _=n.create();n.scale(_,_,[1/(d[0]*s.toScale),1/(d[1]*s.toScale)]),n.translate(_,_,[p.column*c.tileSize%(d[0]*s.toScale),p.row*c.tileSize%(d[1]*s.toScale)]),n.rotate(_,_,-c.angle),n.scale(_,_,[m*c.width/2,-m*c.height/2]),o.uniformMatrix3fv(i.u_patternmatrix_a,!1,v),o.uniformMatrix3fv(i.u_patternmatrix_b,!1,_),t.spriteAtlas.bind(o,!0)}else i=t.fillShader,o.switchShader(i,r),o.disableVertexAttribArray(i.a_color),o.vertexAttrib4fv(i.a_color,a);o.disable(o.STENCIL_TEST),o.bindBuffer(o.ARRAY_BUFFER,t.backgroundBuffer),o.vertexAttribPointer(i.a_pos,t.backgroundBuffer.itemSize,o.SHORT,!1,0,0),o.drawArrays(o.TRIANGLE_STRIP,0,t.backgroundBuffer.itemCount),o.enable(o.STENCIL_TEST),o.stencilMask(0),o.stencilFunc(o.EQUAL,128,128)}var n=t("gl-matrix").mat3;e.exports=i},{"gl-matrix":119}],31:[function(t,e,r){"use strict";function i(t,e,r,i){var n=i.elementGroups[e.ref||e.id].collisionBox;if(n){var o=t.gl,a=i.buffers.collisionBoxVertex,s=t.collisionBoxShader;o.enable(o.STENCIL_TEST),o.switchShader(s,r),a.bind(o,s),o.lineWidth(1);var u=12;o.vertexAttribPointer(s.a_pos,2,o.SHORT,!1,u,0),o.vertexAttribPointer(s.a_extrude,2,o.SHORT,!1,u,4),o.vertexAttribPointer(s.a_data,2,o.UNSIGNED_BYTE,!1,u,8),o.uniform1f(s.u_scale,Math.pow(2,t.transform.zoom-i.coord.z)),o.uniform1f(s.u_zoom,10*t.transform.zoom),o.uniform1f(s.u_maxzoom,10*(i.coord.z+1));var h=n.groups[0].vertexStartIndex,l=n.groups[0].vertexLength;o.drawArrays(o.LINES,h,l),o.disable(o.STENCIL_TEST)}}e.exports=i},{}],32:[function(t,e,r){"use strict";function i(t,e){var r=t.gl;r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.switchShader(t.debugShader,e.posMatrix),r.bindBuffer(r.ARRAY_BUFFER,t.debugBuffer),r.vertexAttribPointer(t.debugShader.a_pos,t.debugBuffer.itemSize,r.SHORT,!1,0,0),r.uniform4f(t.debugShader.u_color,1,0,0,1),r.lineWidth(4),r.drawArrays(r.LINE_STRIP,0,t.debugBuffer.itemCount);var i=n(e.coord.toString(),50,200,5);r.bindBuffer(r.ARRAY_BUFFER,t.debugTextBuffer),r.bufferData(r.ARRAY_BUFFER,new Int16Array(i),r.STREAM_DRAW),r.vertexAttribPointer(t.debugShader.a_pos,t.debugTextBuffer.itemSize,r.SHORT,!1,0,0),r.lineWidth(8*o.devicePixelRatio),r.uniform4f(t.debugShader.u_color,1,1,1,1),r.drawArrays(r.LINES,0,i.length/t.debugTextBuffer.itemSize),r.lineWidth(2*o.devicePixelRatio),r.uniform4f(t.debugShader.u_color,0,0,0,1),r.drawArrays(r.LINES,0,i.length/t.debugTextBuffer.itemSize),r.blendFunc(r.ONE_MINUS_DST_ALPHA,r.ONE)}var n=t("../lib/debugtext"),o=t("../util/browser");e.exports=i},{"../lib/debugtext":28,"../util/browser":99}],33:[function(t,e,r){"use strict";function i(t,e,r,i){if(i.buffers){var a=i.elementGroups[e.ref||e.id];if(a){var s,u,h,l,c=t.gl,f=t.translateMatrix(r,i,e.paint["fill-translate"],e.paint["fill-translate-anchor"]),d=e.paint["fill-color"];c.stencilMask(63),c.clear(c.STENCIL_BUFFER_BIT),c.stencilFunc(c.NOTEQUAL,128,128),c.stencilOpSeparate(c.FRONT,c.INCR_WRAP,c.KEEP,c.KEEP),c.stencilOpSeparate(c.BACK,c.DECR_WRAP,c.KEEP,c.KEEP),c.colorMask(!1,!1,!1,!1),c.switchShader(t.fillShader,f),s=i.buffers.fillVertex,s.bind(c),u=i.buffers.fillElement,u.bind(c);var p,m;c.disableVertexAttribArray(t.fillShader.a_color);for(var v=0;v<a.groups.length;v++)h=a.groups[v],p=h.vertexStartIndex*s.itemSize,c.vertexAttribPointer(t.fillShader.a_pos,2,c.SHORT,!1,4,p+0),l=3*h.elementLength,m=h.elementStartIndex*u.itemSize,c.drawElements(c.TRIANGLES,l,c.UNSIGNED_SHORT,m);c.colorMask(!0,!0,!0,!0),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),c.stencilMask(0);var _=e.paint["fill-outline-color"];if(e.paint["fill-antialias"]===!0&&(!e.paint["fill-image"]||_)){c.switchShader(t.outlineShader,f),c.lineWidth(2*n.devicePixelRatio),_?c.stencilFunc(c.EQUAL,128,128):c.stencilFunc(c.EQUAL,128,191),c.uniform2f(t.outlineShader.u_world,c.drawingBufferWidth,c.drawingBufferHeight),s=i.buffers.fillVertex,u=i.buffers.outlineElement,u.bind(c),c.disableVertexAttribArray(t.outlineShader.a_color),c.vertexAttrib4fv(t.outlineShader.a_color,_?_:d);for(var g=0;g<a.groups.length;g++)h=a.groups[g],p=h.vertexStartIndex*s.itemSize,c.vertexAttribPointer(t.outlineShader.a_pos,2,c.SHORT,!1,4,p+0),l=2*h.secondElementLength,m=h.secondElementStartIndex*u.itemSize,c.drawElements(c.LINES,l,c.UNSIGNED_SHORT,m)}var y,x=e.paint["fill-image"],b=e.paint["fill-opacity"]||1;if(x){var w=t.spriteAtlas.getPosition(x.from,!0),S=t.spriteAtlas.getPosition(x.to,!0);if(!w||!S)return;y=t.patternShader,c.switchShader(y,r),c.uniform1i(y.u_image,0),c.uniform2fv(y.u_pattern_tl_a,w.tl),c.uniform2fv(y.u_pattern_br_a,w.br),c.uniform2fv(y.u_pattern_tl_b,S.tl),c.uniform2fv(y.u_pattern_br_b,S.br),c.uniform1f(y.u_opacity,b),c.uniform1f(y.u_mix,x.t);var M=i.tileExtent/i.tileSize/Math.pow(2,t.transform.tileZoom-i.coord.z),E=o.create();o.scale(E,E,[1/(w.size[0]*M*x.fromScale),1/(w.size[1]*M*x.fromScale)]);var T=o.create();o.scale(T,T,[1/(S.size[0]*M*x.toScale),1/(S.size[1]*M*x.toScale)]),c.uniformMatrix3fv(y.u_patternmatrix_a,!1,E),c.uniformMatrix3fv(y.u_patternmatrix_b,!1,T),t.spriteAtlas.bind(c,!0)}else y=t.fillShader,c.switchShader(y,r),c.disableVertexAttribArray(y.a_color),c.vertexAttrib4fv(y.a_color,d);c.stencilFunc(c.NOTEQUAL,0,63),c.bindBuffer(c.ARRAY_BUFFER,t.tileExtentBuffer),c.vertexAttribPointer(y.a_pos,t.tileExtentBuffer.itemSize,c.SHORT,!1,0,0),c.drawArrays(c.TRIANGLE_STRIP,0,t.tileExtentBuffer.itemCount),c.stencilMask(0),c.stencilFunc(c.EQUAL,128,128)}}}var n=t("../util/browser"),o=t("gl-matrix").mat3;e.exports=i},{"../util/browser":99,"gl-matrix":119}],34:[function(t,e,r){"use strict";var i=t("../util/browser"),n=t("gl-matrix").mat2;e.exports=function(t,e,r,o){if(o.buffers){var a=o.elementGroups[e.ref||e.id];if(a){var s=t.gl;if(!(e.paint["line-width"]<=0)){var u=1/i.devicePixelRatio,h=e.paint["line-blur"]+u,l=e.paint["line-width"]/2,c=-1,f=0,d=0;e.paint["line-gap-width"]>0&&(c=e.paint["line-gap-width"]/2+.5*u,l=e.paint["line-width"],f=c-u/2);var p=f+l+u/2+d,m=e.paint["line-color"],v=t.transform.scale/(1<<o.coord.z)/(o.tileExtent/o.tileSize),_=t.translateMatrix(r,o,e.paint["line-translate"],e.paint["line-translate-anchor"]),g=t.transform,y=n.create();n.scale(y,y,[1,Math.cos(g._pitch)]),n.rotate(y,y,t.transform.angle);var x,b=Math.sqrt(g.height*g.height/4*(1+g.altitude*g.altitude)),w=g.height/2*Math.tan(g._pitch),S=(b+w)/b-1,M=o.tileSize/t.transform.tileSize,E=e.paint["line-dasharray"],T=e.paint["line-image"];if(E){x=t.linesdfpatternShader,s.switchShader(x,_,o.exMatrix),s.uniform1f(x.u_ratio,v);var z=t.lineAtlas.getDash(E.from,"round"===e.layout["line-cap"]),A=t.lineAtlas.getDash(E.to,"round"===e.layout["line-cap"]);t.lineAtlas.bind(s);var P=Math.pow(2,Math.floor(Math.log(t.transform.scale)/Math.LN2)-o.coord.z)/8*M,I=[P/z.width/E.fromScale,-z.height/2],L=t.lineAtlas.width/(E.fromScale*z.width*256*i.devicePixelRatio)/2,k=[P/A.width/E.toScale,-A.height/2],D=t.lineAtlas.width/(E.toScale*A.width*256*i.devicePixelRatio)/2;s.uniform2fv(x.u_patternscale_a,I),s.uniform1f(x.u_tex_y_a,z.y),s.uniform2fv(x.u_patternscale_b,k),s.uniform1f(x.u_tex_y_b,A.y),s.uniform1i(x.u_image,0),s.uniform1f(x.u_sdfgamma,Math.max(L,D)),s.uniform1f(x.u_mix,E.t)}else if(T){var R=t.spriteAtlas.getPosition(T.from,!0),O=t.spriteAtlas.getPosition(T.to,!0);if(!R||!O)return;var j=o.tileExtent/o.tileSize/Math.pow(2,t.transform.tileZoom-o.coord.z)*M;t.spriteAtlas.bind(s,!0),x=t.linepatternShader,s.switchShader(x,_,o.exMatrix),s.uniform1f(x.u_ratio,v),s.uniform2fv(x.u_pattern_size_a,[R.size[0]*j*T.fromScale,O.size[1]]),s.uniform2fv(x.u_pattern_size_b,[O.size[0]*j*T.toScale,O.size[1]]),s.uniform2fv(x.u_pattern_tl_a,R.tl),s.uniform2fv(x.u_pattern_br_a,R.br),s.uniform2fv(x.u_pattern_tl_b,O.tl),s.uniform2fv(x.u_pattern_br_b,O.br),s.uniform1f(x.u_fade,T.t),s.disableVertexAttribArray(x.a_opacity),s.vertexAttrib1f(x.a_opacity,e.paint["line-opacity"])}else x=t.lineShader,s.switchShader(x,_,o.exMatrix),s.uniform1f(x.u_ratio,v),s.uniform1f(x.u_extra,S),s.uniformMatrix2fv(x.u_antialiasingmatrix,!1,y);void 0!==x.a_color&&(s.disableVertexAttribArray(x.a_color),s.vertexAttrib4fv(x.a_color,m)),s.disableVertexAttribArray(x.a_linewidth),s.vertexAttrib2f(x.a_linewidth,p,c),s.disableVertexAttribArray(x.a_blur),s.vertexAttrib1f(x.a_blur,h);var C=o.buffers.lineVertex;C.bind(s);var B=o.buffers.lineElement;B.bind(s);for(var F=0;F<a.groups.length;F++){var N=a.groups[F],q=N.vertexStartIndex*C.itemSize;s.vertexAttribPointer(x.a_pos,2,s.SHORT,!1,8,q+0),s.vertexAttribPointer(x.a_data,4,s.BYTE,!1,8,q+4);var U=3*N.elementLength,V=N.elementStartIndex*B.itemSize;s.drawElements(s.TRIANGLES,U,s.UNSIGNED_SHORT,V)}}}}}},{"../util/browser":99,"gl-matrix":119}],35:[function(t,e,r){"use strict";function i(t,e,r,i){var u=t.gl;u.disable(u.STENCIL_TEST);var h=t.rasterShader;u.switchShader(h,r),u.uniform1f(h.u_brightness_low,e.paint["raster-brightness-min"]),u.uniform1f(h.u_brightness_high,e.paint["raster-brightness-max"]),u.uniform1f(h.u_saturation_factor,a(e.paint["raster-saturation"])),u.uniform1f(h.u_contrast_factor,o(e.paint["raster-contrast"])),u.uniform3fv(h.u_spin_weights,n(e.paint["raster-hue-rotate"]));var l,c,f=i.source&&i.source._pyramid.findLoadedParent(i.coord,0,{}),d=s(i,f,e,t.transform);u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,i.texture),f?(u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f.texture),l=Math.pow(2,f.coord.z-i.coord.z),c=[i.coord.x*l%1,i.coord.y*l%1]):d[1]=0,u.uniform2fv(h.u_tl_parent,c||[0,0]),u.uniform1f(h.u_scale_parent,l||1),u.uniform1f(h.u_buffer_scale,1),u.uniform1f(h.u_opacity0,d[0]),u.uniform1f(h.u_opacity1,d[1]),u.uniform1i(h.u_image0,0),u.uniform1i(h.u_image1,1),u.bindBuffer(u.ARRAY_BUFFER,i.boundsBuffer||t.tileExtentBuffer),u.vertexAttribPointer(h.a_pos,2,u.SHORT,!1,8,0),u.vertexAttribPointer(h.a_texture_pos,2,u.SHORT,!1,8,4),u.drawArrays(u.TRIANGLE_STRIP,0,4),u.enable(u.STENCIL_TEST)}function n(t){t*=Math.PI/180;var e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}function o(t){return t>0?1/(1-t):1+t}function a(t){return t>0?1-1/(1.001-t):-t}function s(t,e,r,i){if(!t.source)return[1,0];var n=(new Date).getTime(),o=r.paint["raster-fade-duration"],a=(n-t.timeAdded)/o,s=e?(n-e.timeAdded)/o:-1,h=t.source._pyramid.coveringZoomLevel(i),l=e?Math.abs(e.coord.z-h)>Math.abs(t.coord.z-h):!1,c=[];!e||l?(c[0]=u.clamp(a,0,1),c[1]=1-c[0]):(c[0]=u.clamp(1-s,0,1),c[1]=1-c[0]);var f=r.paint["raster-opacity"];return c[0]*=f,c[1]*=f,c}var u=t("../util/util");e.exports=i},{"../util/util":110}],36:[function(t,e,r){"use strict";function i(t,e,r,i){if(i.buffers){var o=i.elementGroups[e.ref||e.id];if(o){var a=!(e.layout["text-allow-overlap"]||e.layout["icon-allow-overlap"]||e.layout["text-ignore-placement"]||e.layout["icon-ignore-placement"]),u=t.gl;a&&u.disable(u.STENCIL_TEST),o.text.groups.length&&n(t,e,r,i,o.text,"text",!0),o.icon.groups.length&&n(t,e,r,i,o.icon,"icon",o.sdfIcons),s(t,e,r,i),a&&u.enable(u.STENCIL_TEST)}}}function n(t,e,r,i,n,s,h){var l=t.gl;r=t.translateMatrix(r,i,e.paint[s+"-translate"],e.paint[s+"-translate-anchor"]);var c,f,d,p=t.transform,m="map"===e.layout[s+"-rotation-alignment"],v=m;v?(c=a.create(),f=i.tileExtent/i.tileSize/Math.pow(2,t.transform.zoom-i.coord.z),d=1/Math.cos(p._pitch)):(c=a.clone(i.exMatrix),f=t.transform.altitude,d=1),a.scale(c,c,[f,f,1]);var _=e.paint[s+"-size"],g=_/u[s];a.scale(c,c,[g,g,1]);var y,x,b,w,S=Math.sqrt(p.height*p.height/4*(1+p.altitude*p.altitude)),M=p.height/2*Math.tan(p._pitch),E=(S+M)/S-1,T="text"===s;if(T||t.style.sprite.loaded()){l.activeTexture(l.TEXTURE0),y=h?t.sdfShader:t.iconShader,T?(t.glyphAtlas.updateTexture(l),x=i.buffers.glyphVertex,b=i.buffers.glyphElement,w=[t.glyphAtlas.width/4,t.glyphAtlas.height/4]):(t.spriteAtlas.bind(l,m||t.options.rotating||t.options.zooming||1!==g||h||t.transform.pitch),x=i.buffers.iconVertex,b=i.buffers.iconElement,w=[t.spriteAtlas.width/4,t.spriteAtlas.height/4]),l.switchShader(y,r,c),l.uniform1i(y.u_texture,0),l.uniform2fv(y.u_texsize,w),l.uniform1i(y.u_skewed,v),l.uniform1f(y.u_extra,E);var z=Math.log(_/e.layout[s+"-max-size"])/Math.LN2||0;l.uniform1f(y.u_zoom,10*(t.transform.zoom-z));var A=t.frameHistory.getFadeProperties(300);l.uniform1f(y.u_fadedist,10*A.fadedist),l.uniform1f(y.u_minfadezoom,Math.floor(10*A.minfadezoom)),l.uniform1f(y.u_maxfadezoom,Math.floor(10*A.maxfadezoom)),l.uniform1f(y.u_fadezoom,10*(t.transform.zoom+A.bump));var P,I,L,k;if(b.bind(l),h){var D=8,R=1.19,O=6,j=.105*u[s]/_/o.devicePixelRatio;l.disableVertexAttribArray(y.a_gamma),l.vertexAttrib1f(y.a_gamma,j*d),l.disableVertexAttribArray(y.a_color),l.vertexAttrib4fv(y.a_color,e.paint[s+"-color"]),l.disableVertexAttribArray(y.a_buffer),l.vertexAttrib1f(y.a_buffer,.75);for(var C=0;C<n.groups.length;C++)P=n.groups[C],I=P.vertexStartIndex*x.itemSize,x.bind(l,y,I),L=3*P.elementLength,k=P.elementStartIndex*b.itemSize,l.drawElements(l.TRIANGLES,L,l.UNSIGNED_SHORT,k);if(e.paint[s+"-halo-color"]){l.vertexAttrib4fv(y.a_color,e.paint[s+"-halo-color"]),l.vertexAttrib1f(y.a_buffer,(O-e.paint[s+"-halo-width"]/g)/D),l.vertexAttrib1f(y.a_gamma,(e.paint[s+"-halo-blur"]*R/g/D+j)*d);for(var B=0;B<n.groups.length;B++)P=n.groups[B],I=P.vertexStartIndex*x.itemSize,x.bind(l,y,I),L=3*P.elementLength,k=P.elementStartIndex*b.itemSize,l.drawElements(l.TRIANGLES,L,l.UNSIGNED_SHORT,k)}}else{l.disableVertexAttribArray(y.a_opacity),l.vertexAttrib1f(y.a_opacity,e.paint["icon-opacity"]);for(var F=0;F<n.groups.length;F++)P=n.groups[F],I=P.vertexStartIndex*x.itemSize,x.bind(l,y,I),L=3*P.elementLength,k=P.elementStartIndex*b.itemSize,l.drawElements(l.TRIANGLES,L,l.UNSIGNED_SHORT,k)}}}var o=t("../util/browser"),a=t("gl-matrix").mat4,s=t("./draw_collision_debug");e.exports=i;var u={icon:1,text:24}},{"../util/browser":99,"./draw_collision_debug":31,"gl-matrix":119}],37:[function(t,e,r){"use strict";function i(t,e,r,i){function a(e,r,i,o){s.switchShader(t.dotShader,i),s.uniform1f(t.dotShader.u_size,4*n.devicePixelRatio),s.uniform1f(t.dotShader.u_blur,.25),s.uniform4fv(t.dotShader.u_color,[.1,0,0,.1]),e.bind(s,t.dotShader,0);for(var a=0;a<r.length;a++){var u=r[a],h=u.vertexStartIndex,l=u.vertexLength;s.vertexAttribPointer(t.dotShader.a_pos,2,s.SHORT,!1,o,0),s.drawArrays(s.POINTS,h,l)}}var s=t.gl;if(i&&i.buffers){var u=i.elementGroups[e.ref||e.id];if(u){if(s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),"fill"===e.type)a(i.buffers.fillVertex,u.groups,r,4);else if("symbol"===e.type)a(i.buffers.iconVertex,u.icon.groups,r,16),a(i.buffers.glyphVertex,u.text.groups,r,16);else if("line"===e.type){var h=o.clone(r);o.scale(h,h,[.5,.5,1]),a(i.buffers.lineVertex,u.groups,h,8)}s.blendFunc(s.ONE_MINUS_DST_ALPHA,s.ONE)}}}var n=t("../util/browser"),o=t("gl-matrix").mat4;e.exports=i},{"../util/browser":99,"gl-matrix":119}],38:[function(t,e,r){"use strict";function i(){this.frameHistory=[]}e.exports=i,i.prototype.getFadeProperties=function(t){void 0===t&&(t=300);for(var e=(new Date).getTime();this.frameHistory.length>3&&this.frameHistory[1].time+t<e;)this.frameHistory.shift();this.frameHistory[1].time+t<e&&(this.frameHistory[0].z=this.frameHistory[1].z);var r=this.frameHistory.length;3>r&&console.warn("there should never be less than three frames in the history");var i=this.frameHistory[0].z,n=this.frameHistory[r-1],o=n.z,a=Math.min(i,o),s=Math.max(i,o),u=n.z-this.frameHistory[1].z,h=n.time-this.frameHistory[1].time,l=u/(h/t);isNaN(l)&&console.warn("fadedist should never be NaN");var c=(e-n.time)/t*l;return{fadedist:l,minfadezoom:a,maxfadezoom:s,bump:c}},i.prototype.record=function(t){var e=(new Date).getTime();this.frameHistory.length||this.frameHistory.push({time:0,z:t},{time:0,z:t}),(2===this.frameHistory.length||this.frameHistory[this.frameHistory.length-1].z!==t)&&this.frameHistory.push({time:e,z:t})}},{}],39:[function(t,e,r){"use strict";var i=t("./shaders"),n=t("../util/util");r.extend=function(t){var e=t.lineWidth,r=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);return t.lineWidth=function(i){e.call(t,n.clamp(i,r[0],r[1]))},t.getShader=function(t,e){var r=e===this.FRAGMENT_SHADER?"fragment":"vertex";if(!i[t]||!i[t][r])throw new Error("Could not find shader "+t);var n=this.createShader(e),o=i[t][r];if("undefined"==typeof orientation&&(o=o.replace(/ highp /g," ")),this.shaderSource(n,o),this.compileShader(n),!this.getShaderParameter(n,this.COMPILE_STATUS))throw new Error(this.getShaderInfoLog(n));return n},t.initializeShader=function(t,e,r){var i={program:this.createProgram(),fragment:this.getShader(t,this.FRAGMENT_SHADER),vertex:this.getShader(t,this.VERTEX_SHADER),attributes:[]};if(this.attachShader(i.program,i.vertex),this.attachShader(i.program,i.fragment),this.bindAttribLocation(i.program,0,"a_pos"),this.linkProgram(i.program),this.getProgramParameter(i.program,this.LINK_STATUS)){for(var n=0;n<e.length;n++)i[e[n]]=this.getAttribLocation(i.program,e[n]),i.attributes.push(i[e[n]]);for(var o=0;o<r.length;o++)i[r[o]]=this.getUniformLocation(i.program,r[o])}else console.error(this.getProgramInfoLog(i.program));return i},t.switchShader=function(t,e,r){if(e||console.trace("posMatrix does not have required argument"),this.currentShader!==t){this.useProgram(t.program);for(var i=this.currentShader?this.currentShader.attributes:[],n=0;n<i.length;n++)this.disableVertexAttribArray(i[n]);for(var o=t.attributes,a=0;a<o.length;a++)this.enableVertexAttribArray(o[a]);this.currentShader=t}t.posMatrix!==e&&(this.uniformMatrix4fv(t.u_matrix,!1,e),t.posMatrix=e),r&&t.exMatrix!==r&&t.u_exmatrix&&(this.uniformMatrix4fv(t.u_exmatrix,!1,r),t.exMatrix=r)},t.vertexAttrib2fv=function(e,r){t.vertexAttrib2f(e,r[0],r[1])},t.vertexAttrib3fv=function(e,r){t.vertexAttrib3f(e,r[0],r[1],r[2])},t.vertexAttrib4fv=function(e,r){t.vertexAttrib4f(e,r[0],r[1],r[2],r[3])},t}},{"../util/util":110,"./shaders":42}],40:[function(t,e,r){"use strict";function i(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}}e.exports=i,i.prototype.setSprite=function(t){this.sprite=t},i.prototype.getDash=function(t,e){var r=t.join(",")+e;return this.positions[r]||(this.positions[r]=this.addDash(t,e)),this.positions[r]},i.prototype.addDash=function(t,e){var r=e?7:0,i=2*r+1,n=128;if(this.nextRow+i>this.height)return console.warn("LineAtlas out of space"),null;for(var o=0,a=0;a<t.length;a++)o+=t[a];for(var s=this.width/o,u=s/2,h=t.length%2===1,l=-r;r>=l;l++)for(var c=this.nextRow+r+l,f=this.width*c,d=h?-t[t.length-1]:0,p=t[0],m=1,v=0;v<this.width;v++){for(;v/s>p;)d=p,p+=t[m],h&&m===t.length-1&&(p+=t[0]),m++;var _,g=Math.abs(v-d*s),y=Math.abs(v-p*s),x=Math.min(g,y),b=m%2===1;if(e){var w=r?l/r*(u+1):0;if(b){var S=u-Math.abs(w);_=Math.sqrt(x*x+S*S)}else _=u-Math.sqrt(x*x+w*w)}else _=(b?1:-1)*x;this.data[3+4*(f+v)]=Math.max(0,Math.min(255,_+n))}var M={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,M},i.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))},i.prototype.debug=function(){var t=document.createElement("canvas");document.body.appendChild(t),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.background="#ff0",t.width=this.width,t.height=this.height;for(var e=t.getContext("2d"),r=e.getImageData(0,0,this.width,this.height),i=0;i<this.data.length;i++)if(this.sdf){var n=4*i;r.data[n]=r.data[n+1]=r.data[n+2]=0,r.data[n+3]=this.data[i]}else r.data[i]=this.data[i];e.putImageData(r,0,0)}},{}],41:[function(t,e,r){"use strict";function i(t,e){this.gl=n.extend(t),this.transform=e,this.reusableTextures={},this.preFbos={},this.frameHistory=new s,this.setup()}var n=t("./gl_util"),o=t("../util/browser"),a=t("gl-matrix").mat4,s=t("./frame_history");e.exports=i,i.prototype.resize=function(t,e){var r=this.gl;this.width=t*o.devicePixelRatio,this.height=e*o.devicePixelRatio,r.viewport(0,0,this.width,this.height)},i.prototype.setup=function(){var t=this.gl;t.verbose=!0,t.enable(t.BLEND),t.blendFunc(t.ONE_MINUS_DST_ALPHA,t.ONE),t.enable(t.STENCIL_TEST),this.debugShader=t.initializeShader("debug",["a_pos"],["u_matrix","u_pointsize","u_color"]),this.gaussianShader=t.initializeShader("gaussian",["a_pos"],["u_matrix","u_image","u_offset"]),this.rasterShader=t.initializeShader("raster",["a_pos","a_texture_pos"],["u_matrix","u_brightness_low","u_brightness_high","u_saturation_factor","u_spin_weights","u_contrast_factor","u_opacity0","u_opacity1","u_image0","u_image1","u_tl_parent","u_scale_parent","u_buffer_scale"]),this.lineShader=t.initializeShader("line",["a_pos","a_data","a_color","a_linewidth","a_blur"],["u_matrix","u_ratio","u_extra","u_antialiasingmatrix"]),this.linepatternShader=t.initializeShader("linepattern",["a_pos","a_data","a_linewidth","a_blur","a_opacity"],["u_matrix","u_exmatrix","u_ratio","u_pattern_size_a","u_pattern_size_b","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_fade"]),this.linesdfpatternShader=t.initializeShader("linesdfpattern",["a_pos","a_data","a_color","a_linewidth","a_blur"],["u_matrix","u_exmatrix","u_ratio","u_patternscale_a","u_tex_y_a","u_patternscale_b","u_tex_y_b","u_image","u_sdfgamma","u_mix"]),this.dotShader=t.initializeShader("dot",["a_pos"],["u_matrix","u_size","u_color","u_blur"]),this.sdfShader=t.initializeShader("sdf",["a_pos","a_offset","a_data1","a_data2","a_color","a_buffer","a_gamma"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_skewed","u_extra"]),this.iconShader=t.initializeShader("icon",["a_pos","a_offset","a_data1","a_data2","a_opacity"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_skewed","u_extra"]),this.outlineShader=t.initializeShader("outline",["a_pos","a_color"],["u_matrix","u_world"]),this.patternShader=t.initializeShader("pattern",["a_pos"],["u_matrix","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_mix","u_patternmatrix_a","u_patternmatrix_b","u_opacity","u_image"]),this.fillShader=t.initializeShader("fill",["a_pos","a_color"],["u_matrix"]),this.collisionBoxShader=t.initializeShader("collisionbox",["a_pos","a_extrude","a_data"],["u_matrix","u_scale","u_zoom","u_maxzoom"]),this.identityMatrix=a.create(),this.backgroundBuffer=t.createBuffer(),this.backgroundBuffer.itemSize=2,this.backgroundBuffer.itemCount=4,t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.bufferData(t.ARRAY_BUFFER,new Int16Array([-1,-1,1,-1,-1,1,1,1]),t.STATIC_DRAW),this.setExtent(4096),this.debugTextBuffer=t.createBuffer(),this.debugTextBuffer.itemSize=2},i.prototype.setExtent=function(t){if(t&&t!==this.tileExtent){this.tileExtent=t;var e=this.gl;this.tileExtentBuffer=e.createBuffer(),this.tileExtentBuffer.itemSize=4,this.tileExtentBuffer.itemCount=4,e.bindBuffer(e.ARRAY_BUFFER,this.tileExtentBuffer),e.bufferData(e.ARRAY_BUFFER,new Int16Array([0,0,0,0,this.tileExtent,0,32767,0,0,this.tileExtent,0,32767,this.tileExtent,this.tileExtent,32767,32767]),e.STATIC_DRAW),this.debugBuffer=e.createBuffer(),this.debugBuffer.itemSize=2,this.debugBuffer.itemCount=5,e.bindBuffer(e.ARRAY_BUFFER,this.debugBuffer),e.bufferData(e.ARRAY_BUFFER,new Int16Array([0,0,this.tileExtent-1,0,this.tileExtent-1,this.tileExtent-1,0,this.tileExtent-1,0,0]),e.STATIC_DRAW)}},i.prototype.clearColor=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},i.prototype.clearStencil=function(){var t=this.gl;t.clearStencil(0),t.stencilMask(255),t.clear(t.STENCIL_BUFFER_BIT)},i.prototype.drawClippingMask=function(t){var e=this.gl;e.switchShader(this.fillShader,t.posMatrix),e.colorMask(!1,!1,!1,!1),e.clearStencil(0),e.stencilMask(191),e.clear(e.STENCIL_BUFFER_BIT),e.stencilFunc(e.EQUAL,192,64),e.stencilMask(192),e.stencilOp(e.REPLACE,e.KEEP,e.KEEP),e.disableVertexAttribArray(this.fillShader.a_color),e.bindBuffer(e.ARRAY_BUFFER,this.tileExtentBuffer),e.vertexAttribPointer(this.fillShader.a_pos,this.tileExtentBuffer.itemSize,e.SHORT,!1,8,0),e.drawArrays(e.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),e.stencilFunc(e.EQUAL,128,128),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilMask(0),e.colorMask(!0,!0,!0,!0),e.enableVertexAttribArray(this.fillShader.a_color)},i.prototype.prepareBuffers=function(){},i.prototype.bindDefaultFramebuffer=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)};var u={symbol:t("./draw_symbol"),line:t("./draw_line"),fill:t("./draw_fill"),raster:t("./draw_raster"),background:t("./draw_background"),debug:t("./draw_debug"),vertices:t("./draw_vertices")};i.prototype.render=function(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.spriteAtlas=t.spriteAtlas,this.spriteAtlas.setSprite(t.sprite),this.glyphAtlas=t.glyphAtlas,this.glyphAtlas.bind(this.gl),this.frameHistory.record(this.transform.zoom),this.prepareBuffers(),this.clearColor();for(var r=t._groups.length-1;r>=0;r--){var i=t._groups[r],n=t.sources[i.source];n?(this.clearStencil(),n.render(i,this)):void 0===i.source&&this.drawLayers(i,this.identityMatrix)}},i.prototype.drawTile=function(t,e){this.setExtent(t.tileExtent),this.drawClippingMask(t),this.drawLayers(e,t.posMatrix,t),this.options.debug&&u.debug(this,t)},i.prototype.drawLayers=function(t,e,r){for(var i=t.length-1;i>=0;i--){var n=t[i];n.hidden||(u[n.type](this,n,e,r),this.options.vertices&&u.vertices(this,n,e,r))}},i.prototype.drawStencilBuffer=function(){var t=this.gl;t.switchShader(this.fillShader,this.identityMatrix),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.stencilMask(0),t.stencilFunc(t.EQUAL,128,128),t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.vertexAttribPointer(this.fillShader.a_pos,this.backgroundBuffer.itemSize,t.SHORT,!1,0,0),
t.disableVertexAttribArray(this.fillShader.a_color),t.vertexAttrib4fv(this.fillShader.a_color,[0,0,0,.5]),t.drawArrays(t.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),t.blendFunc(t.ONE_MINUS_DST_ALPHA,t.ONE)},i.prototype.translateMatrix=function(t,e,r,i){if(!r[0]&&!r[1])return t;if("viewport"===i){var n=Math.sin(-this.transform.angle),o=Math.cos(-this.transform.angle);r=[r[0]*o-r[1]*n,r[0]*n+r[1]*o]}var s=this.transform.scale/(1<<e.coord.z)/(e.tileExtent/e.tileSize),u=[r[0]/s,r[1]/s,0],h=new Float32Array(16);return a.translate(h,t,u),h},i.prototype.saveTexture=function(t){var e=this.reusableTextures[t.size];e?e.push(t):this.reusableTextures[t.size]=[t]},i.prototype.getTexture=function(t){var e=this.reusableTextures[t];return e&&e.length>0?e.pop():null}},{"../util/browser":99,"./draw_background":30,"./draw_debug":32,"./draw_fill":33,"./draw_line":34,"./draw_raster":35,"./draw_symbol":36,"./draw_vertices":37,"./frame_history":38,"./gl_util":39,"gl-matrix":119}],42:[function(t,e,r){"use strict";e.exports={debug:{vertex:"precision mediump float;attribute vec2 a_pos;uniform float u_pointsize;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,step(32767.,a_pos.x),1);gl_PointSize=u_pointsize;}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},dot:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform float u_size;attribute vec2 a_pos;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);gl_PointSize=u_size;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur;void main(){float a,b;a=length(gl_PointCoord-.5);b=smoothstep(.5,.5-u_blur,a);gl_FragColor=u_color*b;}"},fill:{vertex:"precision mediump float;uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec4 a_color;varying vec4 a;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);gl_PointSize=2.;a=a_color;}",fragment:"precision mediump float;varying vec4 a;void main(){gl_FragColor=a;}"},gaussian:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_offset;varying vec2 a[3];void main(){gl_Position=u_matrix*vec4(a_pos,0,1);vec2 b=gl_Position.xy/2.+.5;a[0]=b;a[1]=b+u_offset*1.1824255238063563;a[2]=b-u_offset*1.1824255238063563;}",fragment:"precision mediump float;uniform sampler2D u_image;varying vec2 a[3];void main(){vec4 b=vec4(0);b+=texture2D(u_image,a[0])*.40261994689424746;b+=texture2D(u_image,a[1])*.2986900265528763;b+=texture2D(u_image,a[2])*.2986900265528763;gl_FragColor=b;}"},line:{vertex:"precision mediump float;attribute vec2 a_pos,a_linewidth;attribute vec4 a_data,a_color;attribute float a_blur;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform mat2 u_antialiasingmatrix;varying vec2 a,e;varying float b,d,f;varying vec4 c;void main(){vec2 g,h;g=a_data.xy;h=mod(a_pos,2.);h.y=sign(h.y-.5);a=h;vec4 i=vec4(a_linewidth.s*g*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+i.xy/u_ratio,0,1);float j,k,l;j=gl_Position.y/gl_Position.w;k=length(g)/length(u_antialiasingmatrix*g);l=1./(1.-j*u_extra);d=l*k;c=a_color;e=a_linewidth;f=a_blur;}",fragment:"precision mediump float;uniform vec2 u_dasharray;varying vec4 c;varying vec2 a,e;varying float b,d,f;void main(){float g,h,i;g=length(a)*e.s;h=f*d;i=clamp(min(g-(e.t-h),e.s-g)/h,0.,1.);gl_FragColor=c*i;}"},linepattern:{vertex:"precision mediump float;attribute vec2 a_pos,a_linewidth;attribute vec4 a_data;attribute float a_blur,a_opacity;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_ratio;varying vec2 a,c;varying float b,d,e;void main(){vec2 f,h,i,j;f=a_data.xy;float g=a_data.z*128.+a_data.w;h=mod(a_pos,2.);h.y=sign(h.y-.5);a=h;i=f*.015873016;j=a_linewidth.s*i;gl_Position=u_matrix*vec4(floor(a_pos*.5)+j.xy/u_ratio,0,1);b=g;c=a_linewidth;d=a_blur;e=a_opacity;}",fragment:"precision mediump float;uniform float u_point,u_fade;uniform vec2 u_pattern_size_a,u_pattern_size_b,u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform sampler2D u_image;varying vec2 a,c;varying float b,d,e;void main(){float f,g,h,i,j,k;f=length(a)*c.s;g=clamp(min(f-(c.t-d),c.s-f)/d,0.,1.);h=mod(b/u_pattern_size_a.x,1.);i=mod(b/u_pattern_size_b.x,1.);j=.5+a.y*c.s/u_pattern_size_a.y;k=.5+a.y*c.s/u_pattern_size_b.y;vec2 l,m;l=mix(u_pattern_tl_a,u_pattern_br_a,vec2(h,j));m=mix(u_pattern_tl_b,u_pattern_br_b,vec2(i,k));vec4 n=mix(texture2D(u_image,l),texture2D(u_image,m),u_fade);g*=e;gl_FragColor=n*g;}"},linesdfpattern:{vertex:"precision mediump float;attribute vec2 a_pos,a_linewidth;attribute vec4 a_data,a_color;attribute float a_blur;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_ratio,u_tex_y_a,u_tex_y_b;uniform vec2 u_patternscale_a,u_patternscale_b;varying vec2 a,b,c,e;varying vec4 d;varying float f;void main(){vec2 g,i;g=a_data.xy;float h=a_data.z*128.+a_data.w;i=mod(a_pos,2.);i.y=sign(i.y-.5);a=i;vec4 j=vec4(a_linewidth.s*g*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+j.xy/u_ratio,0,1);b=vec2(h*u_patternscale_a.x,i.y*u_patternscale_a.y+u_tex_y_a);c=vec2(h*u_patternscale_b.x,i.y*u_patternscale_b.y+u_tex_y_b);d=a_color;e=a_linewidth;f=a_blur;}",fragment:"precision mediump float;uniform sampler2D u_image;uniform float u_sdfgamma,u_mix;varying vec2 a,b,c,e;varying vec4 d;varying float f;void main(){float g,h,i,j,k;g=length(a)*e.s;h=clamp(min(g-(e.t-f),e.s-g)/f,0.,1.);i=texture2D(u_image,b).a;j=texture2D(u_image,c).a;k=mix(i,j,u_mix);h*=smoothstep(.5-u_sdfgamma,.5+u_sdfgamma,k);gl_FragColor=d*h;}"},outline:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_color;uniform highp mat4 u_matrix;uniform vec2 u_world;varying vec4 a;varying vec2 b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);b=(gl_Position.xy/gl_Position.w+1.)/2.*u_world;a=a_color;}",fragment:"precision mediump float;varying vec4 a;varying vec2 b;void main(){float c,d;c=length(b-gl_FragCoord.xy);d=smoothstep(1.,0.,c);gl_FragColor=a*d;}"},pattern:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform mat3 u_patternmatrix_a,u_patternmatrix_b;attribute vec2 a_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(u_patternmatrix_a*vec3(a_pos,1)).xy;b=(u_patternmatrix_b*vec3(a_pos,1)).xy;}",fragment:"precision mediump float;uniform float u_opacity,u_mix;uniform vec2 u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform sampler2D u_image;varying vec2 a,b;void main(){vec2 c,d,f,g;c=mod(a,1.);d=mix(u_pattern_tl_a,u_pattern_br_a,c);vec4 e,h;e=texture2D(u_image,d);f=mod(b,1.);g=mix(u_pattern_tl_b,u_pattern_br_b,f);h=texture2D(u_image,g);gl_FragColor=mix(e,h,u_mix)*u_opacity;}"},raster:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent,u_buffer_scale;attribute vec2 a_pos,a_texture_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(a_texture_pos/32767.-.5)/u_buffer_scale+.5;b=a*u_scale_parent+u_tl_parent;}",fragment:"precision mediump float;uniform float u_opacity0,u_opacity1,u_brightness_low,u_brightness_high,u_saturation_factor,u_contrast_factor;uniform sampler2D u_image0,u_image1;varying vec2 a,b;uniform vec3 u_spin_weights;void main(){vec4 c,d,e;c=texture2D(u_image0,a);d=texture2D(u_image1,b);e=c*u_opacity0+d*u_opacity1;vec3 f,h,i;f=e.rgb;f=vec3(dot(f,u_spin_weights.xyz),dot(f,u_spin_weights.zxy),dot(f,u_spin_weights.yzx));float g=(e.r+e.g+e.b)/3.;f+=(g-f)*u_saturation_factor;f=(f-.5)*u_contrast_factor+.5;h=vec3(u_brightness_low);i=vec3(u_brightness_high);gl_FragColor=vec4(mix(h,i,f),e.a);}"},icon:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;attribute float a_opacity;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b;void main(){vec2 c,e;c=a_data1.xy;float d,f,g,h,i,j;d=a_data1[2];e=a_data2.st;f=e[0];g=e[1];h=10.;i=2.-step(f,u_zoom)-(1.-step(g,u_zoom));j=clamp((u_fadezoom-d)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<d)b=0.;if(u_minfadezoom>=d)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}a=c/u_texsize;b*=a_opacity;}",fragment:"precision mediump float;uniform sampler2D u_texture;varying vec2 a;varying float b;void main(){gl_FragColor=texture2D(u_texture,a)*b;}"},sdf:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2,a_color;attribute float a_buffer,a_gamma;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b,c,e,f;varying vec4 d;void main(){vec2 g,i;g=a_data1.xy;float h,j,k,l,m,n,o;h=a_data1[2];i=a_data2.st;j=i[0];k=i[1];l=2.-step(j,u_zoom)-(1.-step(k,u_zoom));m=clamp((u_fadezoom-h)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=m;else b=1.-m;if(u_maxfadezoom<h)b=0.;if(u_minfadezoom>=h)b=1.;l+=step(b,0.);if(u_skewed){vec4 n=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+n.xy,0,1);gl_Position.z+=l*gl_Position.w;}else{vec4 n=u_exmatrix*vec4(a_offset/64.,l,0);gl_Position=u_matrix*vec4(a_pos,0,1)+n;}n=gl_Position.y/gl_Position.w;o=1./(1.-n*u_extra);c=o;a=g/u_texsize;d=a_color;e=a_buffer;f=a_gamma;}",fragment:"precision mediump float;uniform sampler2D u_texture;varying vec2 a;varying float b,c,e,f;varying vec4 d;void main(){float g,h,i;g=f*c;h=texture2D(u_texture,a).a;i=smoothstep(e-g,e+g,h)*b;gl_FragColor=d*i;}"},collisionbox:{vertex:"precision mediump float;attribute vec2 a_pos,a_extrude,a_data;uniform mat4 u_matrix;uniform float u_scale;varying float a,b;void main(){gl_Position=u_matrix*vec4(a_pos+a_extrude/u_scale,0,1);a=a_data.x;b=a_data.y;}",fragment:"precision mediump float;uniform float u_zoom,u_maxzoom;varying float a,b;void main(){float c=.5;gl_FragColor=vec4(0,1,0,1)*c;if(b>u_zoom)gl_FragColor=vec4(1,0,0,1)*c;if(u_zoom>=a)gl_FragColor=vec4(0,0,0,1)*c*.25;if(b>=u_maxzoom)gl_FragColor=vec4(0,0,1,1)*c*.2;}"}}},{}],43:[function(t,e,r){"use strict";function i(t){t=t||{},this._data=t.data,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),this.geojsonVtOptions={maxZoom:this.maxzoom},void 0!==t.buffer&&(this.geojsonVtOptions.buffer=t.buffer),void 0!==t.tolerance&&(this.geojsonVtOptions.tolerance=t.tolerance),this._pyramid=new a({tileSize:512,minzoom:this.minzoom,maxzoom:this.maxzoom,cacheSize:20,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this)})}var n=t("../util/util"),o=t("../util/evented"),a=t("./tile_pyramid"),s=t("./source"),u=t("resolve-url");e.exports=i,i.prototype=n.inherit(o,{minzoom:0,maxzoom:14,_dirty:!0,setData:function(t){return this._data=t,this._dirty=!0,this.fire("change"),this.map&&this.update(this.map.transform),this},onAdd:function(t){this.map=t},loaded:function(){return this._loaded&&this._pyramid.loaded()},update:function(t){this._dirty&&this._updateData(),this._loaded&&this._pyramid.update(this.used,t)},reload:function(){this._loaded&&this._pyramid.reload()},render:s._renderTiles,featuresAt:s._vectorFeaturesAt,_updateData:function(){this._dirty=!1;var t=this._data;"string"==typeof t&&(t=u(window.location.href,t)),this.workerID=this.dispatcher.send("parse geojson",{data:t,tileSize:512,source:this.id,geojsonVtOptions:this.geojsonVtOptions},function(t){return t?void this.fire("error",{error:t}):(this._loaded=!0,this._pyramid.reload(),void this.fire("change"))}.bind(this))},_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,r={uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:512,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};t.workerID=this.dispatcher.send("load geojson tile",r,function(e,r){if(t.unloadVectorData(this.map.painter),!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(r),this.fire("tile.load",{tile:t})}}.bind(this),this.workerID)},_abortTile:function(t){t.aborted=!0},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(t.uid),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)}})},{"../util/evented":104,"../util/util":110,"./source":46,"./tile_pyramid":49,"resolve-url":139}],44:[function(t,e,r){"use strict";function i(t){this.features=t,this.length=t.length}function n(t){this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=4096}var o=t("point-geometry"),a=t("vector-tile").VectorTileFeature;e.exports=i,i.prototype.feature=function(t){return new n(this.features[t])},n.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],i=[],n=0;n<r.length;n++)i.push(new o(r[n][0],r[n][1]));this.geometry.push(i)}return this.geometry},n.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-(1/0),i=1/0,n=-(1/0),o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),r=Math.max(r,u.x),i=Math.min(i,u.y),n=Math.max(n,u.y)}return[e,i,r,n]},n.prototype.toGeoJSON=a.prototype.toGeoJSON},{"point-geometry":137,"vector-tile":141}],45:[function(t,e,r){"use strict";function i(t){n.extend(this,n.pick(t,["url","tileSize"])),s._loadTileJSON.call(this,t)}var n=t("../util/util"),o=t("../util/ajax"),a=t("../util/evented"),s=t("./source"),u=t("../util/mapbox").normalizeTileURL;e.exports=i,i.prototype=n.inherit(a,{minzoom:0,maxzoom:22,roundZoom:!0,tileSize:512,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t,this.map.style.rasterFadeDuration)},reload:function(){},render:s._renderTiles,_loadTile:function(t){o.getImage(u(t.coord.url(this.tiles),this.url),function(e,r){if(!t.aborted){if(e)return void this.fire("tile.error",{tile:t});var i=this.map.painter.gl;t.texture=this.map.painter.getTexture(r.width),t.texture?(i.bindTexture(i.TEXTURE_2D,t.texture),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,r)):(t.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,t.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),t.texture.size=r.width),i.generateMipmap(i.TEXTURE_2D),t.timeAdded=(new Date).getTime(),this.map.animationLoop.set(this.style.rasterFadeDuration),t.source=this,t.loaded=!0,this.fire("tile.load",{tile:t})}}.bind(this))},_abortTile:function(t){t.aborted=!0},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.texture&&this.map.painter.saveTexture(t.texture)},featuresAt:function(t,e,r){r(null,[])}})},{"../util/ajax":98,"../util/evented":104,"../util/mapbox":107,"../util/util":110,"./source":46}],46:[function(t,e,r){"use strict";var i=t("../util/util"),n=t("../util/ajax"),o=t("../util/browser"),a=t("./tile_pyramid"),s=t("./tile_coord"),u=t("../util/mapbox").normalizeSourceURL;r._loadTileJSON=function(t){var e=function(t,e){return t?void this.fire("error",{error:t}):(i.extend(this,i.pick(e,["tiles","minzoom","maxzoom","attribution"])),this._pyramid=new a({tileSize:this.tileSize,cacheSize:20,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom,reparseOverscaled:this.reparseOverscaled,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this),redoPlacement:this._redoTilePlacement?this._redoTilePlacement.bind(this):void 0}),void this.fire("load"))}.bind(this);t.url?n.getJSON(u(t.url),e):o.frame(e.bind(this,null,t))},r._renderTiles=function(t,e){if(this._pyramid)for(var r=this._pyramid.renderedIDs(),i=0;i<r.length;i++){var n=this._pyramid.getTile(r[i]),o=s.fromID(r[i]),a=o.z,u=o.x,h=o.y,l=o.w;a=Math.min(a,this.maxzoom),u+=l*(1<<a),n.calculateMatrices(a,u,h,e.transform,e),e.drawTile(n,t)}},r._vectorFeaturesAt=function(t,e,r){if(!this._pyramid)return r(null,[]);var i=this._pyramid.tileAt(t);return i?void this.dispatcher.send("query features",{uid:i.tile.uid,x:i.x,y:i.y,scale:i.scale,source:this.id,params:e},r,i.tile.workerID):r(null,[])},r.create=function(e){var r={vector:t("./vector_tile_source"),raster:t("./raster_tile_source"),geojson:t("./geojson_source"),video:t("./video_source")};for(var i in r)if(e instanceof r[i])return e;return new r[e.type](e)}},{"../util/ajax":98,"../util/browser":99,"../util/mapbox":107,"../util/util":110,"./geojson_source":43,"./raster_tile_source":45,"./tile_coord":48,"./tile_pyramid":49,"./vector_tile_source":50,"./video_source":51}],47:[function(t,e,r){"use strict";function i(t,e){this.coord=t,this.uid=s.uniqueId(),this.loaded=!1,this.uses=0,this.tileSize=e}var n=t("gl-matrix"),o=n.mat2,a=n.mat4,s=t("../util/util"),u=t("../data/buffer/buffer_set");e.exports=i,i.prototype={tileExtent:4096,calculateMatrices:function(t,e,r,i){var n=Math.pow(2,t),s=i.worldSize/n;this.scale=s,this.posMatrix=new Float64Array(16),a.identity(this.posMatrix),a.translate(this.posMatrix,this.posMatrix,[e*s,r*s,0]),a.scale(this.posMatrix,this.posMatrix,[s/this.tileExtent,s/this.tileExtent,1]),a.multiply(this.posMatrix,i.getProjMatrix(),this.posMatrix),this.exMatrix=a.create(),a.ortho(this.exMatrix,0,i.width,i.height,0,0,-1),this.rotationMatrix=o.create(),o.rotate(this.rotationMatrix,this.rotationMatrix,i.angle),this.posMatrix=new Float32Array(this.posMatrix)},positionAt:function(t,e){return t=t.zoomTo(Math.min(this.coord.z,e)),{x:4096*(t.column-this.coord.x),y:4096*(t.row-this.coord.y),scale:this.scale}},loadVectorData:function(t){this.loaded=!0,t&&(this.buffers=new u(t.buffers),this.elementGroups=t.elementGroups,this.tileExtent=t.extent)},reloadSymbolData:function(t,e){if(this.buffers){this.buffers.glyphVertex.destroy(e.gl),this.buffers.glyphElement.destroy(e.gl),this.buffers.iconVertex.destroy(e.gl),this.buffers.iconElement.destroy(e.gl),this.buffers.collisionBoxVertex.destroy(e.gl);var r=new u(t.buffers);this.buffers.glyphVertex=r.glyphVertex,this.buffers.glyphElement=r.glyphElement,this.buffers.iconVertex=r.iconVertex,this.buffers.iconElement=r.iconElement,this.buffers.collisionBoxVertex=r.collisionBoxVertex;for(var i in t.elementGroups)this.elementGroups[i]=t.elementGroups[i]}},unloadVectorData:function(t){for(var e in this.buffers)this.buffers[e].destroy(t.gl);this.buffers=null}}},{"../data/buffer/buffer_set":9,"../util/util":110,"gl-matrix":119}],48:[function(t,e,r){"use strict";function i(t,e,r,i){void 0===i&&(i=0),this.z=t,this.x=e,this.y=r,this.w=i,i*=2,0>i&&(i=-1*i-1);var n=1<<this.z;this.id=32*(n*n*i+n*this.y+this.x)+this.z}function n(t,e){if(t.row>e.row){var r=t;t=e,e=r}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function o(t,e,r,i,n){var o=Math.max(r,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,h=e.dx/e.dy,l=t.dx>0,c=e.dx<0,f=o;a>f;f++){var d=u*Math.max(0,Math.min(t.dy,f+l-t.y0))+t.x0,p=h*Math.max(0,Math.min(e.dy,f+c-e.y0))+e.x0;n(Math.floor(p),Math.ceil(d),f)}}function a(t,e,r,i,a,s){var u,h=n(t,e),l=n(e,r),c=n(r,t);h.dy>l.dy&&(u=h,h=l,l=u),h.dy>c.dy&&(u=h,h=c,c=u),l.dy>c.dy&&(u=l,l=c,c=u),h.dy&&o(c,h,i,a,s),l.dy&&o(c,l,i,a,s)}e.exports=i,i.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},i.fromID=function(t){var e=t%32,r=1<<e,n=(t-e)/32,o=n%r,a=(n-o)/r%r,s=Math.floor(n/(r*r));return s%2!==0&&(s=-1*s-1),s/=2,new i(e,o,a,s)},i.prototype.url=function(t,e){return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,e||this.z)).replace("{x}",this.x).replace("{y}",this.y)},i.prototype.parent=function(t){return 0===this.z?null:this.z>t?new i(this.z-1,this.x,this.y,this.w):new i(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},i.prototype.wrapped=function(){return new i(this.z,this.x,this.y,0)},i.prototype.children=function(t){if(this.z>=t)return[new i(this.z+1,this.x,this.y,this.w)];var e=this.z+1,r=2*this.x,n=2*this.y;return[new i(e,r,n,this.w),new i(e,r+1,n,this.w),new i(e,r,n+1,this.w),new i(e,r+1,n+1,this.w)]},i.cover=function(t,e,r){function n(t,e,n){var a,u;if(n>=0&&o>=n)for(a=t;e>a;a++){u=(a+o)%o;var h=new i(r,u,n,Math.floor(a/o));s[h.id]=h}}var o=1<<t,s={};return a(e[0],e[1],e[2],0,o,n),a(e[2],e[3],e[0],0,o,n),Object.keys(s).map(function(t){return s[t]})}},{}],49:[function(t,e,r){"use strict";function i(t){this.tileSize=t.tileSize,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.roundZoom=t.roundZoom,this.reparseOverscaled=t.reparseOverscaled,this._load=t.load,this._abort=t.abort,this._unload=t.unload,this._add=t.add,this._remove=t.remove,this._redoPlacement=t.redoPlacement,this._tiles={},this._cache=new s(t.cacheSize,function(t){return this._unload(t)}.bind(this))}var n=t("./tile"),o=t("./tile_coord"),a=t("point-geometry"),s=t("../util/mru_cache"),u=t("../util/util");e.exports=i,i.prototype={loaded:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0},orderedIDs:function(){return Object.keys(this._tiles).sort(function(t,e){return e%32-t%32}).map(function(t){return+t})},renderedIDs:function(){return this.orderedIDs().filter(function(t){return this._tiles[t].loaded&&!this._coveredTiles[t]}.bind(this))},reload:function(){this._cache.reset();for(var t in this._tiles)this._load(this._tiles[t])},getTile:function(t){return this._tiles[t]},getZoom:function(t){return t.zoom+Math.log(t.tileSize/this.tileSize)/Math.LN2},coveringZoomLevel:function(t){return(this.roundZoom?Math.round:Math.floor)(this.getZoom(t))},coveringTiles:function(t){var e=this.coveringZoomLevel(t),r=e;if(e<this.minzoom)return[];e>this.maxzoom&&(e=this.maxzoom);var i=t,n=i.locationCoordinate(i.center)._zoomTo(e),s=new a(n.column-.5,n.row-.5);return o.cover(e,[i.pointCoordinate(new a(0,0))._zoomTo(e),i.pointCoordinate(new a(i.width,0))._zoomTo(e),i.pointCoordinate(new a(i.width,i.height))._zoomTo(e),i.pointCoordinate(new a(0,i.height))._zoomTo(e)],this.reparseOverscaled?r:e).sort(function(t,e){return s.dist(t)-s.dist(e)})},findLoadedChildren:function(t,e,r){for(var i=!0,n=t.z,o=t.children(this.maxzoom),a=0;a<o.length;a++){var s=o[a].id;this._tiles[s]&&this._tiles[s].loaded?r[s]=!0:(i=!1,e>n&&this.findLoadedChildren(o[a],e,r))}return i},findLoadedParent:function(t,e,r){for(var i=t.z-1;i>=e;i--){t=t.parent(this.maxzoom);var n=this._tiles[t.id];if(n&&n.loaded)return r[t.id]=!0,n}},update:function(t,e,r){var i,n,a,s=(this.roundZoom?Math.round:Math.floor)(this.getZoom(e)),h=u.clamp(s-10,this.minzoom,this.maxzoom),l=u.clamp(s+1,this.minzoom,this.maxzoom),c={},f=(new Date).getTime();this._coveredTiles={};var d=t?this.coveringTiles(e):[];for(i=0;i<d.length;i++)n=d[i],a=this.addTile(n),c[n.id]=!0,a.loaded||this.findLoadedChildren(n,l,c)||this.findLoadedParent(n,h,c);for(var p in c)n=o.fromID(p),a=this._tiles[p],a&&a.timeAdded>f-(r||0)&&(this.findLoadedChildren(n,l,c)?(this._coveredTiles[p]=!0,c[p]=!0):this.findLoadedParent(n,h,c));var m=u.keysDifference(this._tiles,c);for(i=0;i<m.length;i++)this.removeTile(+m[i])},addTile:function(t){var e=this._tiles[t.id];if(e)return e;var r=t.wrapped();if(e=this._tiles[r.id],e||(e=this._cache.get(r.id),e&&this._redoPlacement&&this._redoPlacement(e)),!e){var i=t.z,o=i>this.maxzoom?Math.pow(2,i-this.maxzoom):1;e=new n(r,this.tileSize*o),this._load(e)}return e.uses++,this._tiles[t.id]=e,this._add(e,t),e},removeTile:function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._remove(e),e.uses>0||(e.loaded?this._cache.add(e.coord.wrapped().id,e):(this._abort(e),this._unload(e))))},clearTiles:function(){for(var t in this._tiles)this.removeTile(t);this._cache.reset()},tileAt:function(t){for(var e=this.orderedIDs(),r=0;r<e.length;r++){var i=this._tiles[e[r]],n=i.positionAt(t,this.maxzoom);if(n&&n.x>=0&&n.x<4096&&n.y>=0&&n.y<4096)return{tile:i,x:n.x,y:n.y,scale:n.scale}}}}},{"../util/mru_cache":108,"../util/util":110,"./tile":47,"./tile_coord":48,"point-geometry":137}],50:[function(t,e,r){"use strict";function i(t){if(n.extend(this,n.pick(t,["url","tileSize"])),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");a._loadTileJSON.call(this,t)}var n=t("../util/util"),o=t("../util/evented"),a=t("./source");e.exports=i,i.prototype=n.inherit(o,{minzoom:0,maxzoom:22,tileSize:512,reparseOverscaled:!0,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t)},reload:function(){this._pyramid&&this._pyramid.reload()},redoPlacement:function(){if(this._pyramid)for(var t=this._pyramid.orderedIDs(),e=0;e<t.length;e++){var r=this._pyramid.getTile(t[e]);this._redoTilePlacement(r)}},render:a._renderTiles,featuresAt:a._vectorFeaturesAt,_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,r={url:t.coord.url(this.tiles,this.maxzoom),uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize*e,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};t.workerID?this.dispatcher.send("reload tile",r,this._tileLoaded.bind(this,t),t.workerID):t.workerID=this.dispatcher.send("load tile",r,this._tileLoaded.bind(this,t))},_tileLoaded:function(t,e,r){if(!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(r),t.redoWhenDone&&(t.redoWhenDone=!1,this._redoTilePlacement(t)),this.fire("tile.load",{tile:t})}},_abortTile:function(t){t.aborted=!0,this.dispatcher.send("abort tile",{uid:t.uid,source:this.id},null,t.workerID)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(t.uid),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)},_redoTilePlacement:function(t){function e(e,r){t.reloadSymbolData(r,this.map.painter),this.fire("tile.load",{tile:t}),t.redoingPlacement=!1,t.redoWhenDone&&(this._redoTilePlacement(t),t.redoWhenDone=!1)}return!t.loaded||t.redoingPlacement?void(t.redoWhenDone=!0):(t.redoingPlacement=!0,void this.dispatcher.send("redo placement",{uid:t.uid,source:this.id,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug},e.bind(this),t.workerID))}})},{"../util/evented":104,"../util/util":110,"./source":46}],51:[function(t,e,r){"use strict";function i(t){this.coordinates=t.coordinates,l.getVideo(t.url,function(t,e){if(!t){this.video=e,this.video.loop=!0;var r;this.video.addEventListener("playing",function(){r=this.map.style.animationLoop.set(1/0),this.map._rerender()}.bind(this)),this.video.addEventListener("pause",function(){this.map.style.animationLoop.cancel(r)}.bind(this)),this._loaded=!0,this.map&&(this.video.play(),this.createTile(),this.fire("change"))}}.bind(this))}var n=t("../util/util"),o=t("./tile"),a=t("../geo/lat_lng"),s=t("point-geometry"),u=t("../util/evented"),h=t("../geo/coordinate"),l=t("../util/ajax");e.exports=i,i.prototype=n.inherit(u,{roundZoom:!0,getVideo:function(){return this.video},onAdd:function(t){this.map=t,this.video&&(this.video.play(),this.createTile())},createTile:function(){for(var t=this.map,e=this.coordinates.map(function(e){var r=a.convert(e);return t.transform.locationCoordinate(r).zoomTo(0)}),r=1/0,i=1/0,n=-(1/0),u=-(1/0),l=0;l<e.length;l++)r=Math.min(r,e[l].column),i=Math.min(i,e[l].row),n=Math.max(n,e[l].column),u=Math.max(u,e[l].row);var c=n-r,f=u-i,d=Math.max(c,f),p=new h((r+n)/2,(i+u)/2,0).zoomTo(Math.floor(-Math.log(d)/Math.LN2)),m=4096,v=e.map(function(t){var e=t.zoomTo(p.zoom);return new s(Math.round((e.column-p.column)*m),Math.round((e.row-p.row)*m))}),_=t.painter.gl,g=32767,y=new Int16Array([v[0].x,v[0].y,0,0,v[1].x,v[1].y,g,0,v[3].x,v[3].y,0,g,v[2].x,v[2].y,g,g]);this.tile=new o,this.tile.buckets={},this.tile.boundsBuffer=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,this.tile.boundsBuffer),_.bufferData(_.ARRAY_BUFFER,y,_.STATIC_DRAW),this.center=p},loaded:function(){return this.video&&this.video.readyState>=2},update:function(){},reload:function(){},render:function(t,e){if(this._loaded&&!(this.video.readyState<2)){var r=this.center;this.tile.calculateMatrices(r.zoom,r.column,r.row,this.map.transform,e);var i=e.gl;this.tile.texture?(i.bindTexture(i.TEXTURE_2D,this.tile.texture),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.tile.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.tile.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this.video)),e.drawLayers(t,this.tile.posMatrix,this.tile)}},featuresAt:function(t,e,r){return r(null,[])}})},{"../geo/coordinate":24,"../geo/lat_lng":25,"../util/ajax":98,"../util/evented":104,"../util/util":110,"./tile":47,"point-geometry":137}],52:[function(t,e,r){"use strict";function i(t){this.self=t,this.actor=new n(t,this),this.loading={},this.loaded={},this.layers=[],this.geoJSONIndexes={}}var n=t("../util/actor"),o=t("./worker_tile"),a=t("../util/util"),s=t("../util/ajax"),u=t("vector-tile"),h=t("pbf"),l=t("geojson-vt"),c=t("./geojson_wrapper");e.exports=function(t){return new i(t)},a.extend(i.prototype,{"set layers":function(t){this.layers=t},"load tile":function(t,e){function r(t,r){return delete this.loading[i][n],t?e(t):(a.data=new u.VectorTile(new h(new Uint8Array(r))),a.parse(a.data,this.layers,this.actor,e),this.loaded[i]=this.loaded[i]||{},void(this.loaded[i][n]=a))}var i=t.source,n=t.uid;this.loading[i]||(this.loading[i]={});var a=this.loading[i][n]=new o(t);a.xhr=s.getArrayBuffer(t.url,r.bind(this))},"reload tile":function(t,e){var r=this.loaded[t.source],i=t.uid;if(r&&r[i]){var n=r[i];n.parse(n.data,this.layers,this.actor,e)}},"abort tile":function(t){var e=this.loading[t.source],r=t.uid;e&&e[r]&&(e[r].xhr.abort(),delete e[r])},"remove tile":function(t){var e=this.loaded[t.source],r=t.uid;e&&e[r]&&delete e[r]},"redo placement":function(t,e){var r=this.loaded[t.source],i=this.loading[t.source],n=t.uid;if(r&&r[n]){var o=r[n],a=o.redoPlacement(t.angle,t.pitch,t.collisionDebug);a.result&&e(null,a.result,a.transferables)}else i&&i[n]&&(i[n].angle=t.angle)},"parse geojson":function(t,e){var r=function(r,i){return r?e(r):(this.geoJSONIndexes[t.source]=l(i,t.geojsonVtOptions),void e(null))}.bind(this);"string"==typeof t.data?s.getJSON(t.data,r):r(null,t.data)},"load geojson tile":function(t,e){var r=t.source,i=t.coord,n=this.geoJSONIndexes[r].getTile(i.z,i.x,i.y);if(!n)return e(null,null);var a=new o(t);a.parse(new c(n.features),this.layers,this.actor,e),this.loaded[r]=this.loaded[r]||{},this.loaded[r][t.uid]=a},"query features":function(t,e){var r=this.loaded[t.source]&&this.loaded[t.source][t.uid];r?r.featureTree.query(t,e):e(null,[])}})},{"../util/actor":97,"../util/ajax":98,"../util/util":110,"./geojson_wrapper":44,"./worker_tile":53,"geojson-vt":115,pbf:135,"vector-tile":141}],53:[function(t,e,r){"use strict";function i(t){
this.coord=t.coord,this.uid=t.uid,this.zoom=t.zoom,this.maxZoom=t.maxZoom,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=t.overscaling,this.angle=t.angle,this.pitch=t.pitch,this.collisionDebug=t.collisionDebug,this.stacks={}}var n=t("../data/feature_tree"),o=t("../symbol/collision_tile"),a=t("../data/buffer/buffer_set"),s=t("../data/create_bucket");e.exports=i,i.prototype.parse=function(t,e,r,i){function u(t,e){for(var r=0;r<t.length;r++){var i=t.feature(r);for(var n in e){var o=e[n];o.filter(i)&&o.features.push(i)}}}function h(t){return function(e){t.dependenciesLoaded=!0,l(v,t,e)}}function l(t,e,r){if((!e.getDependencies||e.dependenciesLoaded)&&(!e.needsPlacement||e.previousPlaced)){if(!r){var i=Date.now();e.features.length&&e.addFeatures(g);var n=Date.now()-i;if(e.interactive)for(var o=0;o<e.features.length;o++){var a=e.features[o];t.featureTree.insert(a.bbox(),e.layers,a)}"undefined"!=typeof self&&(self.bucketStats=self.bucketStats||{_total:0},self.bucketStats._total+=n,self.bucketStats[e.id]=(self.bucketStats[e.id]||0)+n)}return A--,A?void(e.next&&(e.next.previousPlaced=!0,l(t,e.next))):void c()}}function c(){if(v.status="done",v.redoPlacementAfterDone){var t=v.redoPlacement(v.angle,v.pitch).result;_.glyphVertex=t.buffers.glyphVertex,_.iconVertex=t.buffers.iconVertex,_.collisionBoxVertex=t.buffers.collisionBoxVertex}var e=[],r={};for(d in _)e.push(_[d].array);for(d in y)r[d]=y[d].elementGroups;i(null,{elementGroups:r,buffers:_,extent:T},e)}this.status="parsing",this.featureTree=new n(this.coord,this.overscaling);var f,d,p,m,v=this,_=new a,g=new o(this.angle,this.pitch),y={},x=this.bucketsInOrder=[],b={};for(f=0;f<e.length;f++)if(p=e[f],p.source===this.source&&!p.ref){var w=p.minzoom;if(!(w&&this.zoom<w&&w<this.maxZoom)){var S=p.maxzoom;if(!(S&&this.zoom>=S)){var M=p.layout.visibility;if("none"!==M)if(m=s(p,_,this.zoom,this.overscaling,this.collisionDebug),m.layers=[p.id],y[m.id]=m,x.push(m),t.layers){var E=p["source-layer"];b[E]||(b[E]={}),b[E][m.id]=m}else b[m.id]=m}}}for(f=0;f<e.length;f++)p=e[f],p.source===this.source&&p.ref&&(m=y[p.ref],m&&m.layers.push(p.id));var T=4096;if(t.layers)for(d in b)p=t.layers[d],p&&(p.extent&&(T=p.extent),u(p,b[d]));else u(t,b);var z,A=x.length;for(f=0;f<x.length;f++)m=x[f],m.needsPlacement&&(z?z.next=m:m.previousPlaced=!0,z=m),m.getDependencies&&m.getDependencies(this,r,h(m)),m.needsPlacement||m.getDependencies||l(v,m)},i.prototype.redoPlacement=function(t,e,r){if("done"!==this.status)return this.redoPlacementAfterDone=!0,this.angle=t,{};for(var i=new a,n=[],s={},u=new o(t,e),h=this.bucketsInOrder,l=0;l<h.length;l++){var c=h[l];"symbol"===c.type&&(c.placeFeatures(u,i,r),s[c.id]=c.elementGroups)}for(var f in i)n.push(i[f].array);return{result:{elementGroups:s,buffers:i},transferables:n}}},{"../data/buffer/buffer_set":9,"../data/create_bucket":18,"../data/feature_tree":20,"../symbol/collision_tile":72}],54:[function(t,e,r){"use strict";function i(){this.n=0,this.times=[]}e.exports=i,i.prototype.stopped=function(){return this.times=this.times.filter(function(t){return t.time>=(new Date).getTime()}),!this.times.length},i.prototype.set=function(t){return this.times.push({id:this.n,time:t+(new Date).getTime()}),this.n++},i.prototype.cancel=function(t){this.times=this.times.filter(function(e){return e.id!==t})}},{}],55:[function(t,e,r){"use strict";function i(t){this.base=t,this.retina=s.devicePixelRatio>1,t=this.base+(this.retina?"@2x":""),a.getJSON(t+".json",function(t,e){return t?void this.fire("error",{error:t}):(this.data=e,void(this.img&&this.fire("load")))}.bind(this)),a.getImage(t+".png",function(t,e){if(t)return void this.fire("error",{error:t});for(var r=e.getData(),i=e.data=new Uint8Array(r.length),n=0;n<r.length;n+=4){var o=r[n+3]/255;i[n+0]=r[n+0]*o,i[n+1]=r[n+1]*o,i[n+2]=r[n+2]*o,i[n+3]=r[n+3]}this.img=e,this.data&&this.fire("load")}.bind(this))}function n(){}var o=t("../util/evented"),a=t("../util/ajax"),s=t("../util/browser");e.exports=i,i.prototype=Object.create(o),i.prototype.toJSON=function(){return this.base},i.prototype.loaded=function(){return!(!this.data||!this.img)},i.prototype.resize=function(){if(s.devicePixelRatio>1!==this.retina){var t=new i(this.base);t.on("load",function(){this.img=t.img,this.data=t.data,this.retina=t.retina}.bind(this))}},n.prototype={x:0,y:0,width:0,height:0,pixelRatio:1,sdf:!1},i.prototype.getSpritePosition=function(t){if(!this.loaded())return new n;var e=this.data&&this.data[t];return e&&this.img?e:new n}},{"../util/ajax":98,"../util/browser":99,"../util/evented":104}],56:[function(t,e,r){"use strict";var i=t("./reference");e.exports={},i.layout.forEach(function(t){var r=function(t){for(var e in t)this[e]=t[e]},n=i[t];for(var o in n)void 0!==n[o]["default"]&&(r.prototype[o]=n[o]["default"]);e.exports[t.replace("layout_","")]=r})},{"./reference":58}],57:[function(t,e,r){"use strict";var i=t("./reference"),n=t("csscolorparser").parseCSSColor;e.exports={},i.paint.forEach(function(t){var r=function(){},o=i[t];for(var a in o){var s=o[a],u=s["default"];void 0!==u&&("color"===s.type&&(u=n(u)),r.prototype[a]=u)}r.prototype.hidden=!1,e.exports[t.replace("paint_","")]=r})},{"./reference":58,csscolorparser:111}],58:[function(t,e,r){e.exports=t("mapbox-gl-style-spec/reference/latest")},{"mapbox-gl-style-spec/reference/latest":132}],59:[function(t,e,r){"use strict";function i(t,e){this.animationLoop=e||new _,this.dispatcher=new v(Math.max(m.hardwareConcurrency-1,1),this),this.glyphAtlas=new h(1024,1024),this.spriteAtlas=new l(512,512),this.spriteAtlas.resize(m.devicePixelRatio),this.lineAtlas=new c(256,512),this._layers={},this._order=[],this._groups=[],this.sources={},this.zoomHistory={},f.bindAll(["_forwardSourceEvent","_forwardTileEvent","_redoPlacement"],this);var r=function(t,e){if(t)return void this.fire("error",{error:t});var r=g(e);r.length&&r.forEach(function(t){throw new Error(t.message)}),this._loaded=!0,this.stylesheet=e;var i=e.sources;for(var n in i)this.addSource(n,i[n]);e.sprite&&(this.sprite=new s(e.sprite),this.sprite.on("load",this.fire.bind(this,"change"))),this.glyphSource=new u(e.glyphs,this.glyphAtlas),this._resolve(),this.fire("load")}.bind(this);"string"==typeof t?d.getJSON(p(t),r):m.frame(r.bind(this,null,t))}var n=t("../util/evented"),o=t("./style_batch"),a=t("./style_layer"),s=t("./image_sprite"),u=t("../symbol/glyph_source"),h=t("../symbol/glyph_atlas"),l=t("../symbol/sprite_atlas"),c=t("../render/line_atlas"),f=t("../util/util"),d=t("../util/ajax"),p=t("../util/mapbox").normalizeStyleURL,m=t("../util/browser"),v=t("../util/dispatcher"),_=t("./animation_loop"),g=t("mapbox-gl-style-spec/lib/validate/latest");e.exports=i,i.prototype=f.inherit(n,{_loaded:!1,loaded:function(){if(!this._loaded)return!1;for(var t in this.sources)if(!this.sources[t].loaded())return!1;return this.sprite&&!this.sprite.loaded()?!1:!0},_resolve:function(){var t,e;this._layers={},this._order=[];for(var r=0;r<this.stylesheet.layers.length;r++)e=new a(this.stylesheet.layers[r],this.stylesheet.constants||{}),this._layers[e.id]=e,this._order.push(e.id);for(t in this._layers)this._layers[t].resolveLayout();for(t in this._layers)this._layers[t].resolveReference(this._layers),this._layers[t].resolvePaint();this._groupLayers(),this._broadcastLayers()},_groupLayers:function(){var t;this._groups=[];for(var e=0;e<this._order.length;++e){var r=this._layers[this._order[e]];t&&r.source===t.source||(t=[],t.source=r.source,this._groups.push(t)),t.push(r)}},_broadcastLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e].json());this.dispatcher.broadcast("set layers",t)},_cascade:function(t,e){if(this._loaded){e=e||{transition:!0};for(var r in this._layers)this._layers[r].cascade(t,e,this.stylesheet.transition||{},this.animationLoop);this.fire("change")}},_recalculate:function(t){for(var e in this.sources)this.sources[e].used=!1;this._updateZoomHistory(t),this.rasterFadeDuration=300;for(e in this._layers){var r=this._layers[e];r.recalculate(t,this.zoomHistory)&&r.source&&(this.sources[r.source].used=!0)}var i=300;Math.floor(this.z)!==Math.floor(t)&&this.animationLoop.set(i),this.z=t,this.fire("zoom")},_updateZoomHistory:function(t){var e=this.zoomHistory;void 0===e.lastIntegerZoom&&(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=0,e.lastZoom=t),Math.floor(e.lastZoom)<Math.floor(t)?(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=Date.now()):Math.floor(e.lastZoom)>Math.floor(t)&&(e.lastIntegerZoom=Math.floor(t+1),e.lastIntegerZoomTime=Date.now()),e.lastZoom=t},batch:function(t){o(this,t)},addSource:function(t,e){return this.batch(function(r){r.addSource(t,e)}),this},removeSource:function(t){return this.batch(function(e){e.removeSource(t)}),this},getSource:function(t){return this.sources[t]},addLayer:function(t,e){return this.batch(function(r){r.addLayer(t,e)}),this},removeLayer:function(t){return this.batch(function(e){e.removeLayer(t)}),this},getLayer:function(t){return this._layers[t]},getReferentLayer:function(t){var e=this.getLayer(t);return e.ref&&(e=this.getLayer(e.ref)),e},setFilter:function(t,e){return this.batch(function(r){r.setFilter(t,e)}),this},setLayerZoomRange:function(t,e,r){return this.batch(function(i){i.setLayerZoomRange(t,e,r)}),this},getFilter:function(t){return this.getReferentLayer(t).filter},setLayoutProperty:function(t,e,r){return this.batch(function(i){i.setLayoutProperty(t,e,r)}),this},getLayoutProperty:function(t,e){return this.getReferentLayer(t).getLayoutProperty(e)},setPaintProperty:function(t,e,r,i){return this.batch(function(n){n.setPaintProperty(t,e,r,i)}),this},getPaintProperty:function(t,e,r){return this.getLayer(t).getPaintProperty(e,r)},featuresAt:function(t,e,r){var i=[],n=null;e.layer&&(e.layer={id:e.layer}),f.asyncEach(Object.keys(this.sources),function(r,o){var a=this.sources[r];a.featuresAt(t,e,function(t,e){e&&(i=i.concat(e)),t&&(n=t),o()})}.bind(this),function(){return n?r(n):void r(null,i.filter(function(t){return void 0!==this._layers[t.layer]}.bind(this)).map(function(t){return t.layer=this._layers[t.layer].json(),t}.bind(this)))}.bind(this))},_remove:function(){this.dispatcher.remove()},_reloadSource:function(t){this.sources[t].reload()},_updateSources:function(t){for(var e in this.sources)this.sources[e].update(t)},_redoPlacement:function(){for(var t in this.sources)this.sources[t].redoPlacement&&this.sources[t].redoPlacement()},_forwardSourceEvent:function(t){this.fire("source."+t.type,f.extend({source:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,f.extend({source:t.target},t))},"get sprite json":function(t,e){var r=this.sprite;r.loaded()?e(null,{sprite:r.data,retina:r.retina}):r.on("load",function(){e(null,{sprite:r.data,retina:r.retina})})},"get icons":function(t,e){var r=this.sprite,i=this.spriteAtlas;r.loaded()?(i.setSprite(r),i.addIcons(t.icons,e)):r.on("load",function(){i.setSprite(r),i.addIcons(t.icons,e)})},"get glyphs":function(t,e){this.glyphSource.getSimpleGlyphs(t.fontstack,t.codepoints,t.uid,e)}})},{"../render/line_atlas":40,"../symbol/glyph_atlas":74,"../symbol/glyph_source":75,"../symbol/sprite_atlas":81,"../util/ajax":98,"../util/browser":99,"../util/dispatcher":101,"../util/evented":104,"../util/mapbox":107,"../util/util":110,"./animation_loop":54,"./image_sprite":55,"./style_batch":60,"./style_layer":64,"mapbox-gl-style-spec/lib/validate/latest":130}],60:[function(t,e,r){"use strict";function i(t,e){if(!t._loaded)throw new Error("Style is not done loading");var r=Object.create(i.prototype);r._style=t,r._groupLayers=!1,r._broadcastLayers=!1,r._reloadSources={},r._events=[],r._change=!1,e(r),r._groupLayers&&r._style._groupLayers(),r._broadcastLayers&&r._style._broadcastLayers(),Object.keys(r._reloadSources).forEach(function(t){r._style._reloadSource(t)}),r._events.forEach(function(t){r._style.fire.apply(r._style,t)}),r._change&&r._style.fire("change")}var n=t("../source/source"),o=t("./style_layer");i.prototype={addLayer:function(t,e){if(void 0!==this._style._layers[t.id])throw new Error("There is already a layer with this ID");return t instanceof o||(t=new o(t,this._style.stylesheet.constants||{})),this._style._layers[t.id]=t,this._style._order.splice(e?this._style._order.indexOf(e):1/0,0,t.id),t.resolveLayout(),t.resolveReference(this._style._layers),t.resolvePaint(),this._groupLayers=!0,this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._events.push(["layer.add",{layer:t}]),this._change=!0,this},removeLayer:function(t){var e=this._style._layers[t];if(void 0===e)throw new Error("There is no layer with this ID");for(var r in this._style._layers)this._style._layers[r].ref===t&&this.removeLayer(r);return delete this._style._layers[t],this._style._order.splice(this._style._order.indexOf(t),1),this._groupLayers=!0,this._broadcastLayers=!0,this._events.push(["layer.remove",{layer:e}]),this._change=!0,this},setPaintProperty:function(t,e,r,i){return this._style.getLayer(t).setPaintProperty(e,r,i),this._change=!0,this},setLayoutProperty:function(t,e,r){return t=this._style.getReferentLayer(t),t.setLayoutProperty(e,r),this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._change=!0,this},setFilter:function(t,e){return t=this._style.getReferentLayer(t),t.filter=e,this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._change=!0,this},setLayerZoomRange:function(t,e,r){var i=this._style.getReferentLayer(t);return null!=e&&(i.minzoom=e),null!=r&&(i.maxzoom=r),this._broadcastLayers=!0,i.source&&(this._reloadSources[i.source]=!0),this._change=!0,this},addSource:function(t,e){if(!this._style._loaded)throw new Error("Style is not done loading");if(void 0!==this._style.sources[t])throw new Error("There is already a source with this ID");return e=n.create(e),this._style.sources[t]=e,e.id=t,e.style=this._style,e.dispatcher=this._style.dispatcher,e.glyphAtlas=this._style.glyphAtlas,e.on("load",this._style._forwardSourceEvent).on("error",this._style._forwardSourceEvent).on("change",this._style._forwardSourceEvent).on("tile.add",this._style._forwardTileEvent).on("tile.load",this._style._forwardTileEvent).on("tile.error",this._style._forwardTileEvent).on("tile.remove",this._style._forwardTileEvent),this._events.push(["source.add",{source:e}]),this._change=!0,this},removeSource:function(t){if(void 0===this._style.sources[t])throw new Error("There is no source with this ID");var e=this._style.sources[t];return delete this._style.sources[t],e.off("load",this._style._forwardSourceEvent).off("error",this._style._forwardSourceEvent).off("change",this._style._forwardSourceEvent).off("tile.add",this._style._forwardTileEvent).off("tile.load",this._style._forwardTileEvent).off("tile.error",this._style._forwardTileEvent).off("tile.remove",this._style._forwardTileEvent),this._events.push(["source.remove",{source:e}]),this._change=!0,this}},e.exports=i},{"../source/source":46,"./style_layer":64}],61:[function(t,e,r){"use strict";var i=t("../util/util");r.resolve=function(t,e){function r(t){return"string"==typeof t&&"@"===t[0]?e[t]:t}var n;if(t=r(t),Array.isArray(t))for(t=t.slice(),n=0;n<t.length;n++)t[n]in e&&(t[n]=r(t[n]));if(t.stops)for(t=i.extend({},t),t.stops=t.stops.slice(),n=0;n<t.stops.length;n++)t.stops[n][1]in e&&(t.stops[n]=[t.stops[n][0],r(t.stops[n][1])]);return t},r.resolveAll=function(t,e){if(!e)return t;var i={};for(var n in t)i[n]=r.resolve(t[n],e);return i}},{"../util/util":110}],62:[function(t,e,r){"use strict";function i(t,e){this.type=t.type,this.transitionable=t.transition,this.json=JSON.stringify(e),"color"!==this.type?this.value=e:e.stops?this.value=s(e):this.value=o(e),"interpolated"===t["function"]?this.calculate=h.interpolated(this.value):(this.calculate=h["piecewise-constant"](this.value),t.transition&&(this.calculate=n(this.calculate)))}function n(t){return function(e,r,i){var n,o,a,s=e%1,u=Math.min((Date.now()-r.lastIntegerZoomTime)/i,1),h=1,l=1;return e>r.lastIntegerZoom?(n=s+(1-s)*u,h*=2,o=t(e-1),a=t(e)):(n=1-(1-u)*s,a=t(e),o=t(e+1),h/=2),{from:o,fromScale:h,to:a,toScale:l,t:n}}}function o(t){if(c[t])return c[t];var e=a(u(t));return c[t]=e,e}function a(t){return[t[0]/255,t[1]/255,t[2]/255,t[3]/1]}function s(t){return l.extend({},t,{stops:t.stops.map(function(t){return[t[0],o(t[1])]})})}var u=t("csscolorparser").parseCSSColor,h=t("mapbox-gl-function"),l=t("../util/util");e.exports=i;var c={}},{"../util/util":110,csscolorparser:111,"mapbox-gl-function":129}],63:[function(t,e,r){"use strict";function i(t){function e(t,e){this._values={},this._transitions={},this._constants=e;for(var r in t)this[r]=a.resolve(t[r],this._constants)}return Object.keys(t).forEach(function(r){var i=t[r];Object.defineProperty(e.prototype,r,{set:function(t){this._values[r]=new s(i,a.resolve(t,this._constants))},get:function(){return this._values[r].value}}),i.transition&&Object.defineProperty(e.prototype,r+"-transition",{set:function(t){this._transitions[r]=t},get:function(){return this._transitions[r]}})}),e.prototype.values=function(){return this._values},e.prototype.transition=function(t,e){var r=this._transitions[t]||{};return{duration:n.coalesce(r.duration,e.duration,300),delay:n.coalesce(r.delay,e.delay,0)}},e.prototype.json=function(){var t={};for(var e in this._values)t[e]=this._values[e].value;for(var r in this._transitions)t[r+"-transition"]=this._transitions[e];return t},e}var n=t("../util/util"),o=t("./reference"),a=t("./style_constant"),s=t("./style_declaration"),u={paint:{},layout:{}};o.layer.type.values.forEach(function(t){u.paint[t]=i(o["paint_"+t]),u.layout[t]=i(o["layout_"+t])}),e.exports=function(t,e,r,i){return new u[t][e](r,i)}},{"../util/util":110,"./reference":58,"./style_constant":61,"./style_declaration":62}],64:[function(t,e,r){"use strict";function i(t,e){this._layer=t,this._constants=e,this.id=t.id,this.ref=t.ref,this._resolved={},this._cascaded={},this.assign(t)}function n(t,e){var r=e+"-color",i=e+"-halo-color",n=e+"-outline-color",a=t[r],s=t[i],u=t[n],h=t[e+"-opacity"],l=a&&h*a[3],c=s&&h*s[3],f=u&&h*u[3];void 0!==l&&1>l&&(t[r]=o.premultiply([a[0],a[1],a[2],l])),void 0!==c&&1>c&&(t[i]=o.premultiply([s[0],s[1],s[2],c])),void 0!==f&&1>f&&(t[n]=o.premultiply([u[0],u[1],u[2],f]))}var o=t("../util/util"),a=t("./style_constant"),s=t("./style_transition"),u=t("./style_declaration_set"),h=t("./layout_properties"),l=t("./paint_properties");e.exports=i,i.prototype={resolveLayout:function(){this.ref||(this.layout=new h[this.type](a.resolveAll(this._layer.layout,this._constants)),"line"===this.layout["symbol-placement"]&&(this.layout.hasOwnProperty("text-rotation-alignment")||(this.layout["text-rotation-alignment"]="map"),this.layout.hasOwnProperty("icon-rotation-alignment")||(this.layout["icon-rotation-alignment"]="map"),this.layout["symbol-avoid-edges"]=!0))},setLayoutProperty:function(t,e){this.layout[t]=a.resolve(e,this._constants)},getLayoutProperty:function(t){return this.layout[t]},resolveReference:function(t){this.ref&&this.assign(t[this.ref])},resolvePaint:function(){for(var t in this._layer){var e=t.match(/^paint(?:\.(.*))?$/);e&&(this._resolved[e[1]||""]=new u("paint",this.type,this._layer[t],this._constants))}},setPaintProperty:function(t,e,r){var i=this._resolved[r||""];i||(i=this._resolved[r||""]=new u("paint",this.type,{},this._constants)),i[t]=e},getPaintProperty:function(t,e){var r=this._resolved[e||""];return r?r[t]:void 0},cascade:function(t,e,r,i){for(var n in this._resolved)if(""===n||t[n]){var o=this._resolved[n],a=o.values();for(var u in a){var h=a[u],l=e.transition?this._cascaded[u]:void 0;if(!l||l.declaration.json!==h.json){var c=o.transition(u,r),f=this._cascaded[u]=new s(h,l,c);f.instant()||(f.loopID=i.set(f.endTime-(new Date).getTime())),l&&i.cancel(l.loopID)}}}},recalculate:function(t,e){var r=this.type,i=this.paint=new l[r];for(var o in this._cascaded)i[o]=this._cascaded[o].at(t,e);if(this.hidden=this.minzoom&&t<this.minzoom||this.maxzoom&&t>=this.maxzoom||"none"===this.layout.visibility,"symbol"===r?0!==i["text-opacity"]&&this.layout["text-field"]||0!==i["icon-opacity"]&&this.layout["icon-image"]?(n(i,"text"),n(i,"icon")):this.hidden=!0:0===i[r+"-opacity"]?this.hidden=!0:n(i,r),this._cascaded["line-dasharray"]){var a=i["line-dasharray"],s=this._cascaded["line-width"]?this._cascaded["line-width"].at(Math.floor(t),1/0):i["line-width"];a.fromScale*=s,a.toScale*=s}return!this.hidden},assign:function(t){o.extend(this,o.pick(t,["type","source","source-layer","minzoom","maxzoom","filter","layout"]))},json:function(){return o.extend({},this._layer,o.pick(this,["type","source","source-layer","minzoom","maxzoom","filter","layout","paint"]))}}},{"../util/util":110,"./layout_properties":56,"./paint_properties":57,"./style_constant":61,"./style_declaration_set":63,"./style_transition":65}],65:[function(t,e,r){"use strict";function i(t,e,r){this.declaration=t,this.startTime=this.endTime=(new Date).getTime();var i=t.type;"string"!==i&&"array"!==i||!t.transitionable?this.interp=a[i]:this.interp=n,this.oldTransition=e,this.duration=r.duration||0,this.delay=r.delay||0,this.instant()||(this.endTime=this.startTime+this.duration+this.delay,this.ease=o.easeCubicInOut),e&&e.endTime<=this.startTime&&delete e.oldTransition}function n(t,e,r){return{from:t.to,fromScale:t.toScale,to:e.to,toScale:e.toScale,t:r}}var o=t("../util/util"),a=t("../util/interpolate");e.exports=i,i.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},i.prototype.at=function(t,e,r){var i=this.declaration.calculate(t,e,this.duration);if(this.instant())return i;if(r=r||Date.now(),r<this.endTime){var n=this.oldTransition.at(t,e,this.startTime),o=this.ease((r-this.startTime-this.delay)/this.duration);i=this.interp(n,i,o)}return i}},{"../util/interpolate":106,"../util/util":110}],66:[function(t,e,r){"use strict";function i(t,e,r,i){this.x=t,this.y=e,this.angle=r,void 0!==i&&(this.segment=i)}var n=t("point-geometry");e.exports=i,i.prototype=Object.create(n.prototype),i.prototype.clone=function(){return new i(this.x,this.y,this.angle,this.segment)}},{"point-geometry":137}],67:[function(t,e,r){"use strict";function i(t,e){this.width=t,this.height=e,this.free=[{x:0,y:0,w:t,h:e}]}e.exports=i,i.prototype.release=function(t){for(var e=0;e<this.free.length;e++){var r=this.free[e];if(r.y===t.y&&r.h===t.h&&r.x+r.w===t.x)r.w+=t.w;else if(r.x===t.x&&r.w===t.w&&r.y+r.h===t.y)r.h+=t.h;else if(t.y===r.y&&t.h===r.h&&t.x+t.w===r.x)r.x=t.x,r.w+=t.w;else{if(t.x!==r.x||t.w!==r.w||t.y+t.h!==r.y)continue;r.y=t.y,r.h+=t.h}return this.free.splice(e,1),void this.release(r)}this.free.push(t)},i.prototype.allocate=function(t,e){for(var r={x:1/0,y:1/0,w:1/0,h:1/0},i=-1,n=0;n<this.free.length;n++){var o=this.free[n];t<=o.w&&e<=o.h&&o.y<=r.y&&o.x<=r.x&&(r=o,i=n)}return 0>i?{x:-1,y:-1}:(this.free.splice(i,1),r.w<r.h?(r.w>t&&this.free.push({x:r.x+t,y:r.y,w:r.w-t,h:e}),r.h>e&&this.free.push({x:r.x,y:r.y+e,w:r.w,h:r.h-e})):(r.w>t&&this.free.push({x:r.x+t,y:r.y,w:r.w-t,h:r.h}),r.h>e&&this.free.push({x:r.x,y:r.y+e,w:t,h:r.h-e})),{x:r.x,y:r.y,w:t,h:e})}},{}],68:[function(t,e,r){"use strict";function i(t,e,r,i,n){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-r/2;){if(a--,0>a)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],h=0;r/2>s;){var l=t[a-1],c=t[a],f=t[a+1];if(!f)return!1;var d=l.angleTo(c)-c.angleTo(f);for(d=(d+3*Math.PI)%(2*Math.PI)-Math.PI,u.push({distance:s,angleDelta:d}),h+=d;s-u[0].distance>i;)h-=u.shift().angleDelta;if(Math.abs(h)>n)return!1;a++,s+=c.dist(f)}return!0}e.exports=i},{}],69:[function(t,e,r){"use strict";function i(t,e,r,i,o){for(var a=[],s=0;s<t.length;s++)for(var u,h=t[s],l=0;l<h.length-1;l++){var c=h[l],f=h[l+1];c.x<e&&f.x<e||(c.x<e?c=new n(e,c.y+(f.y-c.y)*((e-c.x)/(f.x-c.x))):f.x<e&&(f=new n(e,c.y+(f.y-c.y)*((e-c.x)/(f.x-c.x)))),c.y<r&&f.y<r||(c.y<r?c=new n(c.x+(f.x-c.x)*((r-c.y)/(f.y-c.y)),r):f.y<r&&(f=new n(c.x+(f.x-c.x)*((r-c.y)/(f.y-c.y)),r)),c.x>=i&&f.x>=i||(c.x>=i?c=new n(i,c.y+(f.y-c.y)*((i-c.x)/(f.x-c.x))):f.x>=i&&(f=new n(i,c.y+(f.y-c.y)*((i-c.x)/(f.x-c.x)))),c.y>=o&&f.y>=o||(c.y>=o?c=new n(c.x+(f.x-c.x)*((o-c.y)/(f.y-c.y)),o):f.y>=o&&(f=new n(c.x+(f.x-c.x)*((o-c.y)/(f.y-c.y)),o)),u&&c.equals(u[u.length-1])||(u=[c],a.push(u)),u.push(f)))))}return a}var n=t("point-geometry");e.exports=i},{"point-geometry":137}],70:[function(t,e,r){"use strict";function i(t,e,r,i,n,o){this.anchorPoint=t,this.x1=e,this.y1=r,this.x2=i,this.y2=n,this.maxScale=o,this.placementScale=0,this[0]=this[1]=this[2]=this[3]=0}e.exports=i},{}],71:[function(t,e,r){"use strict";function i(t,e,r,i,a,s){var u=r.top*i-a,h=r.bottom*i+a,l=r.left*i-a,c=r.right*i+a;if(this.boxes=[],s){var f=h-u,d=c-l;if(0>=f)return;f=Math.max(10*i,f),this._addLineCollisionBoxes(t,e,d,f)}else this.boxes.push(new n(new o(e.x,e.y),l,u,c,h,1/0))}var n=t("./collision_box"),o=t("point-geometry");e.exports=i,i.prototype._addLineCollisionBoxes=function(t,e,r,i){var o=i/2,a=Math.floor(r/o),s=-i/2,u=this.boxes,h=e,l=e.segment+1,c=s;do{if(l--,0>l)return u;c-=t[l].dist(h),h=t[l]}while(c>-r/2);for(var f=t[l].dist(t[l+1]),d=0;a>d;d++){for(var p=-r/2+d*o;p>c+f;){if(c+=f,l++,l+1>=t.length)return u;f=t[l].dist(t[l+1])}var m=p-c,v=t[l],_=t[l+1],g=_.sub(v)._unit()._mult(m)._add(v),y=Math.max(Math.abs(p-s)-o/2,0),x=r/2/y;u.push(new n(g,-i/2,-i/2,i/2,i/2,x))}return u}},{"./collision_box":70,"point-geometry":137}],72:[function(t,e,r){"use strict";function i(t,e){this.tree=n(),this.angle=t;var r=Math.sin(t),i=Math.cos(t);this.rotationMatrix=[i,-r,r,i],this.yStretch=1/Math.cos(e/180*Math.PI),this.yStretch=Math.pow(this.yStretch,1.3)}var n=t("rbush");e.exports=i,i.prototype.minScale=.25,i.prototype.maxScale=2,i.prototype.placeCollisionFeature=function(t){for(var e=this.minScale,r=this.rotationMatrix,i=this.yStretch,n=0;n<t.boxes.length;n++){var o=t.boxes[n],a=o.anchorPoint.matMult(r),s=a.x,u=a.y;o[0]=s+o.x1,o[1]=u+o.y1*i,o[2]=s+o.x2,o[3]=u+o.y2*i;for(var h=this.tree.search(o),l=0;l<h.length;l++){var c=h[l],f=c.anchorPoint.matMult(r),d=(c.x1-o.x2)/(s-f.x),p=(c.x2-o.x1)/(s-f.x),m=(c.y1-o.y2)*i/(u-f.y),v=(c.y2-o.y1)*i/(u-f.y);(isNaN(d)||isNaN(p))&&(d=p=1),(isNaN(m)||isNaN(v))&&(m=v=1);var _=Math.min(Math.max(d,p),Math.max(m,v));if(_>c.maxScale&&(_=c.maxScale),_>o.maxScale&&(_=o.maxScale),_>e&&_>=c.placementScale&&(e=_),e>=this.maxScale)return e}}return e},i.prototype.insertCollisionFeature=function(t,e){for(var r=t.boxes,i=0;i<r.length;i++)r[i].placementScale=e;e<this.maxScale&&this.tree.load(r)}},{rbush:138}],73:[function(t,e,r){"use strict";function i(t,e,r,i,o,a,s,u){var h=i?.6*a*s:0,l=Math.max(i?i.right-i.left:0,o?o.right-o.left:0);if(0===t[0].x||4096===t[0].x||0===t[0].y||4096===t[0].y)var c=!0;e/4>e-l*s&&(e=l*s+e/4);var f=2*a,d=c?e/2*u%e:(l/2+f)*s*u%e;return n(t,d,e,h,r,l*s,c,!1)}function n(t,e,r,i,u,h,l,c){for(var f=0,d=e-r,p=[],m=0;m<t.length-1;m++){for(var v=t[m],_=t[m+1],g=v.dist(_),y=_.angleTo(v);f+g>d+r;){d+=r;var x=(d-f)/g,b=o(v.x,_.x,x),w=o(v.y,_.y,x);if(b>=0&&4096>b&&w>=0&&4096>w){b=Math.round(b),w=Math.round(w);var S=new a(b,w,y,m);(!i||s(t,S,h,i,u))&&p.push(S)}}f+=g}return c||p.length||l||(p=n(t,f/2,r,i,u,h,l,!0)),p}var o=t("../util/interpolate"),a=t("../symbol/anchor"),s=t("./check_max_angle");e.exports=i},{"../symbol/anchor":66,"../util/interpolate":106,"./check_max_angle":68}],74:[function(t,e,r){"use strict";function i(t,e){this.width=t,this.height=e,this.bin=new n(t,e),this.index={},this.ids={},this.data=new Uint8Array(t*e)}var n=t("./bin_pack");e.exports=i,i.prototype={get debug(){return"canvas"in this},set debug(t){t&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!t&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},i.prototype.getGlyphs=function(){var t,e,r,i={};for(var n in this.ids)t=n.split("#"),e=t[0],r=t[1],i[e]||(i[e]=[]),i[e].push(r);return i},i.prototype.getRects=function(){var t,e,r,i={};for(var n in this.ids)t=n.split("#"),e=t[0],r=t[1],i[e]||(i[e]={}),i[e][r]=this.index[n];return i},i.prototype.removeGlyphs=function(t){for(var e in this.ids){var r=this.ids[e],i=r.indexOf(t);if(i>=0&&r.splice(i,1),this.ids[e]=r,!r.length){for(var n=this.index[e],o=this.data,a=0;a<n.h;a++)for(var s=this.width*(n.y+a)+n.x,u=0;u<n.w;u++)o[s+u]=0;this.dirty=!0,this.bin.release(n),delete this.index[e],delete this.ids[e]}}this.updateTexture(this.gl)},i.prototype.addGlyph=function(t,e,r,i){if(!r)return null;var n=e+"#"+r.id;if(this.index[n])return this.ids[n].indexOf(t)<0&&this.ids[n].push(t),this.index[n];if(!r.bitmap)return null;var o=r.width+2*i,a=r.height+2*i,s=1,u=o+2*s,h=a+2*s;u+=4-u%4,h+=4-h%4;var l=this.bin.allocate(u,h);if(l.x<0)return console.warn("glyph bitmap overflow"),{glyph:r,rect:null};this.index[n]=l,this.ids[n]=[t];for(var c=this.data,f=r.bitmap,d=0;a>d;d++)for(var p=this.width*(l.y+d+s)+l.x+s,m=o*d,v=0;o>v;v++)c[p+v]=f[m+v];return this.dirty=!0,l},i.prototype.bind=function(t){this.gl=t,this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,null))},i.prototype.updateTexture=function(t){if(this.bind(t),this.dirty){if(t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data),this.ctx){for(var e=this.ctx.getImageData(0,0,this.width,this.height),r=0,i=0;r<this.data.length;r++,i+=4)e.data[i]=this.data[r],e.data[i+1]=this.data[r],e.data[i+2]=this.data[r],e.data[i+3]=255;this.ctx.putImageData(e,0,0),this.ctx.strokeStyle="red";for(var n=0;n<this.bin.free.length;n++){var o=this.bin.free[n];this.ctx.strokeRect(o.x,o.y,o.w,o.h)}}this.dirty=!1}}},{"./bin_pack":67}],75:[function(t,e,r){"use strict";function i(t,e){this.url=t&&a(t),this.glyphAtlas=e,this.stacks=[],this.loading={}}function n(t,e,r){var i=1;this.advance=t.advance,this.left=t.left-r-i,this.top=t.top+r+i,this.rect=e}function o(t,e,r,i){return i=i||"abc",r.replace("{s}",i[t.length%i.length]).replace("{fontstack}",t).replace("{range}",e)}var a=t("../util/mapbox").normalizeGlyphsURL,s=t("../util/ajax").getArrayBuffer,u=t("../util/glyphs"),h=t("pbf");e.exports=i,i.prototype.getSimpleGlyphs=function(t,e,r,i){void 0===this.stacks[t]&&(this.stacks[t]={});for(var o,a={},s=this.stacks[t],u=this.glyphAtlas,h=3,l={},c=0,f=0;f<e.length;f++){var d=e[f];if(o=Math.floor(d/256),s[o]){var p=s[o].glyphs[d],m=u.addGlyph(r,t,p,h);p&&(a[d]=new n(p,m,h))}else void 0===l[o]&&(l[o]=[],c++),l[o].push(d)}c||i(void 0,a);var v=function(e,o,s){if(!e)for(var f=this.stacks[t][o]=s.stacks[0],d=0;d<l[o].length;d++){var p=l[o][d],m=f.glyphs[p],v=u.addGlyph(r,t,m,h);m&&(a[p]=new n(m,v,h))}c--,c||i(void 0,a)}.bind(this);for(var _ in l)this.loadRange(t,_,v)},i.prototype.loadRange=function(t,e,r){if(256*e>65535)return r("gyphs > 65535 not supported");void 0===this.loading[t]&&(this.loading[t]={});var i=this.loading[t];if(i[e])i[e].push(r);else{i[e]=[r];var n=256*e+"-"+(256*e+255),a=o(t,n,this.url);s(a,function(t,r){for(var n=!t&&new u(new h(new Uint8Array(r))),o=0;o<i[e].length;o++)i[e][o](t,e,n);delete i[e]})}}},{"../util/ajax":98,"../util/glyphs":105,"../util/mapbox":107,pbf:135}],76:[function(t,e,r){"use strict";e.exports=function(t,e,r){function i(i){l.push(t[i]),c.push(r[i]),f.push(e[i]),d++}function n(t,e,r){var i=h[t];return delete h[t],h[e]=i,c[i][0].pop(),c[i][0]=c[i][0].concat(r[0]),i}function o(t,e,r){var i=u[e];return delete u[e],u[t]=i,c[i][0].shift(),c[i][0]=r[0].concat(c[i][0]),i}function a(t,e,r){var i=r?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}var s,u={},h={},l=[],c=[],f=[],d=0;for(s=0;s<t.length;s++){var p=r[s],m=e[s];if(m){var v=a(m,p),_=a(m,p,!0);if(v in h&&_ in u&&h[v]!==u[_]){
var g=o(v,_,p),y=n(v,_,c[g]);delete u[v],delete h[_],h[a(m,c[y],!0)]=y,c[g]=null}else v in h?n(v,_,p):_ in u?o(v,_,p):(i(s),u[v]=d-1,h[_]=d-1)}else i(s)}return{features:l,textFeatures:f,geometries:c}}},{}],77:[function(t,e,r){"use strict";function i(t,e,r,i,n,o,a,s,u){this.anchorPoint=t,this.tl=e,this.tr=r,this.bl=i,this.br=n,this.tex=o,this.angle=a,this.minScale=s,this.maxScale=u}function n(t,e,r,n,o,a){var h=e.image.rect,l=1,c=e.left-l,f=c+h.w,d=e.top-l,p=d+h.h,m=new s(c,d),v=new s(f,d),_=new s(f,p),g=new s(c,p),y=o["icon-rotate"]*Math.PI/180;if(a){var x=n[t.segment];y+=Math.atan2(t.y-x.y,t.x-x.x)}if(y){var b=Math.sin(y),w=Math.cos(y),S=[w,-b,b,w];m=m.matMult(S),v=v.matMult(S),g=g.matMult(S),_=_.matMult(S)}return[new i(new s(t.x,t.y),m,v,g,_,e.image.rect,0,u,1/0)]}function o(t,e,r,n,o,h){for(var l=o["text-rotate"]*Math.PI/180,c=o["text-keep-upright"],f=e.positionedGlyphs,d=[],p=0;p<f.length;p++){var m=f[p],v=m.glyph,_=v.rect;if(_){var g,y=(m.x+v.advance/2)*r,x=u;h?(g=[],x=a(g,t,y,n,t.segment,!0),c&&(x=Math.min(x,a(g,t,y,n,t.segment,!1)))):g=[{anchorPoint:new s(t.x,t.y),offset:0,angle:0,maxScale:1/0,minScale:u}];for(var b=m.x+v.left,w=m.y-v.top,S=b+_.w,M=w+_.h,E=new s(b,w),T=new s(S,w),z=new s(b,M),A=new s(S,M),P=0;P<g.length;P++){var I=g[P],L=E,k=T,D=z,R=A,O=I.angle+l;if(O){var j=Math.sin(O),C=Math.cos(O),B=[C,-j,j,C];L=L.matMult(B),k=k.matMult(B),D=D.matMult(B),R=R.matMult(B)}var F=Math.max(I.minScale,x),N=(t.angle+l+I.offset+2*Math.PI)%(2*Math.PI);d.push(new i(I.anchorPoint,L,k,D,R,_,N,F,I.maxScale))}}}return d}function a(t,e,r,i,n,o){var a=!o;0>r&&(o=!o),o&&n++;var h=new s(e.x,e.y),l=i[n],c=1/0;r=Math.abs(r);for(var f=u;;){var d=h.dist(l),p=r/d,m=Math.atan2(l.y-h.y,l.x-h.x);if(o||(m+=Math.PI),a&&(m+=Math.PI),t.push({anchorPoint:h,offset:a?Math.PI:0,minScale:p,maxScale:c,angle:(m+2*Math.PI)%(2*Math.PI)}),f>=p)break;for(h=l;h.equals(l);)if(n+=o?1:-1,l=i[n],!l)return p;var v=l.sub(h)._unit();h=h.sub(v._mult(d)),c=p}return f}var s=t("point-geometry");e.exports={getIconQuads:n,getGlyphQuads:o};var u=.5},{"point-geometry":137}],78:[function(t,e,r){"use strict";function i(t,e){for(var r=[],i=0,o=t.length;o>i;i++){var a=n(t[i].properties,e["icon-image"]);a&&r.indexOf(a)<0&&r.push(a)}return r}var n=t("../util/token");e.exports=i},{"../util/token":109}],79:[function(t,e,r){"use strict";function i(t,e,r){for(var i=[],o=[],s=0,u=t.length;u>s;s++){var h=a(t[s].properties,e["text-field"]);if(h){h=h.toString();var l=e["text-transform"];"uppercase"===l?h=h.toLocaleUpperCase():"lowercase"===l&&(h=h.toLocaleLowerCase());for(var c=0,f=h.length;f>c;c++)o.push(h.charCodeAt(c));i[s]=h}else i[s]=null}return o=n(o,r),{textFeatures:i,codepoints:o}}function n(t,e){var r,i=[];t.sort(o);for(var n=0;n<t.length;n++)t[n]!==r&&(r=t[n],e[r]||i.push(t[n]));return i}function o(t,e){return t-e}var a=t("../util/token");e.exports=i},{"../util/token":109}],80:[function(t,e,r){"use strict";function i(t,e,r,i){this.codePoint=t,this.x=e,this.y=r,this.glyph=i}function n(t,e,r,i,n,o){this.positionedGlyphs=t,this.text=e,this.top=r,this.bottom=i,this.left=n,this.right=o}function o(t,e,r,o,s,u,h,l,c){for(var f=[],d=new n(f,t,c[1],c[1],c[0],c[0]),p=-17,m=c[0],v=c[1]+p,_=0;_<t.length;_++){var g=t.charCodeAt(_),y=e[g];y&&(f.push(new i(g,m,v,y)),m+=y.advance+l)}return f.length?(a(d,e,o,r,s,u,h),d):!1}function a(t,e,r,i,n,o,a){var h=null,l=0,f=0,d=0,p=0,m=t.positionedGlyphs;if(i)for(var v=0;v<m.length;v++){var _=m[v];if(_.x-=l,_.y+=r*d,_.x>i&&null!==h){var g=m[h+1].x;p=Math.max(g,p);for(var y=h+1;v>=y;y++)m[y].y+=r,m[y].x-=g;a&&s(m,e,f,h-1,a),f=h+1,h=null,l+=g,d++}c[_.codePoint]&&(h=v)}var x=m[m.length-1],b=x.x+e[x.codePoint].advance;p=Math.max(p,b);var w=(d+1)*r;s(m,e,f,m.length-1,a),u(m,a,n,o,p,r,d),t.top+=-o*w,t.bottom=t.top+w,t.left+=-n*p,t.right=t.left+p}function s(t,e,r,i,n){for(var o=e[t[i].codePoint].advance,a=(t[i].x+o)*n,s=r;i>=s;s++)t[s].x-=a}function u(t,e,r,i,n,o,a){for(var s=(e-r)*n,u=(-i*(a+1)+.5)*o,h=0;h<t.length;h++)t[h].x+=s,t[h].y+=u}function h(t,e){if(!t||!t.rect)return null;var r=e["icon-offset"][0],i=e["icon-offset"][1],n=r-t.width/2,o=n+t.width,a=i-t.height/2,s=a+t.height;return new l(t,a,s,n,o)}function l(t,e,r,i,n){this.image=t,this.top=e,this.bottom=r,this.left=i,this.right=n}e.exports={shapeText:o,shapeIcon:h};var c={32:!0}},{}],81:[function(t,e,r){"use strict";function i(t,e){this.width=t,this.height=e,this.bin=new a(t,e),this.images={},this.data=!1,this.texture=0,this.filter=0,this.pixelRatio=1,this.dirty=!0}function n(t,e,r,i,n,o,a,s,u,h,l){var c,f,d=i*e+r,p=s*o+a;if(l)for(p-=o,f=-1;h>=f;f++,d=((f+h)%h+i)*e+r,p+=o)for(c=-1;u>=c;c++)n[p+c]=t[d+(c+u)%u];else for(f=0;h>f;f++,d+=e,p+=o)for(c=0;u>c;c++)n[p+c]=t[d+c]}function o(t,e,r,i){this.rect=t,this.width=e,this.height=r,this.sdf=i}var a=t("./bin_pack");e.exports=i,i.prototype={get debug(){return"canvas"in this},set debug(t){t&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.canvas.style.width=this.width+"px",this.canvas.style.width=this.width+"px",document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!t&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},i.prototype.resize=function(t){if(this.pixelRatio===t)return!1;var e=this.pixelRatio;if(this.pixelRatio=t,this.canvas&&(this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio),this.data){var r=this.data;this.data=!1,this.allocate(),this.texture=!1;for(var i=this.width*e,n=this.height*e,o=this.width*t,a=this.height*t,s=this.data,u=r,h=0;a>h;h++)for(var l=Math.floor(h*n/a)*i,c=h*o,f=0;o>f;f++){var d=Math.floor(f*i/o);s[c+f]=u[l+d]}r=null,this.dirty=!0}return this.dirty},i.prototype.allocateImage=function(t,e){var r=2,i=t+r+(4-(t+r)%4),n=e+r+(4-(e+r)%4),o=this.bin.allocate(i,n);return 0===o.w?o:(o.originalWidth=t,o.originalHeight=e,o)},i.prototype.getImage=function(t,e){if(this.images[t])return this.images[t];if(!this.sprite)return null;var r=this.sprite.getSpritePosition(t);if(!r.width||!r.height)return null;var i=r.width/r.pixelRatio,n=r.height/r.pixelRatio,a=this.allocateImage(i,n);if(0===a.w)return a;var s=new o(a,i,n,r.sdf);return this.images[t]=s,this.copy(a,r,e),s},i.prototype.getPosition=function(t,e){var r=this.getImage(t,e),i=r&&r.rect;if(!i)return null;var n=e?r.width:i.w,o=e?r.height:i.h,a=1;return{size:[n,o],tl:[(i.x+a)/this.width,(i.y+a)/this.height],br:[(i.x+a+n)/this.width,(i.y+a+o)/this.height]}},i.prototype.allocate=function(){if(!this.data){var t=Math.floor(this.width*this.pixelRatio),e=Math.floor(this.height*this.pixelRatio);this.data=new Uint32Array(t*e);for(var r=0;r<this.data.length;r++)this.data[r]=0}},i.prototype.copy=function(t,e,r){if(this.sprite.img.data){var i=new Uint32Array(this.sprite.img.data.buffer);this.allocate();var o=this.data,a=1;n(i,this.sprite.img.width,e.x,e.y,o,this.width*this.pixelRatio,(t.x+a)*this.pixelRatio,(t.y+a)*this.pixelRatio,e.width,e.height,r),this.dirty=!0}},i.prototype.setSprite=function(t){this.sprite=t},i.prototype.addIcons=function(t,e){for(var r=0;r<t.length;r++)this.getImage(t[r]);e(null,this.images)},i.prototype.bind=function(t,e){var r=!1;this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r=!0);var i=e?t.LINEAR:t.NEAREST;if(i!==this.filter&&(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i),this.filter=i),this.dirty&&(this.allocate(),r?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width*this.pixelRatio,this.height*this.pixelRatio,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width*this.pixelRatio,this.height*this.pixelRatio,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1,this.ctx)){var n=this.ctx.getImageData(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio);n.data.set(new Uint8ClampedArray(this.data.buffer)),this.ctx.putImageData(n,0,0),this.ctx.strokeStyle="red";for(var o=0;o<this.bin.free.length;o++){var a=this.bin.free[o];this.ctx.strokeRect(a.x*this.pixelRatio,a.y*this.pixelRatio,a.w*this.pixelRatio,a.h*this.pixelRatio)}}}},{"./bin_pack":67}],82:[function(t,e,r){"use strict";var i=t("../util/util"),n=t("../util/interpolate"),o=t("../util/browser"),a=t("../geo/lat_lng"),s=t("../geo/lat_lng_bounds"),u=t("point-geometry"),h=e.exports=function(){};i.extend(h.prototype,{getCenter:function(){return this.transform.center},setCenter:function(t){return this.jumpTo({center:t}),this},panBy:function(t,e){return this.panTo(this.transform.center,i.extend({offset:u.convert(t).mult(-1)},e)),this},panTo:function(t,e){this.stop(),t=a.convert(t),e=i.extend({duration:500,easing:i.ease,offset:[0,0]},e);var r=this.transform,n=u.convert(e.offset).rotate(-r.angle),o=r.point,s=r.project(t).sub(n);return e.noMoveStart||this.fire("movestart"),this._ease(function(t){r.center=r.unproject(o.add(s.sub(o).mult(t))),this.fire("move")},function(){this.fire("moveend")},e),this},getZoom:function(){return this.transform.zoom},setZoom:function(t){return this.jumpTo({zoom:t}),this},zoomTo:function(t,e){this.stop(),e=i.extend({duration:500},e),e.easing=this._updateEasing(e.duration,t,e.easing);var r=this.transform,o=r.center,s=r.zoom;return e.around?o=a.convert(e.around):e.offset&&(o=r.pointLocation(r.centerPoint.add(u.convert(e.offset)))),e.animate===!1&&(e.duration=0),this.zooming||(this.zooming=!0,this.fire("movestart")),this._ease(function(e){r.setZoomAround(n(s,t,e),o),this.fire("move").fire("zoom")},function(){this.ease=null,e.duration>=200&&(this.zooming=!1,this.fire("moveend"))},e),e.duration<200&&(clearTimeout(this._onZoomEnd),this._onZoomEnd=setTimeout(function(){this.zooming=!1,this.fire("moveend")}.bind(this),200)),this},zoomIn:function(t){return this.zoomTo(this.getZoom()+1,t),this},zoomOut:function(t){return this.zoomTo(this.getZoom()-1,t),this},getBearing:function(){return this.transform.bearing},setBearing:function(t){return this.jumpTo({bearing:t}),this},rotateTo:function(t,e){this.stop(),e=i.extend({duration:500,easing:i.ease},e);var r=this.transform,o=this.getBearing(),s=r.center;return e.around?s=a.convert(e.around):e.offset&&(s=r.pointLocation(r.centerPoint.add(u.convert(e.offset)))),t=this._normalizeBearing(t,o),this.rotating=!0,this.fire("movestart"),this._ease(function(e){r.setBearingAround(n(o,t,e),s),this.fire("move").fire("rotate")},function(){this.rotating=!1,this.fire("moveend")},e),this},resetNorth:function(t){return this.rotateTo(0,i.extend({duration:1e3},t)),this},snapToNorth:function(t){return Math.abs(this.getBearing())<this.options.bearingSnap?this.resetNorth(t):this},getPitch:function(){return this.transform.pitch},setPitch:function(t){return this.jumpTo({pitch:t}),this},fitBounds:function(t,e){e=i.extend({padding:0,offset:[0,0],maxZoom:1/0},e),t=s.convert(t);var r=u.convert(e.offset),n=this.transform,o=n.project(t.getNorthWest()),a=n.project(t.getSouthEast()),h=a.sub(o),l=(n.width-2*e.padding-2*Math.abs(r.x))/h.x,c=(n.height-2*e.padding-2*Math.abs(r.y))/h.y;return e.center=n.unproject(o.add(a).div(2)),e.zoom=Math.min(n.scaleZoom(n.scale*Math.min(l,c)),e.maxZoom),e.bearing=0,e.linear?this.easeTo(e):this.flyTo(e)},jumpTo:function(t){this.stop();var e=this.transform,r=!1,i=!1,n=!1;return"center"in t&&(e.center=a.convert(t.center)),"zoom"in t&&e.zoom!==+t.zoom&&(r=!0,e.zoom=+t.zoom),"bearing"in t&&e.bearing!==+t.bearing&&(i=!0,e.bearing=+t.bearing),"pitch"in t&&e.pitch!==+t.pitch&&(n=!0,e.pitch=+t.pitch),this.fire("movestart").fire("move"),r&&this.fire("zoom"),i&&this.fire("rotate"),n&&this.fire("pitch"),this.fire("moveend")},easeTo:function(t){this.stop(),t=i.extend({offset:[0,0],duration:500,easing:i.ease},t);var e=this.transform,r=u.convert(t.offset).rotate(-e.angle),o=e.point,s=this.getZoom(),h=this.getBearing(),l=this.getPitch(),c="zoom"in t?+t.zoom:s,f="bearing"in t?this._normalizeBearing(t.bearing,h):h,d="pitch"in t?+t.pitch:l,p=e.zoomScale(c-s),m="center"in t?e.project(a.convert(t.center)).sub(r.div(p)):o,v=a.convert(t.around);return c!==s&&(this.zooming=!0),h!==f&&(this.rotating=!0),this.zooming&&!v&&(v=e.pointLocation(e.centerPoint.add(m.sub(o).div(1-1/p)))),this.fire("movestart"),this._ease(function(t){this.zooming?e.setZoomAround(n(s,c,t),v):e.center=e.unproject(o.add(m.sub(o).mult(t))),this.rotating&&(e.bearing=n(h,f,t)),d!==l&&(e.pitch=n(l,d,t)),this.fire("move"),this.zooming&&this.fire("zoom"),this.rotating&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},t),this},flyTo:function(t){function e(t){var e=(S*S-w*w+(t?-1:1)*E*E*M*M)/(2*(t?S:w)*E*M);return Math.log(Math.sqrt(e*e+1)-e)}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}function s(t){return r(t)/o(t)}this.stop(),t=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},t);var h=this.transform,l=u.convert(t.offset),c=this.getZoom(),f=this.getBearing(),d="center"in t?a.convert(t.center):this.getCenter(),p="zoom"in t?+t.zoom:c,m="bearing"in t?this._normalizeBearing(t.bearing,f):f,v=h.zoomScale(p-c),_=h.point,g=h.project(d).sub(l.div(v)),y=h.worldSize,x=t.curve,b=t.speed,w=Math.max(h.width,h.height),S=w/v,M=g.sub(_).mag(),E=x*x,T=e(0),z=function(t){return o(T)/o(T+x*t)},A=function(t){return w*((o(T)*s(T+x*t)-r(T))/E)/M},P=(e(1)-T)/x;if(Math.abs(M)<1e-6){if(Math.abs(w-S)<1e-6)return this;var I=w>S?-1:1;P=Math.abs(Math.log(S/w))/x,A=function(){return 0},z=function(t){return Math.exp(I*x*t)}}return t.duration=1e3*P/b,this.zooming=!0,f!==m&&(this.rotating=!0),this.fire("movestart"),this._ease(function(t){var e=t*P,r=A(e);h.zoom=c+h.scaleZoom(1/z(e)),h.center=h.unproject(_.add(g.sub(_).mult(r)),y),m!==f&&(h.bearing=n(f,m,t)),this.fire("move").fire("zoom"),m!==f&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},t),this},isEasing:function(){return!!this._abortFn},stop:function(){return this._abortFn&&(this._abortFn.call(this),this._finishEase()),this},_ease:function(t,e,r){this._finishFn=e,this._abortFn=o.timed(function(e){t.call(this,r.easing(e)),1===e&&this._finishEase()},r.animate===!1?0:r.duration,this)},_finishEase:function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t.call(this)},_normalizeBearing:function(t,e){t=i.wrap(t,-180,180);var r=Math.abs(t-e);return Math.abs(t-360-e)<r&&(t-=360),Math.abs(t+360-e)<r&&(t+=360),t},_updateEasing:function(t,e,r){var n;if(this.ease){var o=this.ease,a=(Date.now()-o.start)/o.duration,s=o.easing(a+.01)-o.easing(a),u=.27/Math.sqrt(s*s+1e-4)*.01,h=Math.sqrt(.0729-u*u);n=i.bezier(u,h,.25,1)}else n=r?i.bezier.apply(i,r):i.ease;return this.ease={start:(new Date).getTime(),to:Math.pow(2,e),duration:t,easing:n},n}})},{"../geo/lat_lng":25,"../geo/lat_lng_bounds":26,"../util/browser":99,"../util/interpolate":106,"../util/util":110,"point-geometry":137}],83:[function(t,e,r){"use strict";function i(){}var n=t("./control"),o=t("../../util/dom"),a=t("../../util/util");e.exports=i,i.prototype=a.inherit(n,{options:{position:"bottom-right"},onAdd:function(t){var e="mapboxgl-ctrl-attrib",r=this._container=o.create("div",e,t.getContainer());return this._update(),t.on("source.load",this._update.bind(this)),t.on("source.change",this._update.bind(this)),t.on("source.remove",this._update.bind(this)),t.on("moveend",this._updateEditLink.bind(this)),r},_update:function(){var t=[];if(this._map.style)for(var e in this._map.style.sources){var r=this._map.style.sources[e];r.attribution&&t.indexOf(r.attribution)<0&&t.push(r.attribution)}this._container.innerHTML=t.join(" | "),this._editLink=this._container.getElementsByClassName("mapbox-improve-map")[0],this._updateEditLink()},_updateEditLink:function(){if(this._editLink){var t=this._map.getCenter();this._editLink.href="https://www.mapbox.com/map-feedback/#/"+t.lng+"/"+t.lat+"/"+Math.round(this._map.getZoom()+1)}}})},{"../../util/dom":102,"../../util/util":110,"./control":84}],84:[function(t,e,r){"use strict";function i(){}e.exports=i,i.prototype={addTo:function(t){this._map=t;var e=this._container=this.onAdd(t);if(this.options&&this.options.position){var r=this.options.position,i=t._controlCorners[r];e.className+=" mapboxgl-ctrl",-1!==r.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e)}return this},remove:function(){return this._container.parentNode.removeChild(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this}}},{}],85:[function(t,e,r){"use strict";function i(t){a.setOptions(this,t)}var n=t("./control"),o=t("../../util/dom"),a=t("../../util/util");e.exports=i,i.prototype=a.inherit(n,{options:{position:"top-right"},onAdd:function(t){var e="mapboxgl-ctrl",r=this._container=o.create("div",e+"-group",t.getContainer());this._zoomInButton=this._createButton(e+"-icon "+e+"-zoom-in",t.zoomIn.bind(t)),this._zoomOutButton=this._createButton(e+"-icon "+e+"-zoom-out",t.zoomOut.bind(t)),this._compass=this._createButton(e+"-compass",t.resetNorth.bind(t));var i=this._compassCanvas=o.create("canvas",e+"-compass-canvas",this._compass);return i.style.cssText="width:30px; height:30px;",i.width=52,i.height=52,this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),this._compassCtx=i.getContext("2d"),t.on("rotate",this._drawNorth.bind(this)),this._drawNorth(),r},_onCompassDown:function(t){o.disableDrag(),document.addEventListener("mousemove",this._onCompassMove),document.addEventListener("mouseup",this._onCompassUp),this._prevX=t.screenX,t.stopPropagation()},_onCompassMove:function(t){var e=t.screenX,r=2>e?-5:e>window.screen.width-2?5:(e-this._prevX)/4;this._map.setBearing(this._map.getBearing()-r),this._prevX=t.screenX,this._moved=!0,t.preventDefault()},_onCompassUp:function(){document.removeEventListener("mousemove",this._onCompassMove),document.removeEventListener("mouseup",this._onCompassUp),o.enableDrag(),this._moved&&(this._moved=!1,o.suppressClick()),this._map.snapToNorth()},_createButton:function(t,e){var r=o.create("button",t,this._container);return r.addEventListener("click",function(){e()}),r},_drawNorth:function(){var t=20,e=8,r=26,i=this._map.transform.angle+Math.PI/2,n=this._compassCtx;this._compassCanvas.width=this._compassCanvas.width,n.translate(r,r),n.rotate(i),n.beginPath(),n.fillStyle="#000",n.lineTo(0,-e),n.lineTo(-t,0),n.lineTo(0,e),n.fill(),n.beginPath(),n.fillStyle="#bbb",n.moveTo(0,0),n.lineTo(0,e),n.lineTo(t,0),n.lineTo(0,-e),n.fill(),n.beginPath(),n.strokeStyle="#fff",n.lineWidth=4,n.moveTo(0,-e),n.lineTo(0,e),n.stroke()}})},{"../../util/dom":102,"../../util/util":110,"./control":84}],86:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),a.bindHandlers(this)}var n=t("../../util/dom"),o=t("../../geo/lat_lng_bounds"),a=t("../../util/util");e.exports=i,i.prototype={enable:function(){this._el.addEventListener("mousedown",this._onMouseDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onMouseDown)},_onMouseDown:function(t){(t.shiftKey||1===t.which&&1===t.button)&&(document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("mouseup",this._onMouseUp,!1),this._startPos=n.mousePos(this._el,t),this.active=!0)},_onMouseMove:function(t){var e=this._startPos,r=n.mousePos(this._el,t);this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),n.disableDrag(),this._map.fire("boxzoomstart"));var i=Math.min(e.x,r.x),o=Math.max(e.x,r.x),a=Math.min(e.y,r.y),s=Math.max(e.y,r.y);n.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"},_onMouseUp:function(t){var e=this._startPos,r=n.mousePos(this._el,t),i=new o(this._map.unproject(e),this._map.unproject(r));this._finish(),this._map.fitBounds(i,{linear:!0}).fire("boxzoomend",{boxZoomBounds:i})},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._map.fire("boxzoomcancel"))},_finish:function(){this._box&&(this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box.parentNode.removeChild(this._box),this._box=null,n.enableDrag())}}},{"../../geo/lat_lng_bounds":26,"../../util/dom":102,"../../util/util":110}],87:[function(t,e,r){"use strict";function i(t){this._map=t,this._onDblClick=this._onDblClick.bind(this)}e.exports=i,i.prototype={enable:function(){this._map.on("dblclick",this._onDblClick)},disable:function(){this._map.off("dblclick",this._onDblClick)},_onDblClick:function(t){this._map.zoomTo(Math.round(this._map.getZoom())+1,{around:t.latLng})}}},{}],88:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var n=t("../../util/dom"),o=t("../../util/util");e.exports=i;var a=.25,s=o.bezier(0,0,a,1),u=3e3,h=4e3;i.prototype={enable:function(){this._el.addEventListener("mousedown",this._onDown,!1),this._el.addEventListener("touchstart",this._onDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown)},_onDown:function(t){this._startPos=this._pos=n.mousePos(this._el,t),this._inertia=[[Date.now(),this._pos]],t.touches?1===t.touches.length&&(document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onTouchEnd,!1)):(document.addEventListener("mousemove",this._onMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1))},_onMove:function(t){var e=this._map;if(!(e.boxZoom.active||e.dragRotate.active||t.touches&&t.touches.length>1)){var r=n.mousePos(this._el,t),i=this._inertia,o=Date.now();for(i.push([o,r]);i.length>2&&o-i[0][0]>50;)i.shift();e.stop(),e.transform.setLocationAtPoint(e.transform.pointLocation(this._pos),r),e.fire("move"),this._pos=r,t.preventDefault()}},_onUp:function(){var t=this._inertia;if(t.length<2)return void this._map.fire("moveend");var e=t[t.length-1],r=t[0],i=e[1].sub(r[1]),n=(e[0]-r[0])/1e3,o=i.mult(a/n),l=o.mag();l>u&&(l=u,o._unit()._mult(l));var c=l/(h*a),f=o.mult(-c/2);this._map.panBy(f,{duration:1e3*c,easing:s,noMoveStart:!0})},_onMouseUp:function(){this._onUp(),document.removeEventListener("mousemove",this._onMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)},_onTouchEnd:function(){this._onUp(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd)}}},{"../../util/dom":102,"../../util/util":110}],89:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),a.bindHandlers(this)}var n=t("../../util/dom"),o=t("point-geometry"),a=t("../../util/util");e.exports=i,i.prototype={enable:function(){this._el.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){this._el.removeEventListener("contextmenu",this._onContextMenu)},_onContextMenu:function(t){this._map.stop(),this.active=!0,this._startPos=this._pos=n.mousePos(this._el,t),document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1),t.preventDefault()},_onMouseMove:function(t){var e=this._startPos,r=this._pos,i=n.mousePos(this._el,t),a=this._map,s=a.transform.centerPoint,u=e.sub(s),h=u.mag();a.rotating||(a.fire("movestart"),a.rotating=!0),200>h&&(s=e.add(new o(-200,0)._rotate(u.angle())));var l=r.sub(s).angleWith(i.sub(s))/Math.PI*180;a.transform.bearing=a.getBearing()-l,a.fire("move").fire("rotate"),clearTimeout(this._timeout),this._timeout=setTimeout(this._onTimeout,200),this._pos=i},_onTimeout:function(){var t=this._map;t.rotating=!1,t.snapToNorth(),t.rotating||(t._rerender(),t.fire("moveend"))},_onMouseUp:function(){this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)}}},{"../../util/dom":102,"../../util/util":110,"point-geometry":137}],90:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)}e.exports=i;var n=80,o=2;i.prototype={enable:function(){this._el.addEventListener("keydown",this._onKeyDown,!1)},disable:function(){this._el.removeEventListener("keydown",this._onKeyDown)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=this._map;switch(t.keyCode){case 61:case 107:case 171:case 187:e.zoomTo(Math.round(e.getZoom())+(t.shiftKey?2:1));break;case 189:case 109:case 173:e.zoomTo(Math.round(e.getZoom())-(t.shiftKey?2:1));break;case 37:t.shiftKey?e.setBearing(e.getBearing()-o):e.panBy([-n,0]);break;case 39:t.shiftKey?e.setBearing(e.getBearing()+o):e.panBy([n,0]);break;case 38:e.panBy([0,-n]);break;case 40:e.panBy([0,n])}}}}},{}],91:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var n=t("../../util/dom"),o=t("../../util/util");e.exports=i,i.prototype={enable:function(){this._el.addEventListener("touchstart",this._onStart,!1)},disable:function(){this._el.removeEventListener("touchstart",this._onStart)},_onStart:function(t){if(2===t.touches.length){var e=n.mousePos(this._el,t.touches[0]),r=n.mousePos(this._el,t.touches[1]);this._startVec=e.sub(r),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onEnd,!1)}},_onMove:function(t){if(2===t.touches.length){var e=n.mousePos(this._el,t.touches[0]),r=n.mousePos(this._el,t.touches[1]),i=e.add(r).div(2),o=e.sub(r),a=o.mag()/this._startVec.mag(),s=180*o.angleWith(this._startVec)/Math.PI,u=this._map;u.easeTo({zoom:u.transform.scaleZoom(this._startScale*a),bearing:this._startBearing+s,duration:0,around:u.unproject(i)}),t.preventDefault()}},_onEnd:function(){this._map.snapToNorth(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onEnd)}}},{"../../util/dom":102,"../../util/util":110}],92:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer(),a.bindHandlers(this)}var n=t("../../util/dom"),o=t("../../util/browser"),a=t("../../util/util");e.exports=i;var s="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",u=-1!==s.indexOf("firefox"),h=-1!==s.indexOf("safari")&&-1===s.indexOf("chrom");i.prototype={enable:function(){this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1)},disable:function(){this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel)},_onWheel:function(t){var e;"wheel"===t.type?(e=t.deltaY,u&&t.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(e/=o.devicePixelRatio),t.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,h&&(e/=3));var r=(window.performance||Date).now(),i=r-(this._time||0);this._pos=n.mousePos(this._el,t),this._time=r,0!==e&&e%4.000244140625===0?(this._type="wheel",e=Math.floor(e/4)):0!==e&&Math.abs(e)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(i*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&this._zoom(-e),t.preventDefault()},_onTimeout:function(){this._type="wheel",this._zoom(-this._lastValue)},_zoom:function(t){var e=this._map,r=2/(1+Math.exp(-Math.abs(t/100)));0>t&&0!==r&&(r=1/r);var i=e.ease?e.ease.to:e.transform.scale,n=e.transform.scaleZoom(i*r);e.zoomTo(n,{duration:0,around:e.unproject(this._pos)})}}},{"../../util/browser":99,"../../util/dom":102,"../../util/util":110}],93:[function(t,e,r){"use strict";function i(){n.bindAll(["_onHashChange","_updateHash"],this)}e.exports=i;var n=t("../util/util");i.prototype={addTo:function(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},remove:function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},_onHashChange:function(){var t=location.hash.replace("#","").split("/");return t.length>=3?(this._map.jumpTo({center:[+t[1],+t[2]],zoom:+t[0],bearing:+(t[3]||0)}),!0):!1},_updateHash:function(){var t=this._map.getCenter(),e=this._map.getZoom(),r=this._map.getBearing(),i=Math.max(0,Math.ceil(Math.log(e)/Math.LN2)),n="#"+Math.round(100*e)/100+"/"+t.lat.toFixed(i)+"/"+t.lng.toFixed(i)+(r?"/"+Math.round(10*r)/10:"");window.history.replaceState("","",n)}}},{"../util/util":110}],94:[function(t,e,r){"use strict";function i(t){this._map=t,this._el=t.getCanvasContainer();for(var e in n)t[e]=new n[e](t);a.bindHandlers(this)}var n={scrollZoom:t("./handler/scroll_zoom"),boxZoom:t("./handler/box_zoom"),dragRotate:t("./handler/drag_rotate"),dragPan:t("./handler/drag_pan"),keyboard:t("./handler/keyboard"),doubleClickZoom:t("./handler/dblclick_zoom"),pinch:t("./handler/pinch")},o=t("../util/dom"),a=t("../util/util");e.exports=i,i.prototype={enable:function(){var t=this._map.options,e=this._el;for(var r in n)t[r]&&this._map[r].enable();e.addEventListener("mousedown",this._onMouseDown,!1),e.addEventListener("touchstart",this._onTouchStart,!1),e.addEventListener("click",this._onClick,!1),e.addEventListener("mousemove",this._onMouseMove,!1),e.addEventListener("dblclick",this._onDblClick,!1)},disable:function(){var t=this._map.options,e=this._el;for(var r in n)t[r]&&this._map[r].disable();e.removeEventListener("mousedown",this._onMouseDown),e.removeEventListener("touchstart",this._onTouchStart),e.removeEventListener("click",this._onClick),e.removeEventListener("mousemove",this._onMouseMove),e.removeEventListener("dblclick",this._onDblClick)},_onMouseDown:function(t){this._startPos=o.mousePos(this._el,t)},_onTouchStart:function(t){!t.touches||t.touches.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._fireEvent("dblclick",t)):this._tapped=setTimeout(this._onTimeout,300))},_onTimeout:function(){this._tapped=null},_onMouseMove:function(t){var e=this._map,r=this._el;if(!e.dragPan.active&&!e.dragRotate.active){for(var i=t.toElement||t.target;i&&i!==r;)i=i.parentNode;i===r&&this._fireEvent("mousemove",t)}},_onClick:function(t){var e=o.mousePos(this._el,t);e.equals(this._startPos)&&this._fireEvent("click",t)},_onDblClick:function(t){this._fireEvent("dblclick",t),t.preventDefault()},_fireEvent:function(t,e){var r=o.mousePos(this._el,e);this._map.fire(t,{latLng:this._map.unproject(r),point:r,originalEvent:e})}}},{"../util/dom":102,"../util/util":110,"./handler/box_zoom":86,"./handler/dblclick_zoom":87,"./handler/drag_pan":88,"./handler/drag_rotate":89,"./handler/keyboard":90,"./handler/pinch":91,"./handler/scroll_zoom":92}],95:[function(t,e,r){"use strict";var i=t("../util/canvas"),n=t("../util/util"),o=t("../util/browser"),a=t("../util/evented"),s=t("../util/dom"),u=t("../style/style"),h=t("../style/animation_loop"),l=t("../render/painter"),c=t("../geo/transform"),f=t("./hash"),d=t("./interaction"),p=t("./camera"),m=t("../geo/lat_lng"),v=t("../geo/lat_lng_bounds"),_=t("point-geometry"),g=t("./control/attribution"),y=e.exports=function(t){if(t=this.options=n.inherit(this.options,t),this.animationLoop=new h,this.transform=new c(t.minZoom,t.maxZoom),t.maxBounds){var e=v.convert(t.maxBounds);this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform.lngRange=[e.getWest(),e.getEast()]}n.bindAll(["_forwardStyleEvent","_forwardSourceEvent","_forwardLayerEvent","_forwardTileEvent","_onStyleLoad","_onStyleChange","_onSourceAdd","_onSourceRemove","_onSourceUpdate","update","render"],this),
this._setupContainer(),this._setupPainter(),this.on("move",this.update),this.on("zoom",this.update.bind(this,!0)),this.on("moveend",function(){this.animationLoop.set(300),this._rerender()}.bind(this)),"undefined"!=typeof window&&window.addEventListener("resize",function(){this.stop().resize().update()}.bind(this),!1),this.interaction=new d(this),t.interactive&&this.interaction.enable(),this._hash=t.hash&&(new f).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo(t),this.sources={},this.stacks={},this._classes={},this.resize(),t.classes&&this.setClasses(t.classes),t.style&&this.setStyle(t.style),t.attributionControl&&this.addControl(new g)};n.extend(y.prototype,a),n.extend(y.prototype,p.prototype),n.extend(y.prototype,{options:{center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:20,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,pinch:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1},addControl:function(t){return t.addTo(this),this},addClass:function(t,e){this._classes[t]||(this._classes[t]=!0,this.style&&this.style._cascade(this._classes,e))},removeClass:function(t,e){this._classes[t]&&(delete this._classes[t],this.style&&this.style._cascade(this._classes,e))},setClasses:function(t,e){this._classes={};for(var r=0;r<t.length;r++)this._classes[t[r]]=!0;this.style&&this.style._cascade(this._classes,e)},hasClass:function(t){return!!this._classes[t]},getClasses:function(){return Object.keys(this._classes)},resize:function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),this._canvas.resize(t,e),this.transform.width=t,this.transform.height=e,this.transform._constrain(),this.painter.resize(t,e),this.fire("movestart").fire("move").fire("resize").fire("moveend")},getBounds:function(){return new v(this.transform.pointLocation(new _(0,0)),this.transform.pointLocation(this.transform.size))},project:function(t){return this.transform.locationPoint(m.convert(t))},unproject:function(t){return this.transform.pointLocation(_.convert(t))},featuresAt:function(t,e,r){var i=this.transform.pointCoordinate(_.convert(t));return this.style.featuresAt(i,e,r),this},batch:function(t){this.style.batch(t),this.style._cascade(this._classes),this.update(!0)},setStyle:function(t){return this.style&&(this.style.off("load",this._onStyleLoad).off("error",this._forwardStyleEvent).off("change",this._onStyleChange).off("source.add",this._onSourceAdd).off("source.remove",this._onSourceRemove).off("source.load",this._onSourceUpdate).off("source.error",this._forwardSourceEvent).off("source.change",this._onSourceUpdate).off("layer.add",this._forwardLayerEvent).off("layer.remove",this._forwardLayerEvent).off("tile.add",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.load",this.update).off("tile.error",this._forwardTileEvent)._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement)),t?(t instanceof u?this.style=t:this.style=new u(t,this.animationLoop),this.style.on("load",this._onStyleLoad).on("error",this._forwardStyleEvent).on("change",this._onStyleChange).on("source.add",this._onSourceAdd).on("source.remove",this._onSourceRemove).on("source.load",this._onSourceUpdate).on("source.error",this._forwardSourceEvent).on("source.change",this._onSourceUpdate).on("layer.add",this._forwardLayerEvent).on("layer.remove",this._forwardLayerEvent).on("tile.add",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.load",this.update).on("tile.error",this._forwardTileEvent),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this):(this.style=null,this)},addSource:function(t,e){return this.style.addSource(t,e),this},removeSource:function(t){return this.style.removeSource(t),this},getSource:function(t){return this.style.getSource(t)},addLayer:function(t,e){return this.style.addLayer(t,e),this.style._cascade(this._classes),this},removeLayer:function(t){return this.style.removeLayer(t),this.style._cascade(this._classes),this},setFilter:function(t,e){return this.style.setFilter(t,e),this},setLayerZoomRange:function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this},getFilter:function(t){return this.style.getFilter(t)},setPaintProperty:function(t,e,r,i){return this.style.setPaintProperty(t,e,r,i),this.style._cascade(this._classes),this.update(!0),this},getPaintProperty:function(t,e,r){return this.style.getPaintProperty(t,e,r)},setLayoutProperty:function(t,e,r){return this.style.setLayoutProperty(t,e,r),this},getLayoutProperty:function(t,e){return this.style.getLayoutProperty(t,e)},getContainer:function(){return this._container},getCanvasContainer:function(){return this._canvasContainer},getCanvas:function(){return this._canvas.getElement()},_setupContainer:function(){var t=this.options.container,e=this._container="string"==typeof t?document.getElementById(t):t;e.classList.add("mapboxgl-map");var r=this._canvasContainer=s.create("div","mapboxgl-canvas-container",e);this.options.interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=new i(this,r);var n=s.create("div","mapboxgl-control-container",e),o=this._controlCorners={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=s.create("div","mapboxgl-ctrl-"+t,n)})},_setupPainter:function(){var t=this._canvas.getWebGLContext({failIfMajorPerformanceCaveat:this.options.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.options.preserveDrawingBuffer});return t?void(this.painter=new l(t,this.transform)):void console.error("Failed to initialize WebGL")},_contextLost:function(t){t.preventDefault(),this._frameId&&o.cancelFrame(this._frameId)},_contextRestored:function(){this._setupPainter(),this.resize(),this.update()},loaded:function(){return this._styleDirty||this._sourcesDirty?!1:this.style&&!this.style.loaded()?!1:!0},update:function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},render:function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&!this._sourcesDirtyTimeout&&(this._sourcesDirty=!1,this._sourcesDirtyTimeout=setTimeout(function(){this._sourcesDirtyTimeout=null}.bind(this),50),this.style._updateSources(this.transform)),this.painter.render(this.style,{debug:this.debug,vertices:this.vertices,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||!this.animationLoop.stopped())&&this._rerender(),this},remove:function(){return this._hash&&this._hash.remove(),o.cancelFrame(this._frameId),clearTimeout(this._sourcesDirtyTimeout),this.setStyle(null),this},_rerender:function(){this.style&&!this._frameId&&(this._frameId=o.frame(this.render))},_forwardStyleEvent:function(t){this.fire("style."+t.type,n.extend({style:t.target},t))},_forwardSourceEvent:function(t){this.fire(t.type,n.extend({style:t.target},t))},_forwardLayerEvent:function(t){this.fire(t.type,n.extend({style:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,n.extend({style:t.target},t))},_onStyleLoad:function(t){this.style._cascade(this._classes,{transition:!1}),this._forwardStyleEvent(t)},_onStyleChange:function(t){this.update(!0),this._forwardStyleEvent(t)},_onSourceAdd:function(t){var e=t.source;e.onAdd&&e.onAdd(this),this._forwardSourceEvent(t)},_onSourceRemove:function(t){var e=t.source;e.onRemove&&e.onRemove(this),this._forwardSourceEvent(t)},_onSourceUpdate:function(t){this.update(),this._forwardSourceEvent(t)}}),n.extendAll(y.prototype,{_debug:!1,get debug(){return this._debug},set debug(t){this._debug=t,this.update()},_collisionDebug:!1,get collisionDebug(){return this._collisionDebug},set collisionDebug(t){this._collisionDebug=t;for(var e in this.style.sources)this.style.sources[e].reload();this.update()},_repaint:!1,get repaint(){return this._repaint},set repaint(t){this._repaint=t,this.update()},_vertices:!1,get vertices(){return this._vertices},set vertices(t){this._vertices=t,this.update()}})},{"../geo/lat_lng":25,"../geo/lat_lng_bounds":26,"../geo/transform":27,"../render/painter":41,"../style/animation_loop":54,"../style/style":59,"../util/browser":99,"../util/canvas":100,"../util/dom":102,"../util/evented":104,"../util/util":110,"./camera":82,"./control/attribution":83,"./hash":93,"./interaction":94,"point-geometry":137}],96:[function(t,e,r){"use strict";function i(t){n.setOptions(this,t),n.bindAll(["_updatePosition","_onClickClose"],this)}e.exports=i;var n=t("../util/util"),o=t("../util/evented"),a=t("../util/dom"),s=t("../geo/lat_lng");i.prototype=n.inherit(o,{options:{closeButton:!0,closeOnClick:!0},addTo:function(t){return this._map=t,this._map.on("move",this._updatePosition),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},remove:function(){return this._container&&this._container.parentNode.removeChild(this._container),this._map&&(this._map.off("move",this._updatePosition),this._map.off("click",this._onClickClose),delete this._map),this},getLatLng:function(){return this._latLng},setLatLng:function(t){return this._latLng=s.convert(t),this._update(),this},setText:function(t){return this._content=document.createTextNode(t),this._updateContent(),this},setHTML:function(t){this._content=document.createDocumentFragment();var e,r=document.createElement("body");for(r.innerHTML=t;;){if(e=r.firstChild,!e)break;this._content.appendChild(e)}return this._updateContent(),this},_update:function(){this._map&&(this._container||(this._container=a.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=a.create("div","mapboxgl-popup-tip",this._container),this._wrapper=a.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=a.create("button","mapboxgl-popup-close-button",this._wrapper),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))),this._updateContent(),this._updatePosition())},_updateContent:function(){if(this._content&&this._container){for(var t=this._wrapper;t.hasChildNodes();)t.removeChild(t.firstChild);this.options.closeButton&&t.appendChild(this._closeButton),t.appendChild(this._content)}},_updatePosition:function(){if(this._latLng&&this._container){var t=this._map.project(this._latLng).round(),e=this.options.anchor;if(!e){var r=this._container.offsetWidth,i=this._container.offsetHeight;e=t.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<r/2?e.push("left"):t.x>this._map.transform.width-r/2&&e.push("right"),e=0===e.length?"bottom":e.join("-"),this.options.anchor=e}var n={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},o=this._container.classList;for(var s in n)o.remove("mapboxgl-popup-anchor-"+s);o.add("mapboxgl-popup-anchor-"+e),a.setTransform(this._container,n[e]+" translate("+t.x+"px,"+t.y+"px)")}},_onClickClose:function(){this.remove()}})},{"../geo/lat_lng":25,"../util/dom":102,"../util/evented":104,"../util/util":110}],97:[function(t,e,r){"use strict";function i(t,e){this.target=t,this.parent=e,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)}e.exports=i,i.prototype.receive=function(t){var e,r=t.data;if("<response>"===r.type)e=this.callbacks[r.id],delete this.callbacks[r.id],e(r.error||null,r.data);else if("undefined"!=typeof r.id){var i=r.id;this.parent[r.type](r.data,function(t,e,r){this.postMessage({type:"<response>",id:String(i),error:t?String(t):null,data:e},r)}.bind(this))}else this.parent[r.type](r.data)},i.prototype.send=function(t,e,r,i){var n=null;r&&(this.callbacks[n=this.callbackID++]=r),this.postMessage({type:t,id:String(n),data:e},i)},i.prototype.postMessage=function(t,e){try{this.target.postMessage(t,e)}catch(r){this.target.postMessage(t)}}},{}],98:[function(t,e,r){"use strict";function i(t){var e=document.createElement("a");return e.href=t,e.protocol===document.location.protocol&&e.host===document.location.host}r.getJSON=function(t,e){var r=new XMLHttpRequest;return r.open("GET",t,!0),r.onerror=function(t){e(t)},r.onload=function(){if(r.status>=200&&r.status<300&&r.response){var t;try{t=JSON.parse(r.response)}catch(i){return e(i)}e(null,t)}else e(new Error(r.statusText))},r.send(),r},r.getArrayBuffer=function(t,e){var r=new XMLHttpRequest;return r.open("GET",t,!0),r.responseType="arraybuffer",r.onerror=function(t){e(t)},r.onload=function(){r.status>=200&&r.status<300&&r.response?e(null,r.response):e(new Error(r.statusText))},r.send(),r},r.getImage=function(t,e){var r=new Image;return i(t)||(r.crossOrigin="Anonymous"),r.onload=function(){e(null,r)},r.src=t,r.getData=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=r.width,t.height=r.height,e.drawImage(r,0,0),e.getImageData(0,0,r.width,r.height).data},r},r.getVideo=function(t,e){var r=document.createElement("video");r.onloadstart=function(){e(null,r)};for(var n=0;n<t.length;n++){var o=document.createElement("source");i(t[n])||(r.crossOrigin="Anonymous"),o.src=t[n],r.appendChild(o)}return r.getData=function(){return r},r}},{}],99:[function(t,e,r){"use strict";var i=t("./canvas"),n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;r.frame=function(t){return n(t)};var o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;r.cancelFrame=function(t){o(t)},r.timed=function(t,e,i){function n(s){o||(window.performance||(s=Date.now()),s>=a+e?t.call(i,1):(t.call(i,(s-a)/e),r.frame(n)))}if(!e)return t.call(i,1),null;var o=!1,a=window.performance?window.performance.now():Date.now();return r.frame(n),function(){o=!0}},r.supported=function(t){for(var e=([function(){return"undefined"!=typeof window},function(){return"undefined"!=typeof document},function(){return!!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)},function(){return!(!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions))},function(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON},function(){return(new i).supportsWebGLContext(t&&t.failIfMajorPerformanceCaveat||!1)},function(){return"Worker"in window}]),r=0;r<e.length;r++)if(!e[r]())return!1;return!0},r.hardwareConcurrency=navigator.hardwareConcurrency||8,Object.defineProperty(r,"devicePixelRatio",{get:function(){return window.devicePixelRatio}})},{"./canvas":100}],100:[function(t,e,r){"use strict";function i(t,e){this.canvas=document.createElement("canvas"),t&&e&&(this.canvas.style.position="absolute",this.canvas.classList.add("mapboxgl-canvas"),this.canvas.addEventListener("webglcontextlost",t._contextLost.bind(t),!1),this.canvas.addEventListener("webglcontextrestored",t._contextRestored.bind(t),!1),this.canvas.setAttribute("tabindex",0),e.appendChild(this.canvas))}var n=t("../util");e.exports=i,i.prototype.resize=function(t,e){var r=window.devicePixelRatio||1;this.canvas.width=r*t,this.canvas.height=r*e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"};var o={antialias:!1,alpha:!0,stencil:!0,depth:!1};i.prototype.getWebGLContext=function(t){return t=n.extend({},t,o),this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t)},i.prototype.supportsWebGLContext=function(t){var e=n.extend({failIfMajorPerformanceCaveat:t},o);return"probablySupportsContext"in this.canvas?this.canvas.probablySupportsContext("webgl",e)||this.canvas.probablySupportsContext("experimental-webgl",e):"supportsContext"in this.canvas?this.canvas.supportsContext("webgl",e)||this.canvas.supportsContext("experimental-webgl",e):!!window.WebGLRenderingContext&&!!this.getWebGLContext(t)},i.prototype.getElement=function(){return this.canvas}},{"../util":110}],101:[function(t,e,r){"use strict";function i(e,r){this.actors=[],this.currentActor=0;for(var i=0;e>i;i++){var a=new o(t("../../source/worker")),s=new n(a,r);s.name="Worker "+i,this.actors.push(s)}}var n=t("../actor"),o=t("webworkify");e.exports=i,i.prototype={broadcast:function(t,e){for(var r=0;r<this.actors.length;r++)this.actors[r].send(t,e)},send:function(t,e,r,i,n){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[i].send(t,e,r,n),i},remove:function(){for(var t=0;t<this.actors.length;t++)this.actors[t].target.terminate();this.actors=[]}}},{"../../source/worker":52,"../actor":97,webworkify:145}],102:[function(t,e,r){"use strict";function i(t){for(var e=0;e<t.length;e++)if(t[e]in s)return t[e]}function n(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",n,!0)}var o=t("point-geometry");r.create=function(t,e,r){var i=document.createElement(t);return e&&(i.className=e),r&&r.appendChild(i),i};var a,s=document.documentElement.style,u=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){u&&(a=s[u],s[u]="none")},r.enableDrag=function(){u&&(s[u]=a)};var h=i(["transform","WebkitTransform"]);r.setTransform=function(t,e){t.style[h]=e},r.suppressClick=function(){window.addEventListener("click",n,!0),window.setTimeout(function(){window.removeEventListener("click",n,!0)},0)},r.mousePos=function(t,e){var r=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new o(e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop)}},{"point-geometry":137}],103:[function(t,e,r){"use strict";e.exports={HTTP_URL:"http://a.tiles.mapbox.com",HTTPS_URL:"https://a.tiles.mapbox.com",FORCE_HTTPS:!0,REQUIRE_ACCESS_TOKEN:!0}},{}],104:[function(t,e,r){"use strict";var i=t("./util"),n={on:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this},off:function(t,e){if(!t)return delete this._events,this;if(!this.listens(t))return this;if(e){var r=this._events[t].indexOf(e);r>=0&&this._events[t].splice(r,1),this._events[t].length||delete this._events[t]}else delete this._events[t];return this},once:function(t,e){var r=function(i){this.off(t,r),e.call(this,i)}.bind(this);return this.on(t,r),this},fire:function(t,e){if(!this.listens(t))return this;e=i.extend({},e),i.extend(e,{type:t,target:this});for(var r=this._events[t].slice(),n=0;n<r.length;n++)r[n].call(this,e);return this},listens:function(t){return!(!this._events||!this._events[t])}};e.exports=n},{"./util":110}],105:[function(t,e,r){"use strict";function i(t,e){this.stacks=t.readFields(n,[],e)}function n(t,e,r){if(1===t){var i=r.readMessage(o,{glyphs:{}});e.push(i)}}function o(t,e,r){if(1===t)e.name=r.readString();else if(2===t)e.range=r.readString();else if(3===t){var i=r.readMessage(a,{});e.glyphs[i.id]=i}}function a(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}e.exports=i},{}],106:[function(t,e,r){"use strict";function i(t,e,r){return t*(1-r)+e*r}e.exports=i,i.number=i,i.vec2=function(t,e,r){return[i(t[0],e[0],r),i(t[1],e[1],r)]},i.color=function(t,e,r){return[i(t[0],e[0],r),i(t[1],e[1],r),i(t[2],e[2],r),i(t[3],e[3],r)]},i.array=function(t,e,r){return t.map(function(t,n){return i(t,e[n],r)})}},{}],107:[function(t,e,r){"use strict";function i(t,e,r){if(r=r||n.ACCESS_TOKEN,!r&&n.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/developers/api/#access-tokens");var i=n.FORCE_HTTPS||"undefined"!=typeof document&&"https:"===document.location.protocol;if(t=t.replace(/^mapbox:\/\//,(i?n.HTTPS_URL:n.HTTP_URL)+e),t+=-1!==t.indexOf("?")?"&access_token=":"?access_token=",n.REQUIRE_ACCESS_TOKEN){if("s"===r[0])throw new Error("Use a public access token (pk.*) with Mapbox GL JS, not a secret access token (sk.*). See https://www.mapbox.com/developers/api/#access-tokens");t+=r}return t}var n=t("./config"),o=t("./browser");e.exports.normalizeStyleURL=function(t,e){var r=t.match(/^mapbox:\/\/([^.]+)/);return r?i(t,"/styles/v1/"+r[1]+"/",e):t},e.exports.normalizeSourceURL=function(t,e){return t.match(/^mapbox:\/\//)?(t=i(t+".json","/v4/",e),0===t.indexOf("https")&&(t+="&secure"),t):t},e.exports.normalizeGlyphsURL=function(t,e){return t.match(/^mapbox:\/\//)?t.match(/^mapbox:\/\/fontstack/)?i(t,"/v4/",e):i(t,"/",e):t},e.exports.normalizeTileURL=function(t,e){return e&&e.match(/^mapbox:\/\//)?t.replace(/\.((?:png|jpg)\d*)(?=$|\?)/,o.devicePixelRatio>=2?"@2x.$1":".$1"):t}},{"./browser":99,"./config":103}],108:[function(t,e,r){"use strict";function i(t,e){this.max=t,this.onRemove=e,this.reset()}e.exports=i,i.prototype.reset=function(){for(var t in this.list)this.onRemove(this.list[t]);return this.list={},this.order=[],this},i.prototype.add=function(t,e){if(this.list[t]=e,this.order.push(t),this.order.length>this.max){var r=this.get(this.order[0]);r&&this.onRemove(r)}return this},i.prototype.has=function(t){return t in this.list},i.prototype.keys=function(){return this.order},i.prototype.get=function(t){if(!this.has(t))return null;var e=this.list[t];return delete this.list[t],this.order.splice(this.order.indexOf(t),1),e}},{}],109:[function(t,e,r){"use strict";function i(t,e){return e.replace(/{([^{}()\[\]<>$=:;.,^]+)}/g,function(e,r){return r in t?t[r]:""})}e.exports=i},{}],110:[function(t,e,r){"use strict";var i=t("unitbezier");r.easeCubicInOut=function(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(.5>t?r:3*(t-e)+r-.75)},r.bezier=function(t,e,r,n){var o=new i(t,e,r,n);return function(t){return o.solve(t)}},r.ease=r.bezier(.25,.1,.25,1),r.premultiply=function(t){return t[0]*=t[3],t[1]*=t[3],t[2]*=t[3],t},r.clamp=function(t,e,r){return Math.min(r,Math.max(e,t))},r.wrap=function(t,e,r){var i=r-e;return t===r?t:((t-e)%i+i)%i+e},r.coalesce=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if(null!==e&&void 0!==e)return e}},r.asyncEach=function(t,e,r){function i(){0===--n&&r()}var n=t.length;if(0===n)return r();for(var o=0;o<t.length;o++)e(t[o],i)},r.keysDifference=function(t,e){var r=[];for(var i in t)i in e||r.push(i);return r},r.extend=function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t},r.extendAll=function(t,e){for(var r in e)Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r));return t},r.inherit=function(t,e){var i="function"==typeof t?t.prototype:t,n=Object.create(i);return r.extendAll(n,e),n},r.pick=function(t,e){for(var r={},i=0;i<e.length;i++){var n=e[i];n in t&&(r[n]=t[n])}return r};var n=1;r.uniqueId=function(){return n++},r.throttle=function(t,e,r){var i,n,o,a;return a=function(){i=!1,n&&(o.apply(r,n),n=!1)},o=function(){i?n=arguments:(t.apply(r,arguments),setTimeout(a,e),i=!0)}},r.debounce=function(t,e){var r,i;return function(){i=arguments,clearTimeout(r),r=setTimeout(function(){t.apply(null,i)},e)}},r.bindAll=function(t,e){t.forEach(function(t){e[t]=e[t].bind(e)})},r.bindHandlers=function(t){for(var e in t)"function"==typeof t[e]&&0===e.indexOf("_on")&&(t[e]=t[e].bind(t))},r.setOptions=function(t,e){t.hasOwnProperty("options")||(t.options=t.options?Object.create(t.options):{});for(var r in e)t.options[r]=e[r];return t.options}},{unitbezier:140}],111:[function(t,e,r){function i(t){return t=Math.round(t),0>t?0:t>255?255:t}function n(t){return 0>t?0:t>1?1:t}function o(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function a(t){return n("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function s(t,e,r){return 0>r?r+=1:r>1&&(r-=1),1>6*r?t+(e-t)*r*6:1>2*r?e:2>3*r?t+(e-t)*(2/3-r)*6:t}function u(t){var e=t.replace(/ /g,"").toLowerCase();if(e in h)return h[e].slice();if("#"===e[0]){if(4===e.length){var r=parseInt(e.substr(1),16);return r>=0&&4095>=r?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null}if(7===e.length){var r=parseInt(e.substr(1),16);return r>=0&&16777215>=r?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null}return null}var n=e.indexOf("("),u=e.indexOf(")");if(-1!==n&&u+1===e.length){var l=e.substr(0,n),c=e.substr(n+1,u-(n+1)).split(","),f=1;switch(l){case"rgba":if(4!==c.length)return null;f=a(c.pop());case"rgb":return 3!==c.length?null:[o(c[0]),o(c[1]),o(c[2]),f];case"hsla":if(4!==c.length)return null;f=a(c.pop());case"hsl":if(3!==c.length)return null;var d=(parseFloat(c[0])%360+360)%360/360,p=a(c[1]),m=a(c[2]),v=.5>=m?m*(p+1):m+p-m*p,_=2*m-v;return[i(255*s(_,v,d+1/3)),i(255*s(_,v,d)),i(255*s(_,v,d-1/3)),f];default:return null}}return null}var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{r.parseCSSColor=u}catch(l){}},{}],112:[function(t,e,r){"use strict";function i(t){return function(e,r,i){return"$type"===r?"t"+t+s.indexOf(i):"p["+JSON.stringify(r)+"]"+t+JSON.stringify(i)}}function n(t){var e=i(t);return function(t,r,i){return"$type"===r?e(t,r,i):"typeof(p["+JSON.stringify(r)+"]) === typeof("+JSON.stringify(i)+") && "+e(t,r,i)}}function o(t){return u[t[0]].apply(t,t)}function a(){return!0}var s=["Unknown","Point","LineString","Polygon"],u={"==":i("==="),"!=":i("!=="),">":n(">"),"<":n("<"),"<=":n("<="),">=":n(">="),"in":function(t,e){return Array.prototype.slice.call(arguments,2).map(function(r){return"("+u["=="](t,e,r)+")"}).join("||")||"false"},"!in":function(){return"!("+u["in"].apply(this,arguments)+")"},any:function(){return Array.prototype.slice.call(arguments,1).map(function(t){return"("+o(t)+")"}).join("||")||"false"},all:function(){return Array.prototype.slice.call(arguments,1).map(function(t){return"("+o(t)+")"}).join("&&")||"true"},none:function(){return"!("+u.any.apply(this,arguments)+")"}};e.exports=function(t){if(!t)return a;var e="var p = f.properties || f.tags || {}, t = f.type; return "+o(t)+";";return new Function("f",e)}},{}],113:[function(t,e,r){"use strict";function i(t,e,r,i,a,s,u,h){if(r/=e,i/=e,u>=r&&i>=h)return t;if(u>i||r>h)return null;for(var l=[],c=0;c<t.length;c++){var f,d,p=t[c],m=p.geometry,v=p.type;if(f=p.min[a],d=p.max[a],f>=r&&i>=d)l.push(p);else if(!(f>i||r>d)){var _=1===v?n(m,r,i,a):o(m,r,i,a,s,3===v);_.length&&l.push({geometry:_,type:v,tags:t[c].tags||null,min:p.min,max:p.max})}}return l.length?l:null}function n(t,e,r,i){for(var n=[],o=0;o<t.length;o++){var a=t[o],s=a[i];s>=e&&r>=s&&n.push(a)}return n}function o(t,e,r,i,n,o){for(var s=[],u=0;u<t.length;u++){var h,l,c,f=0,d=0,p=null,m=t[u],v=m.area,_=m.dist,g=m.length,y=[];for(l=0;g-1>l;l++)h=p||m[l],p=m[l+1],f=d||h[i],d=p[i],e>f?d>r?(y.push(n(h,p,e),n(h,p,r)),o||(y=a(s,y,v,_))):d>=e&&y.push(n(h,p,e)):f>r?e>d?(y.push(n(h,p,r),n(h,p,e)),o||(y=a(s,y,v,_))):r>=d&&y.push(n(h,p,r)):(y.push(h),e>d?(y.push(n(h,p,e)),o||(y=a(s,y,v,_))):d>r&&(y.push(n(h,p,r)),o||(y=a(s,y,v,_))));h=m[g-1],f=h[i],f>=e&&r>=f&&y.push(h),c=y[y.length-1],o&&c&&(y[0][0]!==c[0]||y[0][1]!==c[1])&&y.push(y[0]),a(s,y,v,_)}return s}function a(t,e,r,i){return e.length&&(e.area=r,e.dist=i,t.push(e)),[]}e.exports=i},{}],114:[function(t,e,r){"use strict";function i(t,e){var r=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)n(r,t.features[i],e);else"Feature"===t.type?n(r,t,e):n(r,{geometry:t},e);return r}function n(t,e,r){var i,u,h,l=e.geometry,c=l.type,f=l.coordinates,d=e.properties;if("Point"===c)t.push(o(d,1,[s(f)]));else if("MultiPoint"===c)t.push(o(d,1,a(f)));else if("LineString"===c)t.push(o(d,2,[a(f,r)]));else if("MultiLineString"===c||"Polygon"===c){for(h=[],i=0;i<f.length;i++)h.push(a(f[i],r));t.push(o(d,"Polygon"===c?3:2,h))}else if("MultiPolygon"===c){for(h=[],i=0;i<f.length;i++)for(u=0;u<f[i].length;u++)h.push(a(f[i][u],r));
t.push(o(d,3,h))}else{if("GeometryCollection"!==c)throw new Error("Input data is not a valid GeoJSON object.");for(i=0;i<l.geometries.length;i++)n(t,{geometry:l.geometries[i],properties:d},r)}}function o(t,e,r){var i={geometry:r,type:e,tags:t||null,min:[2,1],max:[-1,0]};return h(i),i}function a(t,e){for(var r=[],i=0;i<t.length;i++)r.push(s(t[i]));return e&&(c(r,e),u(r)),r}function s(t){var e=Math.sin(t[1]*Math.PI/180),r=t[0]/360+.5,i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i=-1>i?-1:i>1?1:i,[r,i,0]}function u(t){for(var e,r,i=0,n=0,o=0;o<t.length-1;o++)e=r||t[o],r=t[o+1],i+=e[0]*r[1]-r[0]*e[1],n+=Math.abs(r[0]-e[0])+Math.abs(r[1]-e[1]);t.area=Math.abs(i/2),t.dist=n}function h(t){var e=t.geometry,r=t.min,i=t.max;if(1===t.type)l(r,i,e);else for(var n=0;n<e.length;n++)l(r,i,e[n]);return t}function l(t,e,r){for(var i,n=0;n<r.length;n++)i=r[n],t[0]=Math.min(i[0],t[0]),e[0]=Math.max(i[0],e[0]),t[1]=Math.min(i[1],t[1]),e[1]=Math.max(i[1],e[1])}e.exports=i;var c=t("./simplify")},{"./simplify":116}],115:[function(t,e,r){"use strict";function i(t,e){return new n(t,e)}function n(t,e){e=this.options=c(Object.create(this.options),e);var r=e.debug;r&&console.time("preprocess data");var i=1<<e.maxZoom,n=f(t,e.tolerance/(i*e.extent));this.tiles={},r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=p(n,e.buffer/e.extent,h),this.splitTile(n,0,0,0),r&&(console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function o(t,e){if(!t||t.transformed)return t;var r,i,n,o=t.z2,s=t.x,u=t.y;for(r=0;r<t.features.length;r++){var h=t.features[r],l=h.geometry,c=h.type;if(1===c)for(i=0;i<l.length;i++)l[i]=a(l[i],e,o,s,u);else for(i=0;i<l.length;i++){var f=l[i];for(n=0;n<f.length;n++)f[n]=a(f[n],e,o,s,u)}}return t.transformed=!0,t}function a(t,e,r,i,n){var o=Math.round(e*(t[0]*r-i)),a=Math.round(e*(t[1]*r-n));return[o,a]}function s(t,e,r){if(1!==t.length)return!1;var i=t[0];if(3!==i.type||i.geometry.length>1)return!1;for(var n=0;n<i.geometry[0].length;n++){var o=i.geometry[0][n];if(o[0]!==-r&&o[0]!==e+r||o[1]!==-r&&o[1]!==e+r)return!1}return!0}function u(t,e,r){return 32*((1<<t)*r+e)+t}function h(t,e,r){return[r,(r-t[0])*(e[1]-t[1])/(e[0]-t[0])+t[1],1]}function l(t,e,r){return[(r-t[1])*(e[0]-t[0])/(e[1]-t[1])+t[0],r,1]}function c(t,e){for(var r in e)t[r]=e[r];return t}e.exports=i;var f=t("./convert"),d=t("./clip"),p=t("./wrap"),m=t("./tile");n.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,debug:0},n.prototype.splitTile=function(t,e,r,i,n,o,a){for(var c=[t,e,r,i],f=this.options,p=f.debug,v=f.extent,_=f.buffer;c.length;){t=c.shift(),e=c.shift(),r=c.shift(),i=c.shift();var g=1<<e,y=u(e,r,i),x=this.tiles[y],b=e===f.maxZoom?0:f.tolerance/(g*v);if(!x&&(p>1&&console.time("creation"),x=this.tiles[y]=m(t,g,r,i,b,e===f.maxZoom),p)){p>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,x.numFeatures,x.numPoints,x.numSimplified),console.timeEnd("creation"));var w="z"+e;this.stats[w]=(this.stats[w]||0)+1,this.total++}if(x.source=t,!s(x.features,v,_)){if(n){if(e===f.maxZoom||e===n)continue;var S=1<<n-e;if(r!==Math.floor(o/S)&&i!==Math.floor(a/S))continue}else if(e===f.indexMaxZoom||x.numPoints<=f.indexMaxPoints)continue;x.source=null,p>1&&console.time("clipping");var M,E,T,z,A,P,I=.5*_/v,L=.5-I,k=.5+I,D=1+I;M=E=T=z=null,A=d(t,g,r-I,r+k,0,h,x.min[0],x.max[0]),P=d(t,g,r+L,r+D,0,h,x.min[0],x.max[0]),A&&(M=d(A,g,i-I,i+k,1,l,x.min[1],x.max[1]),E=d(A,g,i+L,i+D,1,l,x.min[1],x.max[1])),P&&(T=d(P,g,i-I,i+k,1,l,x.min[1],x.max[1]),z=d(P,g,i+L,i+D,1,l,x.min[1],x.max[1])),p>1&&console.timeEnd("clipping"),M&&c.push(M,e+1,2*r,2*i),E&&c.push(E,e+1,2*r,2*i+1),T&&c.push(T,e+1,2*r+1,2*i),z&&c.push(z,e+1,2*r+1,2*i+1)}}},n.prototype.getTile=function(t,e,r){var i=this.options,n=i.extent,a=i.debug,h=1<<t;e=(e%h+h)%h;var l=u(t,e,r);if(this.tiles[l])return o(this.tiles[l],n);a>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var c,f=t,d=e,p=r;!c&&f>0;)f--,d=Math.floor(d/2),p=Math.floor(p/2),c=this.tiles[u(f,d,p)];if(a>1&&console.log("found parent tile z%d-%d-%d",f,d,p),c.source){if(s(c.features,i.extent,i.buffer))return o(c,n);a>1&&console.time("drilling down"),this.splitTile(c.source,f,d,p,t,e,r),a>1&&console.timeEnd("drilling down")}return o(this.tiles[l],n)}},{"./clip":113,"./convert":114,"./tile":117,"./wrap":118}],116:[function(t,e,r){"use strict";function i(t,e){var r,i,o,a,s=e*e,u=t.length,h=0,l=u-1,c=[];for(t[h][2]=1,t[l][2]=1;l;){for(i=0,r=h+1;l>r;r++)o=n(t[r],t[h],t[l]),o>i&&(a=r,i=o);i>s?(t[a][2]=i,c.push(h),c.push(a),h=a):(l=c.pop(),h=c.pop())}}function n(t,e,r){var i=e[0],n=e[1],o=r[0],a=r[1],s=t[0],u=t[1],h=o-i,l=a-n;if(0!==h||0!==l){var c=((s-i)*h+(u-n)*l)/(h*h+l*l);c>1?(i=o,n=a):c>0&&(i+=h*c,n+=l*c)}return h=s-i,l=u-n,h*h+l*l}e.exports=i},{}],117:[function(t,e,r){"use strict";function i(t,e,r,i,o,a){for(var s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z2:e,transformed:!1,min:[2,1],max:[-1,0]},u=0;u<t.length;u++){s.numFeatures++,n(s,t[u],o,a);var h=t[u].min,l=t[u].max;h[0]<s.min[0]&&(s.min[0]=h[0]),h[1]<s.min[1]&&(s.min[1]=h[1]),l[0]>s.max[0]&&(s.max[0]=l[0]),l[1]>s.max[1]&&(s.max[1]=l[1])}return s}function n(t,e,r,i){var n,o,a,s,u=e.geometry,h=e.type,l=[],c=r*r;if(1===h)for(n=0;n<u.length;n++)l.push(u[n]),t.numPoints++,t.numSimplified++;else for(n=0;n<u.length;n++)if(a=u[n],i||!(2===h&&a.dist<r||3===h&&a.area<c)){var f=[];for(o=0;o<a.length;o++)s=a[o],(i||s[2]>c)&&(f.push(s),t.numSimplified++),t.numPoints++;l.push(f)}else t.numPoints+=a.length;l.length&&t.features.push({geometry:l,type:h,tags:e.tags||null})}e.exports=i},{}],118:[function(t,e,r){"use strict";function i(t,e,r){var i=t,o=a(t,1,-1-e,e,0,r,-1,2),s=a(t,1,1-e,2+e,0,r,-1,2);return(o||s)&&(i=a(t,1,-e,1+e,0,r,-1,2),o&&(i=n(o,1).concat(i)),s&&(i=i.concat(n(s,-1)))),i}function n(t,e){for(var r=[],i=0;i<t.length;i++){var n,a=t[i],s=a.type;if(1===s)n=o(a.geometry,e);else{n=[];for(var u=0;u<a.geometry.length;u++)n.push(o(a.geometry[u],e))}r.push({geometry:n,type:s,tags:a.tags,min:[a.min[0]+e,a.min[1]],max:[a.max[0]+e,a.max[1]]})}return r}function o(t,e){var r=[];r.area=t.area,r.dist=t.dist;for(var i=0;i<t.length;i++)r.push([t[i][0]+e,t[i][1],t[i][2]]);return r}var a=t("./clip");e.exports=i},{"./clip":113}],119:[function(t,e,r){r.glMatrix=t("./gl-matrix/common.js"),r.mat2=t("./gl-matrix/mat2.js"),r.mat2d=t("./gl-matrix/mat2d.js"),r.mat3=t("./gl-matrix/mat3.js"),r.mat4=t("./gl-matrix/mat4.js"),r.quat=t("./gl-matrix/quat.js"),r.vec2=t("./gl-matrix/vec2.js"),r.vec3=t("./gl-matrix/vec3.js"),r.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":120,"./gl-matrix/mat2.js":121,"./gl-matrix/mat2d.js":122,"./gl-matrix/mat3.js":123,"./gl-matrix/mat4.js":124,"./gl-matrix/quat.js":125,"./gl-matrix/vec2.js":126,"./gl-matrix/vec3.js":127,"./gl-matrix/vec4.js":128}],120:[function(t,e,r){var i={};i.EPSILON=1e-6,i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var n=Math.PI/180;i.toRadian=function(t){return t*n},e.exports=i},{}],121:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},n.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=r*o-n*i;return a?(a=1/a,t[0]=o*a,t[1]=-i*a,t[2]=-n*a,t[3]=r*a,t):null},n.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},n.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},n.multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=r[0],u=r[1],h=r[2],l=r[3];return t[0]=i*s+o*u,t[1]=n*s+a*u,t[2]=i*h+o*l,t[3]=n*h+a*l,t},n.mul=n.multiply,n.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=i*u+o*s,t[1]=n*u+a*s,t[2]=i*-s+o*u,t[3]=n*-s+a*u,t},n.scale=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=r[0],u=r[1];return t[0]=i*s,t[1]=n*s,t[2]=o*u,t[3]=a*u,t},n.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},n.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},n.LDU=function(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]},e.exports=n},{"./common.js":120}],122:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.clone=function(t){var e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=r*o-i*n;return u?(u=1/u,t[0]=o*u,t[1]=-i*u,t[2]=-n*u,t[3]=r*u,t[4]=(n*s-o*a)*u,t[5]=(i*a-r*s)*u,t):null},n.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},n.multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=r[0],l=r[1],c=r[2],f=r[3],d=r[4],p=r[5];return t[0]=i*h+o*l,t[1]=n*h+a*l,t[2]=i*c+o*f,t[3]=n*c+a*f,t[4]=i*d+o*p+s,t[5]=n*d+a*p+u,t},n.mul=n.multiply,n.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=Math.sin(r),l=Math.cos(r);return t[0]=i*l+o*h,t[1]=n*l+a*h,t[2]=i*-h+o*l,t[3]=n*-h+a*l,t[4]=s,t[5]=u,t},n.scale=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=r[0],l=r[1];return t[0]=i*h,t[1]=n*h,t[2]=o*l,t[3]=a*l,t[4]=s,t[5]=u,t},n.translate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=r[0],l=r[1];return t[0]=i,t[1]=n,t[2]=o,t[3]=a,t[4]=i*h+o*l+s,t[5]=n*h+a*l+u,t},n.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},n.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.exports=n},{"./common.js":120}],123:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},n.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},n.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],h=e[7],l=e[8],c=l*a-s*h,f=-l*o+s*u,d=h*o-a*u,p=r*c+i*f+n*d;return p?(p=1/p,t[0]=c*p,t[1]=(-l*i+n*h)*p,t[2]=(s*i-n*a)*p,t[3]=f*p,t[4]=(l*r-n*u)*p,t[5]=(-s*r+n*o)*p,t[6]=d*p,t[7]=(-h*r+i*u)*p,t[8]=(a*r-i*o)*p,t):null},n.adjoint=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],h=e[7],l=e[8];return t[0]=a*l-s*h,t[1]=n*h-i*l,t[2]=i*s-n*a,t[3]=s*u-o*l,t[4]=r*l-n*u,t[5]=n*o-r*s,t[6]=o*h-a*u,t[7]=i*u-r*h,t[8]=r*a-i*o,t},n.determinant=function(t){var e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],a=t[5],s=t[6],u=t[7],h=t[8];return e*(h*o-a*u)+r*(-h*n+a*s)+i*(u*n-o*s)},n.multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=e[6],l=e[7],c=e[8],f=r[0],d=r[1],p=r[2],m=r[3],v=r[4],_=r[5],g=r[6],y=r[7],x=r[8];return t[0]=f*i+d*a+p*h,t[1]=f*n+d*s+p*l,t[2]=f*o+d*u+p*c,t[3]=m*i+v*a+_*h,t[4]=m*n+v*s+_*l,t[5]=m*o+v*u+_*c,t[6]=g*i+y*a+x*h,t[7]=g*n+y*s+x*l,t[8]=g*o+y*u+x*c,t},n.mul=n.multiply,n.translate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=e[6],l=e[7],c=e[8],f=r[0],d=r[1];return t[0]=i,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*i+d*a+h,t[7]=f*n+d*s+l,t[8]=f*o+d*u+c,t},n.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=e[6],l=e[7],c=e[8],f=Math.sin(r),d=Math.cos(r);return t[0]=d*i+f*a,t[1]=d*n+f*s,t[2]=d*o+f*u,t[3]=d*a-f*i,t[4]=d*s-f*n,t[5]=d*u-f*o,t[6]=h,t[7]=l,t[8]=c,t},n.scale=function(t,e,r){var i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},n.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},n.fromQuat=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=r+r,s=i+i,u=n+n,h=r*a,l=i*a,c=i*s,f=n*a,d=n*s,p=n*u,m=o*a,v=o*s,_=o*u;return t[0]=1-c-p,t[3]=l-_,t[6]=f+v,t[1]=l+_,t[4]=1-h-p,t[7]=d-m,t[2]=f-v,t[5]=d+m,t[8]=1-h-c,t},n.normalFromMat4=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],h=e[7],l=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],_=e[15],g=r*s-i*a,y=r*u-n*a,x=r*h-o*a,b=i*u-n*s,w=i*h-o*s,S=n*h-o*u,M=l*m-c*p,E=l*v-f*p,T=l*_-d*p,z=c*v-f*m,A=c*_-d*m,P=f*_-d*v,I=g*P-y*A+x*z+b*T-w*E+S*M;return I?(I=1/I,t[0]=(s*P-u*A+h*z)*I,t[1]=(u*T-a*P-h*E)*I,t[2]=(a*A-s*T+h*M)*I,t[3]=(n*A-i*P-o*z)*I,t[4]=(r*P-n*T+o*E)*I,t[5]=(i*T-r*A-o*M)*I,t[6]=(m*S-v*w+_*b)*I,t[7]=(v*x-p*S-_*y)*I,t[8]=(p*w-m*x+_*g)*I,t):null},n.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.exports=n},{"./common.js":120}],124:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.clone=function(t){var e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],n=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=n,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},n.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],h=e[7],l=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],_=e[15],g=r*s-i*a,y=r*u-n*a,x=r*h-o*a,b=i*u-n*s,w=i*h-o*s,S=n*h-o*u,M=l*m-c*p,E=l*v-f*p,T=l*_-d*p,z=c*v-f*m,A=c*_-d*m,P=f*_-d*v,I=g*P-y*A+x*z+b*T-w*E+S*M;return I?(I=1/I,t[0]=(s*P-u*A+h*z)*I,t[1]=(n*A-i*P-o*z)*I,t[2]=(m*S-v*w+_*b)*I,t[3]=(f*w-c*S-d*b)*I,t[4]=(u*T-a*P-h*E)*I,t[5]=(r*P-n*T+o*E)*I,t[6]=(v*x-p*S-_*y)*I,t[7]=(l*S-f*x+d*y)*I,t[8]=(a*A-s*T+h*M)*I,t[9]=(i*T-r*A-o*M)*I,t[10]=(p*w-m*x+_*g)*I,t[11]=(c*x-l*w-d*g)*I,t[12]=(s*E-a*z-u*M)*I,t[13]=(r*z-i*E+n*M)*I,t[14]=(m*y-p*b-v*g)*I,t[15]=(l*b-c*y+f*g)*I,t):null},n.adjoint=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],h=e[7],l=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],_=e[15];return t[0]=s*(f*_-d*v)-c*(u*_-h*v)+m*(u*d-h*f),t[1]=-(i*(f*_-d*v)-c*(n*_-o*v)+m*(n*d-o*f)),t[2]=i*(u*_-h*v)-s*(n*_-o*v)+m*(n*h-o*u),t[3]=-(i*(u*d-h*f)-s*(n*d-o*f)+c*(n*h-o*u)),t[4]=-(a*(f*_-d*v)-l*(u*_-h*v)+p*(u*d-h*f)),t[5]=r*(f*_-d*v)-l*(n*_-o*v)+p*(n*d-o*f),t[6]=-(r*(u*_-h*v)-a*(n*_-o*v)+p*(n*h-o*u)),t[7]=r*(u*d-h*f)-a*(n*d-o*f)+l*(n*h-o*u),t[8]=a*(c*_-d*m)-l*(s*_-h*m)+p*(s*d-h*c),t[9]=-(r*(c*_-d*m)-l*(i*_-o*m)+p*(i*d-o*c)),t[10]=r*(s*_-h*m)-a*(i*_-o*m)+p*(i*h-o*s),t[11]=-(r*(s*d-h*c)-a*(i*d-o*c)+l*(i*h-o*s)),t[12]=-(a*(c*v-f*m)-l*(s*v-u*m)+p*(s*f-u*c)),t[13]=r*(c*v-f*m)-l*(i*v-n*m)+p*(i*f-n*c),t[14]=-(r*(s*v-u*m)-a*(i*v-n*m)+p*(i*u-n*s)),t[15]=r*(s*f-u*c)-a*(i*f-n*c)+l*(i*u-n*s),t},n.determinant=function(t){var e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],a=t[5],s=t[6],u=t[7],h=t[8],l=t[9],c=t[10],f=t[11],d=t[12],p=t[13],m=t[14],v=t[15],_=e*a-r*o,g=e*s-i*o,y=e*u-n*o,x=r*s-i*a,b=r*u-n*a,w=i*u-n*s,S=h*p-l*d,M=h*m-c*d,E=h*v-f*d,T=l*m-c*p,z=l*v-f*p,A=c*v-f*m;return _*A-g*z+y*T+x*E-b*M+w*S},n.multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=e[6],l=e[7],c=e[8],f=e[9],d=e[10],p=e[11],m=e[12],v=e[13],_=e[14],g=e[15],y=r[0],x=r[1],b=r[2],w=r[3];return t[0]=y*i+x*s+b*c+w*m,t[1]=y*n+x*u+b*f+w*v,t[2]=y*o+x*h+b*d+w*_,t[3]=y*a+x*l+b*p+w*g,y=r[4],x=r[5],b=r[6],w=r[7],t[4]=y*i+x*s+b*c+w*m,t[5]=y*n+x*u+b*f+w*v,t[6]=y*o+x*h+b*d+w*_,t[7]=y*a+x*l+b*p+w*g,y=r[8],x=r[9],b=r[10],w=r[11],t[8]=y*i+x*s+b*c+w*m,t[9]=y*n+x*u+b*f+w*v,t[10]=y*o+x*h+b*d+w*_,t[11]=y*a+x*l+b*p+w*g,y=r[12],x=r[13],b=r[14],w=r[15],t[12]=y*i+x*s+b*c+w*m,t[13]=y*n+x*u+b*f+w*v,t[14]=y*o+x*h+b*d+w*_,t[15]=y*a+x*l+b*p+w*g,t},n.mul=n.multiply,n.translate=function(t,e,r){var i,n,o,a,s,u,h,l,c,f,d,p,m=r[0],v=r[1],_=r[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*_+e[12],t[13]=e[1]*m+e[5]*v+e[9]*_+e[13],t[14]=e[2]*m+e[6]*v+e[10]*_+e[14],t[15]=e[3]*m+e[7]*v+e[11]*_+e[15]):(i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],h=e[6],l=e[7],c=e[8],f=e[9],d=e[10],p=e[11],t[0]=i,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h,t[7]=l,t[8]=c,t[9]=f,t[10]=d,t[11]=p,t[12]=i*m+s*v+c*_+e[12],t[13]=n*m+u*v+f*_+e[13],t[14]=o*m+h*v+d*_+e[14],t[15]=a*m+l*v+p*_+e[15]),t},n.scale=function(t,e,r){var i=r[0],n=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.rotate=function(t,e,r,n){var o,a,s,u,h,l,c,f,d,p,m,v,_,g,y,x,b,w,S,M,E,T,z,A,P=n[0],I=n[1],L=n[2],k=Math.sqrt(P*P+I*I+L*L);return Math.abs(k)<i.EPSILON?null:(k=1/k,P*=k,I*=k,L*=k,o=Math.sin(r),a=Math.cos(r),s=1-a,u=e[0],h=e[1],l=e[2],c=e[3],f=e[4],d=e[5],p=e[6],m=e[7],v=e[8],_=e[9],g=e[10],y=e[11],x=P*P*s+a,b=I*P*s+L*o,w=L*P*s-I*o,S=P*I*s-L*o,M=I*I*s+a,E=L*I*s+P*o,T=P*L*s+I*o,z=I*L*s-P*o,A=L*L*s+a,t[0]=u*x+f*b+v*w,t[1]=h*x+d*b+_*w,t[2]=l*x+p*b+g*w,t[3]=c*x+m*b+y*w,t[4]=u*S+f*M+v*E,t[5]=h*S+d*M+_*E,t[6]=l*S+p*M+g*E,t[7]=c*S+m*M+y*E,t[8]=u*T+f*z+v*A,t[9]=h*T+d*z+_*A,t[10]=l*T+p*z+g*A,t[11]=c*T+m*z+y*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},n.rotateX=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[4],a=e[5],s=e[6],u=e[7],h=e[8],l=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+h*i,t[5]=a*n+l*i,t[6]=s*n+c*i,t[7]=u*n+f*i,t[8]=h*n-o*i,t[9]=l*n-a*i,t[10]=c*n-s*i,t[11]=f*n-u*i,t},n.rotateY=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[0],a=e[1],s=e[2],u=e[3],h=e[8],l=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-h*i,t[1]=a*n-l*i,t[2]=s*n-c*i,t[3]=u*n-f*i,t[8]=o*i+h*n,t[9]=a*i+l*n,t[10]=s*i+c*n,t[11]=u*i+f*n,t},n.rotateZ=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[0],a=e[1],s=e[2],u=e[3],h=e[4],l=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+h*i,t[1]=a*n+l*i,t[2]=s*n+c*i,t[3]=u*n+f*i,t[4]=h*n-o*i,t[5]=l*n-a*i,t[6]=c*n-s*i,t[7]=f*n-u*i,t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotation=function(t,e,r){var n,o,a,s=r[0],u=r[1],h=r[2],l=Math.sqrt(s*s+u*u+h*h);return Math.abs(l)<i.EPSILON?null:(l=1/l,s*=l,u*=l,h*=l,n=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+h*n,t[2]=h*s*a-u*n,t[3]=0,t[4]=s*u*a-h*n,t[5]=u*u*a+o,t[6]=h*u*a+s*n,t[7]=0,t[8]=s*h*a+u*n,t[9]=u*h*a-s*n,t[10]=h*h*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},n.fromXRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromYRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromZRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotationTranslation=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=i+i,u=n+n,h=o+o,l=i*s,c=i*u,f=i*h,d=n*u,p=n*h,m=o*h,v=a*s,_=a*u,g=a*h;return t[0]=1-(d+m),t[1]=c+g,t[2]=f-_,t[3]=0,t[4]=c-g,t[5]=1-(l+m),t[6]=p+v,t[7]=0,t[8]=f+_,t[9]=p-v,t[10]=1-(l+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},n.fromRotationTranslationScale=function(t,e,r,i){var n=e[0],o=e[1],a=e[2],s=e[3],u=n+n,h=o+o,l=a+a,c=n*u,f=n*h,d=n*l,p=o*h,m=o*l,v=a*l,_=s*u,g=s*h,y=s*l,x=i[0],b=i[1],w=i[2];return t[0]=(1-(p+v))*x,t[1]=(f+y)*x,t[2]=(d-g)*x,t[3]=0,t[4]=(f-y)*b,t[5]=(1-(c+v))*b,t[6]=(m+_)*b,t[7]=0,t[8]=(d+g)*w,t[9]=(m-_)*w,t[10]=(1-(c+p))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},n.fromRotationTranslationScaleOrigin=function(t,e,r,i,n){var o=e[0],a=e[1],s=e[2],u=e[3],h=o+o,l=a+a,c=s+s,f=o*h,d=o*l,p=o*c,m=a*l,v=a*c,_=s*c,g=u*h,y=u*l,x=u*c,b=i[0],w=i[1],S=i[2],M=n[0],E=n[1],T=n[2];return t[0]=(1-(m+_))*b,t[1]=(d+x)*b,t[2]=(p-y)*b,t[3]=0,t[4]=(d-x)*w,t[5]=(1-(f+_))*w,t[6]=(v+g)*w,t[7]=0,t[8]=(p+y)*S,t[9]=(v-g)*S,t[10]=(1-(f+m))*S,t[11]=0,t[12]=r[0]+M-(t[0]*M+t[4]*E+t[8]*T),t[13]=r[1]+E-(t[1]*M+t[5]*E+t[9]*T),t[14]=r[2]+T-(t[2]*M+t[6]*E+t[10]*T),t[15]=1,t},n.fromQuat=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=r+r,s=i+i,u=n+n,h=r*a,l=i*a,c=i*s,f=n*a,d=n*s,p=n*u,m=o*a,v=o*s,_=o*u;return t[0]=1-c-p,t[1]=l+_,t[2]=f-v,t[3]=0,t[4]=l-_,t[5]=1-h-p,t[6]=d+m,t[7]=0,t[8]=f+v,t[9]=d-m,t[10]=1-h-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.frustum=function(t,e,r,i,n,o,a){var s=1/(r-e),u=1/(n-i),h=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(n+i)*u,t[10]=(a+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*h,t[15]=0,t},n.perspective=function(t,e,r,i,n){var o=1/Math.tan(e/2),a=1/(i-n);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*i*a,t[15]=0,t},n.perspectiveFromFieldOfView=function(t,e,r,i){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),h=2/(n+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-((a-s)*u*.5),t[9]=(n-o)*h*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t},n.ortho=function(t,e,r,i,n,o,a){var s=1/(e-r),u=1/(i-n),h=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*s,t[13]=(n+i)*u,t[14]=(a+o)*h,t[15]=1,t},n.lookAt=function(t,e,r,o){var a,s,u,h,l,c,f,d,p,m,v=e[0],_=e[1],g=e[2],y=o[0],x=o[1],b=o[2],w=r[0],S=r[1],M=r[2];return Math.abs(v-w)<i.EPSILON&&Math.abs(_-S)<i.EPSILON&&Math.abs(g-M)<i.EPSILON?n.identity(t):(f=v-w,d=_-S,p=g-M,m=1/Math.sqrt(f*f+d*d+p*p),f*=m,d*=m,p*=m,a=x*p-b*d,s=b*f-y*p,u=y*d-x*f,m=Math.sqrt(a*a+s*s+u*u),m?(m=1/m,a*=m,s*=m,u*=m):(a=0,s=0,u=0),h=d*u-p*s,l=p*a-f*u,c=f*s-d*a,m=Math.sqrt(h*h+l*l+c*c),m?(m=1/m,h*=m,l*=m,c*=m):(h=0,l=0,c=0),t[0]=a,t[1]=h,t[2]=f,t[3]=0,t[4]=s,t[5]=l,t[6]=d,t[7]=0,t[8]=u,t[9]=c,t[10]=p,t[11]=0,t[12]=-(a*v+s*_+u*g),t[13]=-(h*v+l*_+c*g),t[14]=-(f*v+d*_+p*g),t[15]=1,t)},n.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.exports=n},{"./common.js":120}],125:[function(t,e,r){var i=t("./common.js"),n=t("./mat3.js"),o=t("./vec3.js"),a=t("./vec4.js"),s={};s.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(i,n,a){var u=o.dot(n,a);return-.999999>u?(o.cross(t,e,n),o.length(t)<1e-6&&o.cross(t,r,n),o.normalize(t,t),s.setAxisAngle(i,t,Math.PI),i):u>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(o.cross(t,n,a),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+u,s.normalize(i,i))}}(),s.setAxes=function(){var t=n.create();return function(e,r,i,n){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,r){r=.5*r;var i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t},s.add=a.add,s.multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=r[0],u=r[1],h=r[2],l=r[3];return t[0]=i*l+a*s+n*h-o*u,t[1]=n*l+a*u+o*s-i*h,t[2]=o*l+a*h+i*u-n*s,t[3]=a*l-i*s-n*u-o*h,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=i*u+a*s,t[1]=n*u+o*s,t[2]=o*u-n*s,t[3]=a*u-i*s,t},s.rotateY=function(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=i*u-o*s,t[1]=n*u+a*s,t[2]=o*u+i*s,t[3]=a*u-n*s,t},s.rotateZ=function(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=i*u+n*s,t[1]=n*u-i*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},s.calculateW=function(t,e){var r=e[0],i=e[1],n=e[2];return t[0]=r,t[1]=i,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,r,i){var n,o,a,s,u,h=e[0],l=e[1],c=e[2],f=e[3],d=r[0],p=r[1],m=r[2],v=r[3];return o=h*d+l*p+c*m+f*v,0>o&&(o=-o,d=-d,p=-p,m=-m,v=-v),1-o>1e-6?(n=Math.acos(o),a=Math.sin(n),s=Math.sin((1-i)*n)/a,u=Math.sin(i*n)/a):(s=1-i,u=i),t[0]=s*h+u*d,t[1]=s*l+u*p,t[2]=s*c+u*m,t[3]=s*f+u*v,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(r,i,n,o,a,u){return s.slerp(t,i,a,u),s.slerp(e,n,o,u),s.slerp(r,t,e,2*u*(1-u)),r}}(),s.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=r*r+i*i+n*n+o*o,s=a?1/a:0;return t[0]=-r*s,t[1]=-i*s,t[2]=-n*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var r,i=e[0]+e[4]+e[8];if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var o=(n+1)%3,a=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*a+a]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+a]-e[3*a+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[a]=(e[3*a+n]+e[3*n+a])*r}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=s},{"./common.js":120,"./mat3.js":123,"./vec3.js":127,"./vec4.js":128}],126:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},n.clone=function(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},n.fromValues=function(t,e){var r=new i.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},n.set=function(t,e,r){return t[0]=e,t[1]=r,t},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},n.sub=n.subtract,n.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},n.mul=n.multiply,n.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},n.div=n.divide,n.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},n.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},n.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},n.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t},n.distance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)},n.dist=n.distance,n.squaredDistance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},n.len=n.length,n.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},n.normalize=function(t,e){var r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},n.cross=function(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t},n.lerp=function(t,e,r,i){var n=e[0],o=e[1];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t},n.random=function(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},n.transformMat2=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t},n.transformMat2d=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t},n.transformMat3=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t},n.transformMat4=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t},n.forEach=function(){var t=n.create();return function(e,r,i,n,o,a){var s,u;for(r||(r=2),i||(i=0),u=n?Math.min(n*r+i,e.length):e.length,s=i;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exports=n},{"./common.js":120}],127:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},n.clone=function(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},n.fromValues=function(t,e,r){var n=new i.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},n.set=function(t,e,r,i){return t[0]=e,
t[1]=r,t[2]=i,t},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},n.sub=n.subtract,n.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},n.mul=n.multiply,n.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},n.div=n.divide,n.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},n.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},n.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},n.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t},n.distance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+i*i+n*n)},n.dist=n.distance,n.squaredDistance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)},n.len=n.length,n.squaredLength=function(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},n.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],o=r*r+i*i+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},n.cross=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=r[0],s=r[1],u=r[2];return t[0]=n*u-o*s,t[1]=o*a-i*u,t[2]=i*s-n*a,t},n.lerp=function(t,e,r,i){var n=e[0],o=e[1],a=e[2];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=a+i*(r[2]-a),t},n.hermite=function(t,e,r,i,n,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,h=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*s+r[0]*u+i[0]*h+n[0]*l,t[1]=e[1]*s+r[1]*u+i[1]*h+n[1]*l,t[2]=e[2]*s+r[2]*u+i[2]*h+n[2]*l,t},n.bezier=function(t,e,r,i,n,o){var a=1-o,s=a*a,u=o*o,h=s*a,l=3*o*s,c=3*u*a,f=u*o;return t[0]=e[0]*h+r[0]*l+i[0]*c+n[0]*f,t[1]=e[1]*h+r[1]*l+i[1]*c+n[1]*f,t[2]=e[2]*h+r[2]*l+i[2]*c+n[2]*f,t},n.random=function(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI,n=2*i.RANDOM()-1,o=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*e,t},n.transformMat4=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=r[3]*i+r[7]*n+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*i+r[4]*n+r[8]*o+r[12])/a,t[1]=(r[1]*i+r[5]*n+r[9]*o+r[13])/a,t[2]=(r[2]*i+r[6]*n+r[10]*o+r[14])/a,t},n.transformMat3=function(t,e,r){var i=e[0],n=e[1],o=e[2];return t[0]=i*r[0]+n*r[3]+o*r[6],t[1]=i*r[1]+n*r[4]+o*r[7],t[2]=i*r[2]+n*r[5]+o*r[8],t},n.transformQuat=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=r[0],s=r[1],u=r[2],h=r[3],l=h*i+s*o-u*n,c=h*n+u*i-a*o,f=h*o+a*n-s*i,d=-a*i-s*n-u*o;return t[0]=l*h+d*-a+c*-u-f*-s,t[1]=c*h+d*-s+f*-a-l*-u,t[2]=f*h+d*-u+l*-s-c*-a,t},n.rotateX=function(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),o[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.rotateY=function(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),o[1]=n[1],o[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.rotateZ=function(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),o[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.forEach=function(){var t=n.create();return function(e,r,i,n,o,a){var s,u;for(r||(r=3),i||(i=0),u=n?Math.min(n*r+i,e.length):e.length,s=i;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),n.angle=function(t,e){var r=n.fromValues(t[0],t[1],t[2]),i=n.fromValues(e[0],e[1],e[2]);n.normalize(r,r),n.normalize(i,i);var o=n.dot(r,i);return o>1?0:Math.acos(o)},n.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exports=n},{"./common.js":120}],128:[function(t,e,r){var i=t("./common.js"),n={};n.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},n.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.fromValues=function(t,e,r,n){var o=new i.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.set=function(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},n.sub=n.subtract,n.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},n.mul=n.multiply,n.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},n.div=n.divide,n.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},n.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},n.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},n.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},n.distance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+i*i+n*n+o*o)},n.dist=n.distance,n.squaredDistance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return r*r+i*i+n*n+o*o},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],r=t[1],i=t[2],n=t[3];return Math.sqrt(e*e+r*r+i*i+n*n)},n.len=n.length,n.squaredLength=function(t){var e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},n.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=r*r+i*i+n*n+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=i*a,t[2]=n*a,t[3]=o*a),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},n.lerp=function(t,e,r,i){var n=e[0],o=e[1],a=e[2],s=e[3];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=a+i*(r[2]-a),t[3]=s+i*(r[3]-s),t},n.random=function(t,e){return e=e||1,t[0]=i.RANDOM(),t[1]=i.RANDOM(),t[2]=i.RANDOM(),t[3]=i.RANDOM(),n.normalize(t,t),n.scale(t,t,e),t},n.transformMat4=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*a,t[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*a,t[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*a,t[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*a,t},n.transformQuat=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=r[0],s=r[1],u=r[2],h=r[3],l=h*i+s*o-u*n,c=h*n+u*i-a*o,f=h*o+a*n-s*i,d=-a*i-s*n-u*o;return t[0]=l*h+d*-a+c*-u-f*-s,t[1]=c*h+d*-s+f*-a-l*-u,t[2]=f*h+d*-u+l*-s-c*-a,t[3]=e[3],t},n.forEach=function(){var t=n.create();return function(e,r,i,n,o,a){var s,u;for(r||(r=4),i||(i=0),u=n?Math.min(n*r+i,e.length):e.length,s=i;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),n.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=n},{"./common.js":120}],129:[function(t,e,r){"use strict";function i(t){return function(){return t}}function n(t,e,r){return t*(1-r)+e*r}function o(t,e,r){for(var i=[],o=0;o<t.length;o++)i[o]=n(t[o],e[o],r);return i}r.interpolated=function(t){if(!t.stops)return i(t);var e=t.stops,r=t.base||1,a=Array.isArray(e[0][1])?o:n;return function(t){for(var i,n,o=0;o<e.length;o++){var s=e[o];if(s[0]<=t&&(i=s),s[0]>t){n=s;break}}if(i&&n){var u=n[0]-i[0],h=t-i[0],l=1===r?h/u:(Math.pow(r,h)-1)/(Math.pow(r,u)-1);return a(i[1],n[1],l)}return i?i[1]:n?n[1]:void 0}},r["piecewise-constant"]=function(t){if(!t.stops)return i(t);var e=t.stops;return function(t){for(var r=0;r<e.length;r++)if(e[r][0]>t)return e[0===r?0:r-1][1];return e[e.length-1][1]}}},{}],130:[function(t,e,r){"use strict";var i=t("../../reference/latest.js"),n=t("./parsed");e.exports=function(t){return n(t,i)}},{"../../reference/latest.js":132,"./parsed":131}],131:[function(t,e,r){"use strict";function i(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function n(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}var o=t("csscolorparser").parseCSSColor,a=t("util").format;e.exports=function(t,e){function r(t,e){var r={message:(t?t+": ":"")+a.apply(a,Array.prototype.slice.call(arguments,2))};null!==e&&void 0!==e&&e.__line__&&(r.line=e.__line__),c.push(r)}function s(t,n,o){var a=i(n);if("string"===a&&"@"===n[0]){if(!(n in h))return r(t,n,'constant "%s" not found',n);n=h[n],a=i(n)}if(o["function"]&&"object"===a)return s["function"](t,n,o);if(o.type){var u=s[o.type];if(u)return u(t,n,o);o=e[o.type]}s.object(t,n,o)}function u(t){return function(e,n,o){var a=i(n);a!==t&&r(e,n,"%s expected, %s found",t,a),"minimum"in o&&n<o.minimum&&r(e,n,"%s is less than the minimum value %s",n,o.minimum),"maximum"in o&&n>o.maximum&&r(e,n,"%s is greater than the maximum value %s",n,o.maximum)}}var h=t.constants||{},l={},c=[];return s.constants=function(t,e){var n=i(e);if("object"!==n)return r(t,e,"object expected, %s found",n);for(var o in e)"@"!==o[0]&&r(t+"."+o,e[o],'constants must start with "@"')},s.source=function(t,i){if(!i.type)return void r(t,i,'"type" is required');var o=n(i.type);switch(o){case"vector":case"raster":if(s.object(t,i,e.source_tile),"url"in i)for(var a in i)["type","url","tileSize"].indexOf(a)<0&&r(t+"."+a,i[a],'a source with a "url" property may not include a "%s" property',a);break;case"geojson":s.object(t,i,e.source_geojson);break;case"video":s.object(t,i,e.source_video);break;default:s["enum"](t+".type",i.type,{values:["vector","raster","geojson","video"]})}},s.layer=function(i,o){o.type||o.ref||r(i,o,'either "type" or "ref" is required');var a=n(o.type),u=n(o.ref);if(o.id&&(l[o.id]?r(i,o.id,'duplicate layer id "%s", previously used at line %d',o.id,l[o.id]):l[o.id]=o.id.__line__),"ref"in o){["type","source","source-layer","filter","layout"].forEach(function(t){t in o&&r(i,o[t],'"%s" is prohibited for ref layers',t)});var h;t.layers.forEach(function(t){t.id==u&&(h=t)}),h?h.ref?r(i,o.ref,"ref cannot reference another ref layer"):a=h.type:r(i,o.ref,'ref layer "%s" not found',u)}else if("background"!==a)if(o.source){var c=t.sources[o.source];c?"vector"==c.type&&"raster"==a?r(i,o.source,'layer "%s" requires a raster source',o.id):"raster"==c.type&&"raster"!=a&&r(i,o.source,'layer "%s" requires a vector source',o.id):r(i,o.source,'source "%s" not found',o.source)}else r(i,o,'missing required property "source"');s.object(i,o,e.layer,{filter:s.filter,layout:function(t,r){var i=e["layout_"+a];return a&&i&&s(t,r,i)},paint:function(t,r){var i=e["paint_"+a];return a&&i&&s(t,r,i)}})},s.object=function(t,n,o,a){a=a||{};var u=i(n);if("object"!==u)return r(t,n,"object expected, %s found",u);for(var h in n){var l=h.split(".")[0],c=o[l]||o["*"],f=l.match(/^(.*)-transition$/);c?(a[l]||s)((t?t+".":t)+h,n[h],c):f&&o[f[1]]&&o[f[1]].transition?s((t?t+".":t)+h,n[h],e.transition):""!==t&&1!==t.split(".").length&&r(t,n[h],'unknown property "%s"',h)}for(var d in o)o[d].required&&void 0===o[d]["default"]&&void 0===n[d]&&r(t,n,'missing required property "%s"',d)},s.array=function(e,n,o,a){if("array"!==i(n))return r(e,n,"array expected, %s found",i(n));if(o.length&&n.length!==o.length)return r(e,n,"array length %d expected, length %d found",o.length,n.length);var u={type:o.value};t.version<7&&(u["function"]=o["function"]),"object"===i(o.value)&&(u=o.value);for(var h=0;h<n.length;h++)(a||s)(e+"["+h+"]",n[h],u)},s.filter=function(t,o){var a;if("array"!==i(o))return r(t,o,"array expected, %s found",i(o));if(o.length<1)return r(t,o,"filter array must have at least 1 element");switch(s["enum"](t+"[0]",o[0],e.filter_operator),n(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"==o[1]&&r(t,o,'"$type" cannot be use with operator "%s"',o[0]);case"==":case"!=":3!=o.length&&r(t,o,'filter array for operator "%s" must have 3 elements',o[0]);case"in":case"!in":o.length>=2&&(a=i(o[1]),"string"!==a?r(t+"[1]",o[1],"string expected, %s found",a):"@"===o[1][0]&&r(t+"[1]",o[1],"filter key cannot be a constant"));for(var u=2;u<o.length;u++)a=i(o[u]),"$type"==o[1]?s["enum"](t+"["+u+"]",o[u],e.geometry_type):"string"===a&&"@"===o[u][0]?r(t+"["+u+"]",o[u],"filter value cannot be a constant"):"string"!==a&&"number"!==a&&"boolean"!==a&&r(t+"["+u+"]",o[u],"string, number, or boolean expected, %s found",a);break;case"any":case"all":case"none":for(u=1;u<o.length;u++)s.filter(t+"["+u+"]",o[u])}},s["function"]=function(t,n,o){s.object(t,n,e["function"],{stops:function(t,e,n){var a=-(1/0);s.array(t,e,n,function(t,e){return"array"!==i(e)?r(t,e,"array expected, %s found",i(e)):2!==e.length?r(t,e,"array length %d expected, length %d found",2,e.length):(s(t+"[0]",e[0],{type:"number"}),s(t+"[1]",e[1],o),void("number"===i(e[0])&&("piecewise-constant"===o["function"]&&e[0]%1!==0&&r(t+"[0]",e[0],"zoom level for piecewise-constant functions must be an integer"),e[0]<a&&r(t+"[0]",e[0],"array stops must appear in ascending order"),a=e[0])))}),"array"===i(e)&&0===e.length&&r(t,e,"array must have at least one stop")}})},s["enum"]=function(t,e,i){-1===i.values.indexOf(n(e))&&r(t,e,"expected one of [%s], %s found",i.values.join(", "),e)},s.color=function(t,e){var n=i(e);"string"!==n?r(t,e,"color expected, %s found",n):null===o(e)&&r(t,e,'color expected, "%s" found',e)},s.number=u("number"),s.string=u("string"),s["boolean"]=u("boolean"),s["*"]=function(){},s("",t,e.$root),c}},{csscolorparser:111,util:5}],132:[function(t,e,r){e.exports=t("./v7.json")},{"./v7.json":133}],133:[function(t,e,r){e.exports={$version:7,$root:{version:{required:!0,type:"enum",values:[7],doc:"Stylesheet version number. Must be 7."},name:{type:"string",doc:"A human-readable name for the style."},constants:{type:"constants",doc:"An object of constants to be referenced in layers."},sources:{required:!0,type:"sources",doc:"Data source specifications."},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended."},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. Valid tokens are {fontstack} and {range}."},transition:{type:"transition",doc:"A global transition definition to use as a default across properties."},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array."}},constants:{"*":{type:"*",doc:"A constant that will be replaced verbatim in the referencing place. This can be anything, including objects and arrays. All variable names must be prefixed with an `@` symbol."}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For GeoJSON and video sources, a URL must be provided."}},source:["source_tile","source_geojson","source_video"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"],doc:"The data type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number","default":0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number","default":22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number","default":512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"]},data:{type:"*"}},source_video:{type:{required:!0,type:"enum",values:["video"]},url:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",doc:"Unique layer name."},type:{type:"enum",values:["fill","line","symbol","raster","background"],doc:"Rendering type of this layer."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{type:"number",minimum:0,maximum:22,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:22,doc:"The maximum zoom level on which the layer gets parsed and appears on."},interactive:{type:"boolean",doc:"Enable querying of feature data from this layer for interactivity.","default":!1},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"Class-specific paint properties for this layer. The class name is the part after the first dot."}},layout:["layout_fill","layout_line","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_fill:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_line:{"line-cap":{type:"enum","function":"piecewise-constant",values:["butt","round","square"],"default":"butt",doc:"The display of line endings."},"line-join":{type:"enum","function":"piecewise-constant",values:["bevel","round","miter"],"default":"miter",doc:"The display of lines when joining."},"line-miter-limit":{type:"number","default":2,"function":"interpolated",doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number","default":1,"function":"interpolated",doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}]},visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant",values:["point","line"],"default":"point",doc:"Label placement relative to its geometry. `line` can only be used on LineStrings and Polygons."},"symbol-min-distance":{type:"number","default":250,minimum:1,"function":"interpolated",units:"pixels",doc:"Minimum distance between two symbol anchors.",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer."},"icon-allow-overlap":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the icon will be visible even if it collides with other icons and text.",requires:["icon-image"]},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the icon won't affect placement of other icons and text.",requires:["icon-image"]},"icon-optional":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the symbol will appear without its icon, in spaces where the icon would make it too large to fit.",requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"viewport",doc:"Orientation of icon when map is rotated.",requires:["icon-image"]},"icon-max-size":{type:"number","default":1,minimum:0,"function":"interpolated",doc:"The maximum factor to scale the icon.",requires:["icon-image"]},"icon-image":{type:"string","function":"piecewise-constant",doc:"A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated",units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"]},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated",units:"pixels",doc:"Padding value around icon bounding box to avoid icon collisions.",requires:["icon-image"]},"icon-keep-upright":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down",requires:["icon-image",{"icon-rotation-alignment":"map"}]},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",doc:"Icon's offset distance. Values are [x, y] where negatives indicate left and up, respectively.",requires:["icon-image"]},"text-rotation-alignment":{type:"enum","function":"piecewise-constant",values:["map","viewport"],"default":"viewport",doc:"Orientation of icon or text when map is rotated.",requires:["text-field"]},"text-field":{type:"string","function":"piecewise-constant","default":"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}."},"text-font":{type:"string","function":"piecewise-constant","default":"Open Sans Regular, Arial Unicode MS Regular",doc:"Font stack to use for displaying text.",requires:["text-field"]},"text-max-size":{type:"number","default":16,minimum:0,units:"pixels","function":"interpolated",doc:"The maximum size text will be laid out, to calculate collisions with.",requires:["text-field"]},"text-max-width":{type:"number","default":15,minimum:0,units:"em","function":"interpolated",doc:"The maximum line width for text wrapping.",requires:["text-field"]},"text-line-height":{type:"number","default":1.2,units:"em","function":"interpolated",doc:"Text leading value for multi-line text.",requires:["text-field"]},"text-letter-spacing":{type:"number","default":0,units:"em","function":"interpolated",doc:"Text kerning value.",requires:["text-field"]},"text-justify":{type:"enum","function":"piecewise-constant",values:["left","center","right"],"default":"center",doc:"Text justification options.",requires:["text-field"]},"text-anchor":{type:"enum","function":"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],"default":"center",doc:"Which part of the text to place closest to the anchor.",requires:["text-field"]},"text-max-angle":{type:"number","default":45,units:"degrees","function":"interpolated",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"piecewise-constant",doc:"Rotates the text clockwise.",requires:["text-field"]},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated",doc:"Padding value around text bounding box to avoid label collisions.",requires:["text-field"]},"text-keep-upright":{type:"boolean","function":"piecewise-constant","default":!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"}]},"text-transform":{type:"enum","function":"piecewise-constant",values:["none","uppercase","lowercase"],"default":"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"]},"text-offset":{type:"array",doc:"Specifies the distance that text is offset from its anchor horizontally and vertically.",value:"number",units:"ems","function":"interpolated",length:2,"default":[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the text will be visible even if it collides with other icons and labels.",requires:["text-field"]},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the text won't affect placement of other icons and labels.",requires:["text-field"]},"text-optional":{type:"boolean","function":"piecewise-constant","default":!1,doc:"If true, the symbol will appear without its text, in spaces where the text would make it too large to fit.",requires:["text-field","icon-image"]},visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},layout_raster:{visibility:{type:"enum","function":"piecewise-constant",values:["visible","none"],"default":"visible",doc:"The display of this layer. `none` hides this layer."}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"]},geometry_type:{type:"enum",values:["Point","LineString","Polygon"]},"function":{stops:{type:"array",required:!0,doc:"An array of stops.",value:"function_stop"},base:{type:"number","default":1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},paint:["paint_fill","paint_line","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","default":!0,doc:"Whether or not the fill should be antialiased."},"fill-opacity":{type:"number","function":"interpolated","default":1,minimum:0,maximum:1,doc:"The opacity given to the fill color.",transition:!0},"fill-color":{type:"color","default":"#000000",doc:"The color of the fill.","function":"interpolated",transition:!0,requires:[{"!":"fill-image"}]},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.","function":"interpolated",transition:!0,requires:[{"!":"fill-image"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"fill-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["fill-translate"]},"fill-image":{type:"string","function":"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image fills."}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.","function":"interpolated","default":1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",doc:"The color with which the line will be drawn.","default":"#000000","function":"interpolated",transition:!0,requires:[{"!":"line-image"}]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"line-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["line-translate"]},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Stroke thickness."},"line-gap-width":{type:"number","default":0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.","function":"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels."},"line-dasharray":{type:"array","function":"piecewise-constant",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-image"}]},"line-image":{type:"string","function":"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image lines."}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0,requires:["icon-image"]},"icon-size":{type:"number","default":1,"function":"interpolated",transition:!0,doc:"Scale factor for icon. 1 is original size, 3 triples the size.",requires:["icon-image"]},"icon-color":{type:"color","default":"#000000","function":"interpolated",transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"]},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"An icon's offset distance. Values are [x, y] where negatives indicate left and up, respectively.",requires:["icon-image"]},"icon-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0,requires:["text-field"]},"text-size":{type:"number","default":16,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Font size. If unspecified, the text will be as big as allowed by the layer definition.",requires:["text-field"]},"text-color":{type:"color",doc:"The color with which the text will be drawn.","default":"#000000","function":"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"]},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"]
},"text-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated",transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",transition:!0,units:"pixels",doc:"Label offset. Values are [x, y] where negatives indicate left and up, respectively.",requires:["text-field"]},"text-translate-anchor":{type:"enum","function":"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)","default":"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.","default":1,minimum:0,maximum:1,"function":"interpolated",transition:!0},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated",transition:!0,units:"degrees",doc:"Rotates hues around the color wheel."},"raster-brightness-min":{type:"number","function":"interpolated",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.","default":0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number","function":"interpolated",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.","default":1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated",transition:!0},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.","default":0,minimum:-1,maximum:1,"function":"interpolated",transition:!0},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated",transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added."}},paint_background:{"background-color":{type:"color","default":"#000000",doc:"The color with which the background will be drawn.","function":"interpolated",transition:!0,requires:[{"!":"background-image"}]},"background-image":{type:"string","function":"piecewise-constant",transition:!0,doc:"Optionally an image which is drawn as the background."},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.","function":"interpolated",transition:!0}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number","default":0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],134:[function(t,e,r){"use strict";function i(t){var e;t&&t.length&&(e=t,t=e.length);var r=new Uint8Array(t||0);return e&&r.set(e),r.readUInt32LE=o.readUInt32LE,r.writeUInt32LE=o.writeUInt32LE,r.readInt32LE=o.readInt32LE,r.writeInt32LE=o.writeInt32LE,r.readFloatLE=o.readFloatLE,r.writeFloatLE=o.writeFloatLE,r.readDoubleLE=o.readDoubleLE,r.writeDoubleLE=o.writeDoubleLE,r.toString=o.toString,r.write=o.write,r.slice=o.slice,r.copy=o.copy,r._isBuffer=!0,r}function n(t){for(var e,r,i=t.length,n=[],o=0;i>o;o++){if(e=t.charCodeAt(o),e>55295&&57344>e){if(!r){e>56319||o+1===i?n.push(239,191,189):r=e;continue}if(56320>e){n.push(239,191,189),r=e;continue}e=r-55296<<10|e-56320|65536,r=null}else r&&(n.push(239,191,189),r=null);128>e?n.push(e):2048>e?n.push(e>>6|192,63&e|128):65536>e?n.push(e>>12|224,e>>6&63|128,63&e|128):n.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}return n}e.exports=i;var o,a,s,u=t("ieee754");o={readUInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},writeUInt32LE:function(t,e){this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24},readInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+(this[t+3]<<24)},readFloatLE:function(t){return u.read(this,t,!0,23,4)},readDoubleLE:function(t){return u.read(this,t,!0,52,8)},writeFloatLE:function(t,e){return u.write(this,t,e,!0,23,4)},writeDoubleLE:function(t,e){return u.write(this,t,e,!0,52,8)},toString:function(t,e,r){var i="",n="";e=e||0,r=Math.min(this.length,r||this.length);for(var o=e;r>o;o++){var a=this[o];127>=a?(i+=decodeURIComponent(n)+String.fromCharCode(a),n=""):n+="%"+a.toString(16)}return i+=decodeURIComponent(n)},write:function(t,e){for(var r=t===a?s:n(t),i=0;i<r.length;i++)this[e+i]=r[i]},slice:function(t,e){return this.subarray(t,e)},copy:function(t,e){e=e||0;for(var r=0;r<this.length;r++)t[e+r]=this[r]}},o.writeInt32LE=o.writeUInt32LE,i.byteLength=function(t){return a=t,s=n(t),s.length},i.isBuffer=function(t){return!(!t||!t._isBuffer)}},{ieee754:136}],135:[function(t,e,r){(function(r){"use strict";function i(t){this.buf=d.isBuffer(t)?t:new d(t||0),this.pos=0,this.length=this.buf.length}function n(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function o(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function a(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function s(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function u(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function h(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function l(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function c(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function f(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}e.exports=i;var d=r.Buffer||t("./buffer");i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var p=4294967296,m=1/p,v=Math.pow(2,63);i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;t(n,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=this.buf.readUInt32LE(this.pos);return this.pos+=4,t},readSFixed32:function(){var t=this.buf.readInt32LE(this.pos);return this.pos+=4,t},readFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+this.buf.readUInt32LE(this.pos+4)*p;return this.pos+=8,t},readSFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+this.buf.readInt32LE(this.pos+4)*p;return this.pos+=8,t},readFloat:function(){var t=this.buf.readFloatLE(this.pos);return this.pos+=4,t},readDouble:function(){var t=this.buf.readDoubleLE(this.pos);return this.pos+=8,t},readVarint:function(){var t,e,r,i,n,o,a=this.buf;if(r=a[this.pos++],128>r)return r;if(r=127&r,i=a[this.pos++],128>i)return r|i<<7;if(i=(127&i)<<7,n=a[this.pos++],128>n)return r|i|n<<14;if(n=(127&n)<<14,o=a[this.pos++],128>o)return r|i|n|o<<21;if(t=r|i|n|(127&o)<<21,e=a[this.pos++],t+=268435456*(127&e),128>e)return t;if(e=a[this.pos++],t+=34359738368*(127&e),128>e)return t;if(e=a[this.pos++],t+=4398046511104*(127&e),128>e)return t;if(e=a[this.pos++],t+=562949953421312*(127&e),128>e)return t;if(e=a[this.pos++],t+=72057594037927940*(127&e),128>e)return t;if(e=a[this.pos++],t+=0x8000000000000000*(127&e),128>e)return t;throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){var t=this.pos,e=this.readVarint();if(v>e)return e;for(var r=this.pos-2;255===this.buf[r];)r--;t>r&&(r=t),e=0;for(var i=0;r-t+1>i;i++){var n=127&~this.buf[t+i];e+=4>i?n<<7*i:n*Math.pow(2,7*i)}return-e-1},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.buf.toString("utf8",this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.slice(this.pos,t);return this.pos=t,e},readPackedVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readVarint());return e},readPackedSVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new d(e);this.buf.copy(r),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(t){this.realloc(4),this.buf.writeUInt32LE(t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),this.buf.writeInt32LE(t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeUInt32LE(Math.floor(t*m),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeInt32LE(Math.floor(t*m),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t,127>=t)this.realloc(1),this.buf[this.pos++]=t;else if(16383>=t)this.realloc(2),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127;else if(2097151>=t)this.realloc(3),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127;else if(268435455>=t)this.realloc(4),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127|128,this.buf[this.pos++]=t>>>21&127;else{for(var e=this.pos;t>=128;)this.realloc(1),this.buf[this.pos++]=255&t|128,t/=128;if(this.realloc(1),this.buf[this.pos++]=0|t,this.pos-e>10)throw new Error("Given varint doesn't fit into 10 bytes")}},writeSVarint:function(t){this.writeVarint(0>t?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t);var e=d.byteLength(t);this.writeVarint(e),this.realloc(e),this.buf.write(t,this.pos),this.pos+=e},writeFloat:function(t){this.realloc(4),this.buf.writeFloatLE(t,this.pos),this.pos+=4},writeDouble:function(t){this.realloc(8),this.buf.writeDoubleLE(t,this.pos),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;e>r;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r,n=127>=i?1:16383>=i?2:2097151>=i?3:268435455>=i?4:Math.ceil(Math.log(i)/(7*Math.LN2));if(n>1){this.realloc(n-1);for(var o=this.pos-1;o>=r;o--)this.buf[o+n-1]=this.buf[o]}this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,i.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,n,e)},writePackedSVarint:function(t,e){this.writeMessage(t,o,e)},writePackedBoolean:function(t,e){this.writeMessage(t,u,e)},writePackedFloat:function(t,e){this.writeMessage(t,a,e)},writePackedDouble:function(t,e){this.writeMessage(t,s,e)},writePackedFixed32:function(t,e){this.writeMessage(t,h,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,l,e)},writePackedFixed64:function(t,e){this.writeMessage(t,c,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,f,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":134}],136:[function(t,e,r){r.read=function(t,e,r,i,n){var o,a,s=8*n-i-1,u=(1<<s)-1,h=u>>1,l=-7,c=r?n-1:0,f=r?-1:1,d=t[e+c];for(c+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+t[e+c],c+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=i;l>0;a=256*a+t[e+c],c+=f,l-=8);if(0===o)o=1-h;else{if(o===u)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,i),o-=h}return(d?-1:1)*a*Math.pow(2,o-i)},r.write=function(t,e,r,i,n,o){var a,s,u,h=8*o-n-1,l=(1<<h)-1,c=l>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,p=i?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+c>=1?f/u:f*Math.pow(2,1-c),e*u>=2&&(a++,u/=2),a+c>=l?(s=0,a=l):a+c>=1?(s=(e*u-1)*Math.pow(2,n),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,n),a=0));n>=8;t[r+d]=255&s,d+=p,s/=256,n-=8);for(a=a<<n|s,h+=n;h>0;t[r+d]=255&a,d+=p,a/=256,h-=8);t[r+d-p]|=128*m}},{}],137:[function(t,e,r){"use strict";function i(t,e){this.x=t,this.y=e}e.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=e*this.x-r*this.y,n=r*this.x+e*this.y;return this.x=i,this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},{}],138:[function(t,e,r){!function(){"use strict";function t(e,r){return this instanceof t?(this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&this._initFormat(r),void this.clear()):new t(e,r)}function r(t,e){t.bbox=i(t,0,t.children.length,e)}function i(t,e,r,i){for(var a,s=n(),u=e;r>u;u++)a=t.children[u],o(s,t.leaf?i(a):a.bbox);return s}function n(){return[1/0,1/0,-(1/0),-(1/0)]}function o(t,e){return t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t}function a(t,e){return t.bbox[0]-e.bbox[0]}function s(t,e){return t.bbox[1]-e.bbox[1]}function u(t){return(t[2]-t[0])*(t[3]-t[1])}function h(t){return t[2]-t[0]+(t[3]-t[1])}function l(t,e){return(Math.max(e[2],t[2])-Math.min(e[0],t[0]))*(Math.max(e[3],t[3])-Math.min(e[1],t[1]))}function c(t,e){var r=Math.max(t[0],e[0]),i=Math.max(t[1],e[1]),n=Math.min(t[2],e[2]),o=Math.min(t[3],e[3]);return Math.max(0,n-r)*Math.max(0,o-i)}function f(t,e){return t[0]<=e[0]&&t[1]<=e[1]&&e[2]<=t[2]&&e[3]<=t[3]}function d(t,e){return e[0]<=t[2]&&e[1]<=t[3]&&e[2]>=t[0]&&e[3]>=t[1]}function p(t,e,r,i,n){for(var o,a=[e,r];a.length;)r=a.pop(),e=a.pop(),i>=r-e||(o=e+Math.ceil((r-e)/i/2)*i,m(t,e,r,o,n),a.push(e,o,o,r))}function m(t,e,r,i,n){for(var o,a,s,u,h,l,c,f,d;r>e;){for(r-e>600&&(o=r-e+1,a=i-e+1,s=Math.log(o),u=.5*Math.exp(2*s/3),h=.5*Math.sqrt(s*u*(o-u)/o)*(0>a-o/2?-1:1),l=Math.max(e,Math.floor(i-a*u/o+h)),c=Math.min(r,Math.floor(i+(o-a)*u/o+h)),m(t,l,c,i,n)),f=t[i],a=e,d=r,v(t,e,i),n(t[r],f)>0&&v(t,e,r);d>a;){for(v(t,a,d),a++,d--;n(t[a],f)<0;)a++;for(;n(t[d],f)>0;)d--}0===n(t[e],f)?v(t,e,d):(d++,v(t,d,r)),i>=d&&(e=d+1),d>=i&&(r=d-1)}}function v(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}t.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!d(t,e.bbox))return r;for(var n,o,a,s,u=[];e;){for(n=0,o=e.children.length;o>n;n++)a=e.children[n],s=e.leaf?i(a):a.bbox,d(t,s)&&(e.leaf?r.push(a):f(t,s)?this._all(a,r):u.push(a));e=u.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!d(t,e.bbox))return!1;for(var i,n,o,a,s=[];e;){for(i=0,n=e.children.length;n>i;i++)if(o=e.children[i],a=e.leaf?r(o):o.bbox,d(t,a)){if(e.leaf||f(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;r>e;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data={children:[],height:1,bbox:n(),leaf:!0},this},remove:function(t){if(!t)return this;for(var e,r,i,n,o=this.data,a=this.toBBox(t),s=[],u=[];o||s.length;){if(o||(o=s.pop(),r=s[s.length-1],e=u.pop(),n=!0),o.leaf&&(i=o.children.indexOf(t),-1!==i))return o.children.splice(i,1),s.push(o),this._condense(s),this;n||o.leaf||!f(o.bbox,a)?r?(e++,o=r.children[e],n=!1):o=null:(s.push(o),u.push(e),e=0,r=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:function(t,e){return t[0]-e[0]},compareMinY:function(t,e){return t[1]-e[1]},toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,i,n){var o,a=i-e+1,s=this._maxEntries;if(s>=a)return o={children:t.slice(e,i+1),height:1,bbox:null,leaf:!0},r(o,this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),o={children:[],height:n,bbox:null};var u,h,l,c,f=Math.ceil(a/s),d=f*Math.ceil(Math.sqrt(s));for(p(t,e,i,d,this.compareMinX),u=e;i>=u;u+=d)for(l=Math.min(u+d-1,i),p(t,u,l,f,this.compareMinY),h=u;l>=h;h+=f)c=Math.min(h+f-1,l),o.children.push(this._build(t,h,c,n-1));return r(o,this.toBBox),o},_chooseSubtree:function(t,e,r,i){for(var n,o,a,s,h,c,f,d;;){if(i.push(e),e.leaf||i.length-1===r)break;for(f=d=1/0,n=0,o=e.children.length;o>n;n++)a=e.children[n],h=u(a.bbox),c=l(t,a.bbox)-h,d>c?(d=c,f=f>h?h:f,s=a):c===d&&f>h&&(f=h,s=a);e=s}return e},_insert:function(t,e,r){var i=this.toBBox,n=r?t.bbox:i(t),a=[],s=this._chooseSubtree(n,this.data,e,a);for(s.children.push(t),o(s.bbox,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)},_split:function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var a={children:i.children.splice(this._chooseSplitIndex(i,o,n)),height:i.height};i.leaf&&(a.leaf=!0),r(i,this.toBBox),r(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data={children:[t,e],height:t.height+1},r(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var n,o,a,s,h,l,f,d;for(l=f=1/0,n=e;r-e>=n;n++)o=i(t,0,n,this.toBBox),a=i(t,n,r,this.toBBox),s=c(o,a),h=u(o)+u(a),l>s?(l=s,d=n,f=f>h?h:f):s===l&&f>h&&(f=h,d=n);return d},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:a,n=t.leaf?this.compareMinY:s,o=this._allDistMargin(t,e,r,i),u=this._allDistMargin(t,e,r,n);u>o&&t.children.sort(i)},_allDistMargin:function(t,e,r,n){t.children.sort(n);var a,s,u=this.toBBox,l=i(t,0,e,u),c=i(t,r-e,r,u),f=h(l)+h(c);for(a=e;r-e>a;a++)s=t.children[a],o(l,t.leaf?u(s):s.bbox),f+=h(l);for(a=r-e-1;a>=e;a--)s=t.children[a],o(c,t.leaf?u(s):s.bbox),f+=h(c);return f},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)o(e[i].bbox,t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():r(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return [a"+t.join(", a")+"];")}},"function"==typeof define&&define.amd?define("rbush",function(){return t}):"undefined"!=typeof e?e.exports=t:"undefined"!=typeof self?self.rbush=t:window.rbush=t}()},{}],139:[function(t,e,r){void function(t,i){"function"==typeof define&&define.amd?define(i):"object"==typeof r?e.exports=i():t.resolveUrl=i()}(this,function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var r=document.getElementsByTagName("head")[0];r.insertBefore(e,r.firstChild);for(var i,n=document.createElement("a"),o=1;t>o;o++)n.href=arguments[o],i=n.href,e.href=i;return r.removeChild(e),i}return t})},{}],140:[function(t,e,r){function i(t,e,r,i){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=r,this.p2y=i}e.exports=i,i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){"undefined"==typeof e&&(e=1e-6);var r,i,n,o,a;for(n=t,a=0;8>a;a++){if(o=this.sampleCurveX(n)-t,Math.abs(o)<e)return n;var s=this.sampleCurveDerivativeX(n);if(Math.abs(s)<1e-6)break;n-=o/s}if(r=0,i=1,n=t,r>n)return r;if(n>i)return i;for(;i>r;){if(o=this.sampleCurveX(n),Math.abs(o-t)<e)return n;t>o?r=n:i=n,n=.5*(i-r)+r}return n},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},{}],141:[function(t,e,r){e.exports.VectorTile=t("./lib/vectortile.js"),e.exports.VectorTileFeature=t("./lib/vectortilefeature.js"),e.exports.VectorTileLayer=t("./lib/vectortilelayer.js")},{"./lib/vectortile.js":142,"./lib/vectortilefeature.js":143,"./lib/vectortilelayer.js":144}],142:[function(t,e,r){"use strict";function i(t,e){this.layers=t.readFields(n,{},e)}function n(t,e,r){if(3===t){var i=new o(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}var o=t("./vectortilelayer");e.exports=i},{"./vectortilelayer":144}],143:[function(t,e,r){"use strict";function i(t,e,r,i,o){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,t.readFields(n,this,e)}function n(t,e,r){1==t?e._id=r.readVarint():2==t?o(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function o(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}var a=t("point-geometry");e.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,n=0,o=0,s=0,u=[];t.pos<r;){if(!n){var h=t.readVarint();i=7&h,n=h>>3}if(n--,1===i||2===i)o+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&u.push(e),e=[]),e.push(new a(o,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&u.push(e),u},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,o=0,a=1/0,s=-(1/0),u=1/0,h=-(1/0);t.pos<e;){if(!i){var l=t.readVarint();r=7&l,i=l>>3}if(i--,1===r||2===r)n+=t.readSVarint(),o+=t.readSVarint(),a>n&&(a=n),n>s&&(s=n),u>o&&(u=o),o>h&&(h=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,u,s,h]},i.prototype.toGeoJSON=function(t,e,r){for(var n=this.extent*Math.pow(2,r),o=this.extent*t,a=this.extent*e,s=this.loadGeometry(),u=i.types[this.type],h=0;h<s.length;h++)for(var l=s[h],c=0;c<l.length;c++){var f=l[c],d=180-360*(f.y+a)/n;l[c]=[360*(f.x+o)/n-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}return"Point"===u&&1===s.length?s=s[0][0]:"Point"===u?(s=s[0],u="MultiPoint"):"LineString"===u&&1===s.length?s=s[0]:"LineString"===u&&(u="MultiLineString"),{type:"Feature",geometry:{type:u,coordinates:s},properties:this.properties}}},{"point-geometry":137}],144:[function(t,e,r){"use strict";function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(n,this,e),this.length=this._features.length}function n(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(o(r))}function o(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}var a=t("./vectortilefeature.js");e.exports=i,i.prototype.feature=function(t){if(0>t||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,e,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":143}],145:[function(t,e,r){var i=arguments[3],n=arguments[4],o=arguments[5],a=JSON.stringify;e.exports=function(t){for(var e,r=Object.keys(o),s=0,u=r.length;u>s;s++){var h=r[s];if(o[h].exports===t){e=h;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var l={},s=0,u=r.length;u>s;s++){var h=r[s];l[h]=h}n[e]=[Function(["require","module","exports"],"("+t+")(self)"),l]}var c=Math.floor(Math.pow(16,8)*Math.random()).toString(16),f={};f[e]=e,n[c]=[Function(["require"],"require("+a(e)+")(self)"),f];var d="("+i+")({"+Object.keys(n).map(function(t){return a(t)+":["+n[t][0]+","+a(n[t][1])+"]"}).join(",")+"},{},["+a(c)+"])",p=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(p.createObjectURL(new Blob([d],{type:"text/javascript"})))}},{}],146:[function(t,e,r){(function(){"use strict";var t={"@@functional/placeholder":!0},i=function(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,r){return e.apply(this,arguments)};case 3:return function(t,r,i){return e.apply(this,arguments)};case 4:return function(t,r,i,n){return e.apply(this,arguments)};case 5:return function(t,r,i,n,o){return e.apply(this,arguments)};case 6:return function(t,r,i,n,o,a){return e.apply(this,arguments)};case 7:return function(t,r,i,n,o,a,s){return e.apply(this,arguments)};case 8:return function(t,r,i,n,o,a,s,u){return e.apply(this,arguments)};case 9:return function(t,r,i,n,o,a,s,u,h){return e.apply(this,arguments)};case 10:return function(t,r,i,n,o,a,s,u,h,l){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},n=function(t){return new RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""))},o=function(t){return function(){return!t.apply(this,arguments)}},a=function(t,e){t=t||[],e=e||[];var r,i=t.length,n=e.length,o=[];for(r=0;i>r;)o[o.length]=t[r],r+=1;for(r=0;n>r;)o[o.length]=e[r],r+=1;return o},s=function(t,e,r){for(var i=0,n=r.length;n>i;){if(t(e,r[i]))return!0;i+=1}return!1},u=function(t){return function e(r){return 0===arguments.length?e:null!=r&&r["@@functional/placeholder"]===!0?e:t.apply(this,arguments)}},h=function(t){return function e(r,i){var n=arguments.length;return 0===n?e:1===n&&null!=r&&r["@@functional/placeholder"]===!0?e:1===n?u(function(e){return t(r,e)}):2===n&&null!=r&&r["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0?e:2===n&&null!=r&&r["@@functional/placeholder"]===!0?u(function(e){return t(e,i)}):2===n&&null!=i&&i["@@functional/placeholder"]===!0?u(function(e){return t(r,e)}):t(r,i)}},l=function(t){return function e(r,i,n){var o=arguments.length;return 0===o?e:1===o&&null!=r&&r["@@functional/placeholder"]===!0?e:1===o?h(function(e,i){return t(r,e,i)}):2===o&&null!=r&&r["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0?e:2===o&&null!=r&&r["@@functional/placeholder"]===!0?h(function(e,r){return t(e,i,r)}):2===o&&null!=i&&i["@@functional/placeholder"]===!0?h(function(e,i){return t(r,e,i)}):2===o?u(function(e){return t(r,i,e)}):3===o&&null!=r&&r["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0&&null!=n&&n["@@functional/placeholder"]===!0?e:3===o&&null!=r&&r["@@functional/placeholder"]===!0&&null!=i&&i["@@functional/placeholder"]===!0?h(function(e,r){return t(e,r,n)}):3===o&&null!=r&&r["@@functional/placeholder"]===!0&&null!=n&&n["@@functional/placeholder"]===!0?h(function(e,r){return t(e,i,r)}):3===o&&null!=i&&i["@@functional/placeholder"]===!0&&null!=n&&n["@@functional/placeholder"]===!0?h(function(e,i){return t(r,e,i)}):3===o&&null!=r&&r["@@functional/placeholder"]===!0?u(function(e){return t(e,i,n)}):3===o&&null!=i&&i["@@functional/placeholder"]===!0?u(function(e){return t(r,e,n)}):3===o&&null!=n&&n["@@functional/placeholder"]===!0?u(function(e){return t(r,i,e)}):t(r,i,n)}},c=function hn(t,e,r){return function(){for(var n=[],o=0,a=t,s=0;s<e.length||o<arguments.length;){var u;s<e.length&&(null==e[s]||e[s]["@@functional/placeholder"]!==!0||o>=arguments.length)?u=e[s]:(u=arguments[o],o+=1),n[s]=u,(null==u||u["@@functional/placeholder"]!==!0)&&(a-=1),s+=1}return 0>=a?r.apply(this,n):i(a,hn(t,n,r))}},f=function(t,e){for(var r=0,i=e.length,n=[];i>r;)t(e[r])&&(n[n.length]=e[r]),r+=1;return n},d=function(t){return{"@@transducer/value":t,"@@transducer/reduced":!0}},p=function(t){return function(e){return f(function(t){return"function"==typeof e[t]},t(e))}},m=function(t,e){return Object.prototype.hasOwnProperty.call(e,t)},v=function(t){return t},_=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)},g=Number.isInteger||function(t){return t<<0===t},y=function(t){return"[object Number]"===Object.prototype.toString.call(t)},x=function(t){return"[object String]"===Object.prototype.toString.call(t)},b=function(t){return"function"==typeof t["@@transducer/step"]},w=function(t,e){for(var r=0,i=e.length,n=Array(i);i>r;)n[r]=t(e[r]),r+=1;return n},S=function(t,e){return function(){return e.call(this,t.apply(this,arguments))}},M=function(t,e){return function(){var r=this;return t.apply(r,arguments).then(function(t){return e.call(r,t)})}},E=function(t){return'"'+t.replace(/"/g,'\\"')+'"'},T=function(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0};
},z=function ln(t,e,r){switch(arguments.length){case 1:return ln(t,0,t.length);case 2:return ln(t,e,t.length);default:for(var i=[],n=0,o=Math.max(0,Math.min(t.length,r)-e);o>n;)i[n]=t[e+n],n+=1;return i}},A=function(){var t=function(t){return(10>t?"0":"")+t};return"function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(e){return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),P=function(){function t(t,e){this.xf=e,this.pred=t,this.lastValue=void 0,this.seenFirstValue=!1}return t.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){var r=!1;return this.seenFirstValue?this.pred(this.lastValue,e)&&(r=!0):this.seenFirstValue=!0,this.lastValue=e,r?t:this.xf["@@transducer/step"](t,e)},h(function(e,r){return new t(e,r)})}(),I={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}},L=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=I.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},h(function(e,r){return new t(e,r)})}(),k=function(){function t(t,e){this.xf=e,this.f=t,this.found=!1}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,void 0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.found=!0,t=T(this.xf["@@transducer/step"](t,e))),t},h(function(e,r){return new t(e,r)})}(),D=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.found=!1}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,-1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.found=!0,t=T(this.xf["@@transducer/step"](t,this.idx))),t},h(function(e,r){return new t(e,r)})}(),R=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.last))},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.last=e),t},h(function(e,r){return new t(e,r)})}(),O=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.lastIdx=-1}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.lastIdx))},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.lastIdx=this.idx),t},h(function(e,r){return new t(e,r)})}(),j=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=I.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},h(function(e,r){return new t(e,r)})}(),C=function(){function t(t,e){this.xf=e,this.n=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=I.result,t.prototype["@@transducer/step"]=function(t,e){return 0===this.n?T(t):(this.n-=1,this.xf["@@transducer/step"](t,e))},h(function(e,r){return new t(e,r)})}(),B=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=I.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):T(t)},h(function(e,r){return new t(e,r)})}(),F=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},function(e){return new t(e)}}(),N=h(function(t,e){return t+e}),q=l(function(t,e,r){if(e>=r.length||e<-r.length)return r;var i=0>e?r.length:0,n=i+e,o=a(r);return o[n]=t(r[n]),o}),U=u(function(t){return function(){return t}}),V=h(function(t,e){for(var r=0,i=e.length-(t-1),n=new Array(i>=0?i:0);i>r;)n[r]=z(e,r,r+t),r+=1;return n}),G=h(function(t,e){return a(e,[t])}),J=h(function(t,e){return t.apply(this,e)}),Z=l(function(t,e,r){var i={};for(var n in r)i[n]=r[n];return i[t]=e,i}),H=l(function cn(t,e,r){switch(t.length){case 0:return r;case 1:return Z(t[0],e,r);default:return Z(t[0],cn(z(t,1),e,Object(r[t[0]])),r)}}),W=h(function(t,e){return i(t.length,function(){return t.apply(e,arguments)})}),X=h(function(t,e){return function(){return t.apply(this,arguments)&&e.apply(this,arguments)}}),Y=u(function(t){return function(e,r){return t(e,r)?-1:t(r,e)?1:0}}),K=u(o),$=u(function(t){return function(){for(var e=0;e<t.length;){if(t[e][0].apply(this,arguments))return t[e][1].apply(this,arguments);e+=1}}}),Q=l(s),tt=h(function(t,e){for(var r={},i=e.length,n=0;i>n;){var o=t(e[n]);r[o]=(m(o,r)?r[o]:0)+1,n+=1}return r}),et=h(function(t,e){var r={};return r[t]=e,r}),rt=h(function(t,e){return 1===t?u(e):i(t,c(t,[],e))}),it=N(-1),nt=h(function(t,e){return null==e?t:e}),ot=l(function(t,e,r){for(var i=[],n=0,o=e.length,a=Q(t);o>n;)a(e[n],r)||a(e[n],i)||(i[i.length]=e[n]),n+=1;return i}),at=h(function(t,e){var r={};for(var i in e)i!==t&&(r[i]=e[i]);return r}),st=h(function fn(t,e){switch(t.length){case 0:return e;case 1:return at(t[0],e);default:var r=t[0],i=z(t,1);return null==e[r]?e:Z(r,fn(i,e[r]),e)}}),ut=h(function(t,e){return t/e}),ht=h(function(t,e){for(var r=e.length-1;r>=0&&t(e[r]);)r-=1;return z(e,0,r+1)}),lt=h(function(t,e){return function(){return t.apply(this,arguments)||e.apply(this,arguments)}}),ct=u(function(t){if(null!=t&&"function"==typeof t.empty)return t.empty();if(null!=t&&null!=typeof t.constructor&&"function"==typeof t.constructor.empty)return t.constructor.empty();switch(Object.prototype.toString.call(t)){case"[object Array]":return[];case"[object Object]":return{};case"[object String]":return""}}),ft=h(function dn(t,e){var r,i,n,o={};for(i in e)r=t[i],n=typeof r,o[i]="function"===n?r(e[i]):"object"===n?dn(t[i],e[i]):e[i];return o}),dt=u(function(t){for(var e=0,r=t.length,i={};r>e;)_(t[e])&&t[e].length&&(i[t[e][0]]=t[e][1]),e+=1;return i}),pt=h(function(t,e){return t>e}),mt=h(function(t,e){return t>=e}),vt=h(m),_t=h(function(t,e){return t in e}),gt=h(function(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}),yt=u(v),xt=l(function(t,e,r){return rt(Math.max(t.length,e.length,r.length),function(){return t.apply(this,arguments)?e.apply(this,arguments):r.apply(this,arguments)})}),bt=N(1),wt=l(function(t,e,r){t=t<r.length&&t>=0?t:r.length;var i=z(r);return i.splice(t,0,e),i}),St=l(function(t,e,r){return t=t<r.length&&t>=0?t:r.length,a(a(z(r,0,t),e),z(r,t))}),Mt=h(function(t,e){return null!=e&&e.constructor===t||e instanceof t}),Et=u(function(t){return _(t)?!0:t?"object"!=typeof t?!1:t instanceof String?!1:1===t.nodeType?!!t.length:0===t.length?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1:!1}),Tt=u(function(t){return 0===Object(t).length}),zt=u(function(t){return null==t}),At=function(){var t=!{toString:null}.propertyIsEnumerable("toString"),e=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],r=function(t,e){for(var r=0;r<t.length;){if(t[r]===e)return!0;r+=1}return!1};return u("function"==typeof Object.keys?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(i){if(Object(i)!==i)return[];var n,o,a=[];for(n in i)m(n,i)&&(a[a.length]=n);if(t)for(o=e.length-1;o>=0;)n=e[o],m(n,i)&&!r(a,n)&&(a[a.length]=n),o-=1;return a})}(),Pt=u(function(t){var e,r=[];for(e in t)r[r.length]=e;return r}),It=u(function(t){return null!=t&&Mt(Number,t.length)?t.length:NaN}),Lt=h(function(t,e){return e>t}),kt=h(function(t,e){return e>=t}),Dt=l(function(t,e,r){for(var i=0,n=r.length,o=[],a=[e];n>i;)a=t(a[0],r[i]),o[i]=a[1],i+=1;return[a[0],o]}),Rt=l(function(t,e,r){for(var i=r.length-1,n=[],o=[e];i>=0;)o=t(o[0],r[i]),n[i]=o[1],i-=1;return[o[0],n]}),Ot=h(function(t,e){return e.match(t)||[]}),jt=h(function(t,e){return g(t)?!g(e)||1>e?NaN:(t%e+e)%e:NaN}),Ct=h(function(t,e){return e>t?e:t}),Bt=l(function(t,e,r){return t(r)>t(e)?r:e}),Ft=h(function(t,e){for(var r={},i=At(t),n=0;n<i.length;)r[i[n]]=t[i[n]],n+=1;for(i=At(e),n=0;n<i.length;)r[i[n]]=e[i[n]],n+=1;return r}),Nt=h(function(t,e){return t>e?e:t}),qt=l(function(t,e,r){return t(r)<t(e)?r:e}),Ut=h(function(t,e){return t%e}),Vt=h(function(t,e){return t*e}),Gt=h(function(t,e){switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,r){return e.call(this,t,r)};case 3:return function(t,r,i){return e.call(this,t,r,i)};case 4:return function(t,r,i,n){return e.call(this,t,r,i,n)};case 5:return function(t,r,i,n,o){return e.call(this,t,r,i,n,o)};case 6:return function(t,r,i,n,o,a){return e.call(this,t,r,i,n,o,a)};case 7:return function(t,r,i,n,o,a,s){return e.call(this,t,r,i,n,o,a,s)};case 8:return function(t,r,i,n,o,a,s,u){return e.call(this,t,r,i,n,o,a,s,u)};case 9:return function(t,r,i,n,o,a,s,u,h){return e.call(this,t,r,i,n,o,a,s,u,h)};case 10:return function(t,r,i,n,o,a,s,u,h,l){return e.call(this,t,r,i,n,o,a,s,u,h,l)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),Jt=u(function(t){return-t}),Zt=u(function(t){return!t}),Ht=h(function(t,e){var r=0>t?e.length+t:t;return x(e)?e.charAt(r):e[r]}),Wt=u(function(t){return function(){return Ht(t,arguments)}}),Xt=h(function(t,e){return e.charAt(0>t?e.length+t:t)}),Yt=h(function(t,e){return e.charCodeAt(0>t?e.length+t:t)}),Kt=u(function(t){return[t]}),$t=u(function(t){var e,r=!1;return function(){return r?e:(r=!0,e=t.apply(this,arguments))}}),Qt=function(){var t=function(e){return{value:e,map:function(r){return t(r(e))}}};return l(function(e,r,i){return e(function(e){return t(r(e))})(i).value})}(),te=h(function(t,e){if(null!=e){for(var r=e,i=0,n=t.length;n>i&&null!=r;i+=1)r=r[t[i]];return r}}),ee=h(function(t,e){for(var r={},i=0;i<t.length;)t[i]in e&&(r[t[i]]=e[t[i]]),i+=1;return r}),re=h(function(t,e){for(var r={},i=0,n=t.length;n>i;){var o=t[i];r[o]=e[o],i+=1}return r}),ie=h(function(t,e){var r={};for(var i in e)t(e[i],i,e)&&(r[i]=e[i]);return r}),ne=h(function(t,e){return a([t],e)}),oe=h(function(t,e){return e[t]}),ae=l(function(t,e,r){return null!=r&&m(e,r)?r[e]:t}),se=l(function(t,e,r){return t(r[e])}),ue=h(function(t,e){for(var r=t.length,i=[],n=0;r>n;)i[n]=e[t[n]],n+=1;return i}),he=h(function(t,e){if(!y(t)||!y(e))throw new TypeError("Both arguments to range must be numbers");for(var r=[],i=t;e>i;)r.push(i),i+=1;return r}),le=l(function(t,e,r){for(var i=r.length-1;i>=0;)e=t(e,r[i]),i-=1;return e}),ce=u(T),fe=l(function(t,e,r){return a(z(r,0,Math.min(t,r.length)),z(r,Math.min(r.length,t+e)))}),de=l(function(t,e,r){return r.replace(t,e)}),pe=u(function(t){return z(t).reverse()}),me=l(function(t,e,r){for(var i=0,n=r.length,o=[e];n>i;)e=t(e,r[i]),o[i+1]=e,i+=1;return o}),ve=l(function(t,e,r){return Qt(t,U(e),r)}),_e=h(function(t,e){return z(e).sort(t)}),ge=h(function(t,e){return z(e).sort(function(e,r){var i=t(e),n=t(r);return n>i?-1:i>n?1:0})}),ye=h(function(t,e){return t-e}),xe=h(function(t,e){for(var r=e.length-1;r>=0&&t(e[r]);)r-=1;return z(e,r+1,1/0)}),be=h(function(t,e){return t(e),e}),we=h(function(t,e){return n(t).test(e)}),Se=h(function(t,e){for(var r=Number(e),i=new Array(r),n=0;r>n;)i[n]=t(n),n+=1;return i}),Me=u(function(t){var e=[];for(var r in t)m(r,t)&&(e[e.length]=[r,t[r]]);return e}),Ee=u(function(t){var e=[];for(var r in t)e[e.length]=[r,t[r]];return e}),Te=function(){var t="	\n\f\r   ᠎             　\u2028\u2029\ufeff",e="​",r="function"==typeof String.prototype.trim;return u(r&&!t.trim()&&e.trim()?function(t){return t.trim()}:function(e){var r=new RegExp("^["+t+"]["+t+"]*"),i=new RegExp("["+t+"]["+t+"]*$");return e.replace(r,"").replace(i,"")})}(),ze=u(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}),Ae=u(function(t){return function(){return t(z(arguments))}}),Pe=u(function(t){return Gt(1,t)}),Ie=h(function(t,e){return rt(t,function(){for(var r,i=1,n=e,o=0;t>=i&&"function"==typeof n;)r=i===t?arguments.length:o+n.length,n=n.apply(this,z(arguments,o,r)),i+=1,o=r;return n})}),Le=h(function(t,e){for(var r=t(e),i=[];r&&r.length;)i[i.length]=r[0],r=t(r[1]);return i}),ke=h(function(t,e){for(var r,i=0,n=e.length,o=[];n>i;)r=e[i],s(t,r,o)||(o[o.length]=r),i+=1;return o}),De=l(function(t,e,r){return q(U(e),t,r)}),Re=u(function(t){for(var e=At(t),r=e.length,i=[],n=0;r>n;)i[n]=t[e[n]],n+=1;return i}),Oe=u(function(t){var e,r=[];for(e in t)r[r.length]=t[e];return r}),je=function(){var t=function(t){return{value:t,map:function(){return this}}};return h(function(e,r){return e(t)(r).value})}(),Ce=h(function(t,e){for(var r in t)if(m(r,t)&&!t[r](e[r]))return!1;return!0}),Be=h(function(t,e){return rt(t.length,function(){return e.apply(this,a([t],arguments))})}),Fe=h(function(t,e){for(var r,i=0,n=t.length,o=e.length,a=[];n>i;){for(r=0;o>r;)a[a.length]=[t[i],e[r]],r+=1;i+=1}return a}),Ne=h(function(t,e){for(var r=[],i=0,n=Math.min(t.length,e.length);n>i;)r[i]=[t[i],e[i]],i+=1;return r}),qe=h(function(t,e){for(var r=0,i=t.length,n={};i>r;)n[t[r]]=e[r],r+=1;return n}),Ue=l(function(t,e,r){for(var i=[],n=0,o=Math.min(e.length,r.length);o>n;)i[n]=t(e[n],r[n]),n+=1;return i}),Ve=U(!1),Ge=U(!0),Je=function(t,e){return function(){var r=arguments.length;if(0===r)return e();var i=arguments[r-1];return _(i)||"function"!=typeof i[t]?e.apply(this,arguments):i[t].apply(i,z(arguments,0,r-1))}},Ze=function pn(t,e,r){var i=function(i){for(var n=e.length,o=0;n>o;){if(t===e[o])return r[o];o+=1}e[o+1]=t,r[o+1]=i;for(var a in t)i[a]=pn(t[a],e,r);return i};switch(ze(t)){case"Object":return i({});case"Array":return i([]);case"Date":return new Date(t);case"RegExp":return n(t);default:return t}},He=function(t){return function(e){var r=z(arguments,1);return i(Math.max(0,e.length-r.length),function(){return e.apply(this,t(r,arguments))})}},We=function(t,e,r){return function(){var i=arguments.length;if(0===i)return r();var n=arguments[i-1];if(!_(n)){var o=z(arguments,0,i-1);if("function"==typeof n[t])return n[t].apply(n,o);if(b(n)){var a=e.apply(null,o);return a(n)}}return r.apply(this,arguments)}},Xe=function mn(t,e,r,i){var n=ze(t);if(n!==ze(e))return!1;if("Boolean"===n||"Number"===n||"String"===n)return"object"==typeof t?"object"==typeof e&&gt(t.valueOf(),e.valueOf()):gt(t,e);if(gt(t,e))return!0;if("RegExp"===n)return t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode;if(Object(t)===t){if("Date"===n&&t.getTime()!==e.getTime())return!1;var o=At(t);if(o.length!==At(e).length)return!1;for(var a=r.length-1;a>=0;){if(r[a]===t)return i[a]===e;a-=1}for(r[r.length]=t,i[i.length]=e,a=o.length-1;a>=0;){var s=o[a];if(!m(s,e)||!mn(e[s],t[s],r,i))return!1;a-=1}return r.pop(),i.pop(),!0}return!1},Ye=function(t,e){return null!=e&&!_(e)&&"function"==typeof e[t]},Ke=function(t){return function e(r){for(var i,n,o,a=[],s=0,u=r.length;u>s;){if(Et(r[s]))for(i=t?e(r[s]):r[s],n=0,o=i.length;o>n;)a[a.length]=i[n],n+=1;else a[a.length]=r[s];s+=1}return a}},$e=function(){function t(t,e,r){for(var i=0,n=r.length;n>i;){if(e=t["@@transducer/step"](e,r[i]),e&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}i+=1}return t["@@transducer/result"](e)}function e(t,e,r){for(var i=r.next();!i.done;){if(e=t["@@transducer/step"](e,i.value),e&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}i=r.next()}return t["@@transducer/result"](e)}function r(t,e,r){return t["@@transducer/result"](r.reduce(W(t["@@transducer/step"],t),e))}var i="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(n,o,a){if("function"==typeof n&&(n=F(n)),Et(a))return t(n,o,a);if("function"==typeof a.reduce)return r(n,o,a);if(null!=a[i])return e(n,o,a[i]());if("function"==typeof a.next)return e(n,o,a);throw new TypeError("reduce: list must be array or iterable")}}(),Qe=function(){var t={"@@transducer/init":Array,"@@transducer/step":function(t,e){return a(t,[e])},"@@transducer/result":v},e={"@@transducer/init":String,"@@transducer/step":function(t,e){return t+e},"@@transducer/result":v},r={"@@transducer/init":Object,"@@transducer/step":function(t,e){return Ft(t,Et(e)?et(e[0],e[1]):e)},"@@transducer/result":v};return function(i){if(b(i))return i;if(Et(i))return t;if("string"==typeof i)return e;if("object"==typeof i)return r;throw new Error("Cannot create transformer for "+i)}}(),tr=function(){function t(t,e){this.xf=e,this.f=t,this.all=!0}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)||(this.all=!1,t=T(this.xf["@@transducer/step"](t,!1))),t},h(function(e,r){return new t(e,r)})}(),er=function(){function t(t,e){this.xf=e,this.f=t,this.any=!1}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){return this.any||(t=this.xf["@@transducer/step"](t,!1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.any=!0,t=T(this.xf["@@transducer/step"](t,!0))),t},h(function(e,r){return new t(e,r)})}(),rr=function(){function t(t,e){this.xf=e,this.n=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=I.result,t.prototype["@@transducer/step"]=function(t,e){return this.n>0?(this.n-=1,t):this.xf["@@transducer/step"](t,e)},h(function(e,r){return new t(e,r)})}(),ir=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=I.result,t.prototype["@@transducer/step"]=function(t,e){if(this.f){if(this.f(e))return t;this.f=null}return this.xf["@@transducer/step"](t,e)},h(function(e,r){return new t(e,r)})}(),nr=function(){function t(t,e){this.xf=e,this.f=t,this.inputs={}}return t.prototype["@@transducer/init"]=I.init,t.prototype["@@transducer/result"]=function(t){var e;for(e in this.inputs)if(m(e,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[e]),t["@@transducer/reduced"])){t=t["@@transducer/value"];break}return this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){var r=this.f(e);return this.inputs[r]=this.inputs[r]||[r,[]],this.inputs[r][1]=G(e,this.inputs[r][1]),t},h(function(e,r){return new t(e,r)})}(),or=u(function(t){return rt(t.length,function(){var e=0,r=arguments[0],i=arguments[arguments.length-1],n=z(arguments);return n[0]=function(){var t=r.apply(this,a(arguments,[e,i]));return e+=1,t},t.apply(this,n)})}),ar=h(We("all",tr,function(t,e){for(var r=0;r<e.length;){if(!t(e[r]))return!1;r+=1}return!0})),sr=h(function(t,e){return Ye("and",t)?t.and(e):t&&e}),ur=h(We("any",er,function(t,e){for(var r=0;r<e.length;){if(t(e[r]))return!0;r+=1}return!1})),hr=u(function(t){return Gt(2,t)}),lr=u(function(t){return Ze(t,[],[])}),cr=h(function(t,e){if(_(e))return a(t,e);if(Ye("concat",t))return t.concat(e);throw new TypeError("can't concat "+typeof t)}),fr=u(function(t){return rt(t.length,t)}),dr=h(We("dropWhile",ir,function(t,e){for(var r=0,i=e.length;i>r&&t(e[r]);)r+=1;return z(e,r)})),pr=h(function(t,e){return Ye("equals",t)?t.equals(e):Ye("equals",e)?e.equals(t):Xe(t,e,[],[])}),mr=h(We("filter",L,f)),vr=h(We("find",k,function(t,e){for(var r=0,i=e.length;i>r;){if(t(e[r]))return e[r];r+=1}})),_r=h(We("findIndex",D,function(t,e){for(var r=0,i=e.length;i>r;){if(t(e[r]))return r;r+=1}return-1})),gr=h(We("findLast",R,function(t,e){for(var r=e.length-1;r>=0;){if(t(e[r]))return e[r];r-=1}})),yr=h(We("findLastIndex",O,function(t,e){for(var r=e.length-1;r>=0;){if(t(e[r]))return r;r-=1}return-1})),xr=u(Ke(!0)),br=u(function(t){return fr(function(e,r){var i=z(arguments);return i[0]=r,i[1]=e,t.apply(this,i)})}),wr=h(Je("forEach",function(t,e){for(var r=e.length,i=0;r>i;)t(e[i]),i+=1;return e})),Sr=u(p(At)),Mr=u(p(Pt)),Er=h(We("groupBy",nr,function(t,e){return $e(function(e,r){var i=t(r);return e[i]=G(r,e[i]||(e[i]=[])),e},{},e)})),Tr=Ht(0),zr=l(function(t,e,r){for(var i=[],n=0;n<e.length;)s(t,e[n],r)&&(i[i.length]=e[n]),n+=1;return ke(t,i)}),Ar=h(Je("intersperse",function(t,e){for(var r=[],i=0,n=e.length;n>i;)i===n-1?r.push(e[i]):r.push(e[i],t),i+=1;return r})),Pr=l(function(t,e,r){return b(t)?$e(e(t),t["@@transducer/init"](),r):$e(e(Qe(t)),t,r)}),Ir=u(function(t){for(var e=At(t),r=e.length,i=0,n={};r>i;){var o=e[i],a=t[o],s=m(a,n)?n[a]:n[a]=[];s[s.length]=o,i+=1}return n}),Lr=u(function(t){for(var e=At(t),r=e.length,i=0,n={};r>i;){var o=e[i];n[t[o]]=o,i+=1}return n}),kr=Ht(-1),Dr=h(function(t,e){if(Ye("lastIndexOf",e))return e.lastIndexOf(t);for(var r=e.length-1;r>=0;){if(pr(e[r],t))return r;r-=1}return-1}),Rr=h(We("map",j,w)),Or=h(function(t,e){return $e(function(r,i){return r[i]=t(e[i]),r},{},At(e))}),jr=h(function(t,e){return $e(function(r,i){return r[i]=t(e[i],i,e),r},{},At(e))}),Cr=h(o(We("any",er,ur))),Br=h(function(t,e){return Ye("or",t)?t.or(e):t||e}),Fr=fr(He(a)),Nr=fr(He(br(a))),qr=h(function(t,e){return $e(function(e,r){var i=e[t(r)?0:1];return i[i.length]=r,e},[[],[]],e)}),Ur=l(function(t,e,r){return pr(te(t,r),e)}),Vr=h(function(t,e){return Rr(oe(t),e)}),Gr=l(function(t,e,r){return se(pr(e),t,r)}),Jr=l(function(t,e,r){return se(Mt(t),e,r)}),Zr=l($e),Hr=h(function(t,e){return mr(o(t),e)}),Wr=h(function(t,e){return Se(U(t),e)}),Xr=l(Je("slice",function(t,e,r){return Array.prototype.slice.call(r,t,e)})),Yr=h(function(t,e){if(0>=t)throw new Error("First argument to splitEvery must be a positive integer");for(var r=[],i=0;i<e.length;)r.push(Xr(i,i+=t,e));return r}),Kr=Zr(N,0),$r=Je("tail",Xr(1,1/0)),Qr=h(We("take",C,function(t,e){return Xr(0,0>t?1/0:t,e)})),ti=h(We("takeWhile",B,function(t,e){for(var r=0,i=e.length;i>r&&t(e[r]);)r+=1;return z(e,0,r)})),ei=rt(4,function(t,e,r,i){return $e(t("function"==typeof e?F(e):e),r,i)}),ri=l(function(t,e,r){return ke(t,a(e,r))}),ii=ke(pr),ni=u(Ke(!1)),oi=fr(function(t){var e=z(arguments,1),r=e.length;return fr(i(r,function(){for(var i=[],n=0;r>n;)i[n]=e[n](arguments[n]),n+=1;return t.apply(this,i.concat(z(arguments,r)))}))}),ai=h(function(t,e){return Ce(Or(pr,t),e)}),si=function(){var t=function(t){return{"@@transducer/init":I.init,"@@transducer/result":function(e){return t["@@transducer/result"](e)},"@@transducer/step":function(e,r){var i=t["@@transducer/step"](e,r);return i["@@transducer/reduced"]?d(i):i}}};return function(e){var r=t(e);return{"@@transducer/init":I.init,"@@transducer/result":function(t){return r["@@transducer/result"](t)},"@@transducer/step":function(t,e){return Et(e)?$e(r,t,e):$e(r,t,[e])}}}}(),ui=function(t,e,r){for(var i=r;i<t.length;){if(pr(t[i],e))return i;i+=1}return-1},hi=function(t){return function(e){var r=function(){var r=arguments;return t(function(t){return t.apply(null,r)},e)};return arguments.length>1?r.apply(null,z(arguments,1)):i(Math.max.apply(Math,Vr("length",e)),r)}},li=h(function(t,e){return Rr(t,si(e))}),ci=u(hi(ar)),fi=u(hi(ur)),di=h(function(t,e){return Ye("ap",t)?t.ap(e):$e(function(t,r){return a(t,Rr(r,e))},[],t)}),pi=fr(function(t){return t.apply(this,z(arguments,1))}),mi=h(We("chain",li,function(t,e){return ni(Rr(t,e))})),vi=l(function(t,e,r){function i(e,r){return di(Rr(G,t(r)),e)}return $e(i,e([]),r)}),_i=h(function(t,e){if(t>10)throw new Error("Constructor with greater than ten arguments");return 0===t?function(){return new e}:fr(Gt(t,function(t,r,i,n,o,a,s,u,h,l){switch(arguments.length){case 1:return new e(t);case 2:return new e(t,r);case 3:return new e(t,r,i);case 4:return new e(t,r,i,n);case 5:return new e(t,r,i,n,o);case 6:return new e(t,r,i,n,o,a);case 7:return new e(t,r,i,n,o,a,s);case 8:return new e(t,r,i,n,o,a,s,u);case 9:return new e(t,r,i,n,o,a,s,u,h);case 10:return new e(t,r,i,n,o,a,s,u,h,l)}}))}),gi=rt(3,function(t){var e=z(arguments,1);return rt(Math.max.apply(Math,Vr("length",e)),function(){var r=arguments,i=this;return t.apply(i,w(function(t){return t.apply(i,r)},e))})}),yi=h(We("drop",rr,function(t,e){return Xr(Math.max(0,t),1/0,e)})),xi=h(function(t,e){return Qr(t<e.length?e.length-t:0,e)}),bi=h(We("dropRepeatsWith",P,function(t,e){var r=[],i=1,n=e.length;if(0!==n)for(r[0]=e[0];n>i;)t(kr(r),e[i])||(r[r.length]=e[i]),i+=1;return r})),wi=l(function(t,e,r){return pr(e[t],r[t])}),Si=h(function(t,e){return Ye("indexOf",e)?e.indexOf(t):ui(e,t,0)}),Mi=Xr(0,-1),Ei=u(function(t){for(var e=t.length,r=0;e>r;){if(ui(t,t[r],r+1)>=0)return!1;r+=1}return!0}),Ti=h(function(t,e){return function(r){return function(i){return Rr(function(t){return e(t,i)},r(t(i)))}}}),zi=u(function(t){return Ti(Ht(t),De(t))}),Ai=u(function(t){return Ti(oe(t),Z(t))}),Pi=h(function(t,e){var r=rt(t,e);return rt(t,function(){return $e(di,Rr(r,arguments[0]),z(arguments,1))})}),Ii=u(function(t){return Kr(t)/t.length}),Li=u(function(t){var e=t.length;if(0===e)return NaN;var r=2-e%2,i=(e-r)/2;return Ii(z(t).sort(function(t,e){return e>t?-1:t>e?1:0}).slice(i,i+r))}),ki=u(function(t){return Zr(Ft,{},t)}),Di=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return rt(arguments[0].length,Zr(S,arguments[0],$r(arguments)))},Ri=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return rt(arguments[0].length,Zr(M,arguments[0],$r(arguments)))},Oi=Zr(Vt,1),ji=oi(w,re,yt),Ci=h(function(t,e){return yi(t>=0?e.length-t:0,e)}),Bi=function(t,e){return ui(e,t,0)>=0},Fi=function vn(t,e){var r=function(r){var i=e.concat([t]);return Bi(r,i)?"<Circular>":vn(r,i)},i=function(t,e){return w(function(e){return E(e)+": "+r(t[e])},e.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+w(r,t).join(", ")+"))";case"[object Array]":return"["+w(r,t).concat(i(t,Hr(we(/^\d+$/),At(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+r(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+E(A(t))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+r(t.valueOf())+")":1/t===-(1/0)?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+r(t.valueOf())+")":E(t);case"[object Undefined]":return"undefined";default:return"function"==typeof t.constructor&&"Object"!==t.constructor.name&&"function"==typeof t.toString&&"[object Object]"!==t.toString()?t.toString():"{"+i(t,At(t)).join(", ")+"}"}},Ni=vi(yt),qi=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Di.apply(this,pe(arguments))},Ui=function(){return 0===arguments.length?yt:qi.apply(this,Rr(mi,arguments))},Vi=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return Ri.apply(this,pe(arguments))},Gi=u(function(t){return _i(t.length,t)}),Ji=h(Bi),Zi=h(function(t,e){for(var r=[],i=0,n=t.length;n>i;)Bi(t[i],e)||Bi(t[i],r)||(r[r.length]=t[i]),i+=1;return r}),Hi=u(We("dropRepeats",P(pr),bi(pr))),Wi=h(function(t,e){return ii(f(br(Bi)(t),e))}),Xi=u(function(t){return Pi(t.length,t)}),Yi=h(function(t,e){var r={};for(var i in e)Bi(i,t)||(r[i]=e[i]);return r}),Ki=function(){return Ui.apply(this,pe(arguments))},$i=u(function(t){return Fi(t,[])}),Qi=h(qi(ii,a)),tn=h(function(t,e){for(var r,i,n=0,o=[],a=[];n<e.length;)i=e[n],r=t(i),Bi(r,o)||(a.push(i),o.push(r)),n+=1;return a}),en=h(function(t,e){return rt(t+1,function(){var r=arguments[t];if(null!=r&&Mt(Function,r[e]))return r[e].apply(r,z(arguments,0,t));throw new TypeError($i(r)+' does not have a method named "'+e+'"')})}),rn=en(1,"join"),nn=u(function(t){var e={};return function(){var r=$i(arguments);return m(r,e)||(e[r]=t.apply(this,arguments)),e[r]}}),on=en(1,"split"),an=en(0,"toLowerCase"),sn=en(0,"toUpperCase"),un={F:Ve,T:Ge,__:t,add:N,addIndex:or,adjust:q,all:ar,allPass:ci,always:U,and:sr,any:ur,anyPass:fi,ap:di,aperture:V,append:G,apply:J,assoc:Z,assocPath:H,binary:hr,bind:W,both:X,call:pi,chain:mi,clone:lr,commute:Ni,commuteMap:vi,comparator:Y,complement:K,compose:qi,composeK:Ui,composeP:Vi,concat:cr,cond:$,construct:Gi,constructN:_i,contains:Ji,containsWith:Q,converge:gi,countBy:tt,createMapEntry:et,curry:fr,curryN:rt,dec:it,defaultTo:nt,difference:Zi,differenceWith:ot,dissoc:at,dissocPath:st,divide:ut,drop:yi,dropLast:xi,dropLastWhile:ht,dropRepeats:Hi,dropRepeatsWith:bi,dropWhile:dr,either:lt,empty:ct,eqProps:wi,equals:pr,evolve:ft,filter:mr,find:vr,findIndex:_r,findLast:gr,findLastIndex:yr,flatten:xr,flip:br,forEach:wr,fromPairs:dt,functions:Sr,functionsIn:Mr,groupBy:Er,gt:pt,gte:mt,has:vt,hasIn:_t,head:Tr,identical:gt,identity:yt,ifElse:xt,inc:bt,indexOf:Si,init:Mi,insert:wt,insertAll:St,intersection:Wi,intersectionWith:zr,intersperse:Ar,into:Pr,invert:Ir,invertObj:Lr,invoker:en,is:Mt,isArrayLike:Et,isEmpty:Tt,isNil:zt,isSet:Ei,join:rn,keys:At,keysIn:Pt,last:kr,lastIndexOf:Dr,length:It,lens:Ti,lensIndex:zi,lensProp:Ai,lift:Xi,liftN:Pi,lt:Lt,lte:kt,map:Rr,mapAccum:Dt,mapAccumRight:Rt,mapObj:Or,mapObjIndexed:jr,match:Ot,mathMod:jt,max:Ct,maxBy:Bt,mean:Ii,median:Li,memoize:nn,merge:Ft,mergeAll:ki,min:Nt,minBy:qt,modulo:Ut,multiply:Vt,nAry:Gt,negate:Jt,none:Cr,not:Zt,nth:Ht,nthArg:Wt,nthChar:Xt,nthCharCode:Yt,of:Kt,omit:Yi,once:$t,or:Br,over:Qt,partial:Fr,partialRight:Nr,partition:qr,path:te,pathEq:Ur,pick:ee,pickAll:re,pickBy:ie,pipe:Di,pipeK:Ki,pipeP:Ri,pluck:Vr,prepend:ne,product:Oi,project:ji,prop:oe,propEq:Gr,propIs:Jr,propOr:ae,propSatisfies:se,props:ue,range:he,reduce:Zr,reduceRight:le,reduced:ce,reject:Hr,remove:fe,repeat:Wr,replace:de,reverse:pe,scan:me,set:ve,slice:Xr,sort:_e,sortBy:ge,split:on,splitEvery:Yr,subtract:ye,sum:Kr,tail:$r,take:Qr,takeLast:Ci,takeLastWhile:xe,takeWhile:ti,tap:be,test:we,times:Se,toLower:an,toPairs:Me,toPairsIn:Ee,toString:$i,toUpper:sn,transduce:ei,trim:Te,type:ze,unapply:Ae,unary:Pe,uncurryN:Ie,unfold:Le,union:Qi,unionWith:ri,uniq:ii,uniqBy:tn,uniqWith:ke,unnest:ni,update:De,useWith:oi,values:Re,valuesIn:Oe,view:je,where:Ce,whereEq:ai,wrap:Be,xprod:Fe,zip:Ne,zipObj:qe,zipWith:Ue};"object"==typeof r?e.exports=un:"function"==typeof define&&define.amd?define(function(){return un}):this.R=un}).call(this)},{}],147:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var n=t,o=e,a=r;s=h=u=void 0,i=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(a)}var h=Object.getPrototypeOf(n);if(null===h)return void 0;t=h,e=o,r=a,i=!0}},u=t("ramda"),h=i(u),l=t("./util"),c=t("mapbox-gl"),f=i(c),d=t("./theme/edit"),p=i(d),m=t("./theme/style"),v=i(m),_=t("./store"),g=i(_),y=t("./geometries/line"),x=i(y),b=t("./geometries/point"),w=i(b),S=t("./geometries/square"),M=i(S),E=t("./geometries/polygon"),T=i(E),z=function(t){
function e(t){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),f["default"].util.setOptions(this,t),this.options={position:"top-left",keybindings:!0,geoJSON:[],controls:{marker:!0,line:!0,shape:!0,square:!0}},this.drag=this._drag.bind(this),this.onClick=this._onClick.bind(this),this.onKeyUp=this._onKeyUp.bind(this),this.endDrag=this._endDrag.bind(this),this.initiateDrag=this._initiateDrag.bind(this)}return o(e,t),a(e,[{key:"onAdd",value:function(t){var e=this._controlClass="mapboxgl-ctrl-draw-btn",r=this._container=l.DOM.create("div","mapboxgl-ctrl-group",t.getContainer()),i=this.options.controls;return this.options.geoJSON=new g["default"](this.options.geoJSON,t),i.line&&(this.lineStringCtrl=this._createButton({className:e+" line",title:"LineString tool "+(this.options.keybindings&&"(l)"),fn:this._drawLine.bind(this)})),i.shape&&(this.polygonCtrl=this._createButton({className:e+" shape",title:"Polygon tool "+(this.options.keybindings&&"(p)"),fn:this._drawPolygon.bind(this)})),i.square&&(this.squareCtrl=this._createButton({className:e+" square",title:"Square tool "+(this.options.keybindings&&"(s)"),fn:this._drawSquare.bind(this)})),i.marker&&(this.markerCtrl=this._createButton({className:e+" marker",title:"Marker tool "+(this.options.keybindings&&"(m)"),fn:this._drawPoint.bind(this)})),this.options.keybindings&&t.getContainer().addEventListener("keyup",this.onKeyUp),this._map=t,this._mapState(),r}},{key:"_onKeyUp",value:function(t){var e=document.createEvent("HTMLEvents");switch(e.initEvent("click",!0,!1),t.keyCode){case 76:this.lineStringCtrl.classList.contains("active")||this.lineStringCtrl.dispatchEvent(e);break;case 77:this.markerCtrl.classList.contains("active")||this.markerCtrl.dispatchEvent(e);break;case 80:this.polygonCtrl.classList.contains("active")||this.polygonCtrl.dispatchEvent(e);break;case 83:this.squareCtrl.classList.contains("active")||this.squareCtrl.dispatchEvent(e);break;case 27:this._finish();break;case 68:this.editId&&this._destroy(this.editId)}}},{key:"_onClick",value:function(t){var e=this;this._map.featuresAt(t.point,{radius:10,includeGeometry:!0},function(t,r){if(t)throw t;if(r.length){if(e._control&&!e.editId)return;if(e._control&&e.editId){if(r[0].properties._drawid===e.editId)return;e._control.completeEdit()}}else{if(!e._control&&!e.editId)return;if(e._control&&!e.editId)return;if(e._control&&e.editId)return e._control.completeEdit()}e._edit(r[0])})}},{key:"_edit",value:function(t){if(t.properties._drawid){this.editId=t.properties._drawid,t=this.options.geoJSON.edit(this.editId);var e=t.geometry.coordinates,r=t.geometry.type;"Point"===r?this._control=new w["default"](this._map,this.options.geoJSON,t):"LineString"===r?this._control=new x["default"](this._map,this.options.geoJSON,t):e[0][0][0]===e[0][1][0]?this._control=new M["default"](this._map,this.options.geoJSON,t):this._control=new T["default"](this._map,this.options.geoJSON,t),this._map.getContainer().addEventListener("mousedown",this.initiateDrag,!0),this.deleteBtn=this._createButton({className:"mapboxgl-ctrl-draw-btn trash",title:"delete "+r,fn:this._destroy.bind(this,this.editId)})}}},{key:"_finish",value:function(){this._control&&this.editId?this._control.completeEdit():this._control&&this._control.completeDraw()}},{key:"_exitEdit",value:function(){l.DOM.destroy(this.deleteBtn),this._map.getContainer().removeEventListener("mousedown",this.initiateDrag,!0),this.editId=!1,this._control=!1}},{key:"_initiateDrag",value:function(t){var e=this,r=l.DOM.mousePos(t,this._map._container);this._map.featuresAt([r.x,r.y],{radius:10,includeGeometry:!0},function(i,n){if(i)throw i;n.length&&n[0].properties._drawid===e.editId&&(t.stopPropagation(),n.length>1&&(e.vertex=h["default"].find(function(t){return"vertex"===t.properties.meta})(n),e.newVertex=h["default"].find(function(t){return"midpoint"===t.properties.meta})(n)),e.newVertex&&(e._control.editAddVertex(r,e.newVertex.properties.index),e.vertex=e.newVertex),e._map.getContainer().addEventListener("mousemove",e.drag,!0),e._map.getContainer().addEventListener("mouseup",e.endDrag,!0))})}},{key:"_drag",value:function(t){t.stopPropagation(),this.dragging||(this.dragging=!0,this.init=l.DOM.mousePos(t,this._map.getContainer()),this._map.getContainer().classList.add("mapboxgl-draw-move-activated"));var e=l.DOM.mousePos(t,this._map.getContainer());this.vertex?this._control.moveVertex(this.init,e,this.vertex.properties.index):this._control.translate(this.init,e)}},{key:"_endDrag",value:function(){this._map.getContainer().removeEventListener("mousemove",this.drag,!0),this._map.getContainer().removeEventListener("mouseup",this.endDrag,!0),this._map.getContainer().classList.remove("mapboxgl-draw-move-activated"),this._control.translating=!1,this.dragging=!1,this.vertex&&(this.vertex=!1,this._control.movingVertex=!1)}},{key:"_drawPolygon",value:function(){this._finish(),this._control=new T["default"](this._map,this.options.geoJSON),this._control.startDraw()}},{key:"_drawLine",value:function(){this._finish(),this._control=new x["default"](this._map,this.options.geoJSON),this._control.startDraw()}},{key:"_drawSquare",value:function(){this._finish(),this._control=new M["default"](this._map,this.options.geoJSON),this._control.startDraw()}},{key:"_drawPoint",value:function(){this._finish(),this._control=new w["default"](this._map,this.options.geoJSON),this._control.startDraw()}},{key:"_destroy",value:function(t){this._control.store.clear(),this.options.geoJSON.unset(t),this._exitEdit()}},{key:"addGeometry",value:function(t){this.options.geoJSON.set(t)}},{key:"removeGeometry",value:function(t){this.options.geoJSON.unset(t)}},{key:"get",value:function(t){return this.options.geoJSON.get(t)}},{key:"getAll",value:function(){return this.options.geoJSON.getAll()}},{key:"clear",value:function(){this.options.geoJSON.clear()}},{key:"clearAll",value:function(){this.options.geoJSON.clearAll()}},{key:"_createButton",value:function(t){var e=this,r=l.DOM.create("button",t.className,this._container,{title:t.title});return r.addEventListener("click",function(r){r.preventDefault(),r.stopPropagation();var i=r.target;e._control&&!e.editId&&e._control.completeDraw(),i.classList.contains("active")?i.classList.remove("active"):(l.DOM.removeClass(document.querySelectorAll("."+e._controlClass),"active"),i.classList.add("active"),t.fn())},!0),r}},{key:"_mapState",value:function(){var t=this,e=this._controlClass;this._map.on("load",function(){var r=new f["default"].GeoJSONSource({data:t.options.geoJSON.getAll()});t._map.addSource("draw",r),v["default"].forEach(function(e){t._map.addLayer(e)});var i=new f["default"].GeoJSONSource({data:[]});t._map.addSource("edit",i),p["default"].forEach(function(e){t._map.addLayer(e)}),t._map.on("draw.end",function(){l.DOM.removeClass(document.querySelectorAll("."+e),"active"),t._control=!1}),t._map.on("edit.end",t._exitEdit.bind(t)),t._map.on("edit.feature.update",function(t){i.setData(t.geojson)}),t._map.on("draw.feature.update",function(t){r.setData(t.geojson)}),t._map.on("click",t.onClick)})}}]),e}(f["default"].Control);r["default"]=z,e.exports=r["default"]},{"./geometries/line":150,"./geometries/point":151,"./geometries/polygon":152,"./geometries/square":153,"./store":154,"./theme/edit":155,"./theme/style":156,"./util":157,"mapbox-gl":29,ramda:146}],148:[function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),o=function(){function t(e,r){var n=this;i(this,t),this._map=e,this.features=r,this.features[0].geometry.coordinates.length&&this.features.forEach(function(t){return n.update(t)})}return n(t,[{key:"getAll",value:function(){return{type:"FeatureCollection",features:this.features}}},{key:"getById",value:function(t){return this.features.filter(function(e){return e.properties._drawid===t})[0]}},{key:"clear",value:function(){this.features=[],this.render()}},{key:"update",value:function(t){this.features=this.features.filter(function(e){return e.properties._drawid!==t.properties._drawid}),this.features.push(t),this.render()}},{key:"_addVertices",value:function(){for(var t=[],e=0;e<this.features.length;e++){var r=this.features[e].geometry.coordinates,i=this.features[e].geometry.type;if("LineString"===i||"Polygon"===i){r="Polygon"===i?r[0]:r;for(var n="LineString"===i?r.length:r.length-1,o=0;n>o;o++)t.push({type:"Feature",properties:{meta:"vertex",index:o},geometry:{type:"Point",coordinates:r[o]}})}}return t}},{key:"_addMidpoints",value:function(){for(var t=[],e=0;e<this.features.length;e++){var r=this.features[e],i=r.geometry.coordinates;if("LineString"===r.geometry.type||"Polygon"===r.geometry.type&&i[0][0][0]!==i[0][1][0]){i="Polygon"===r.geometry.type?i[0]:i;for(var n=0;n<i.length-1;n++){var o=this._map.project([i[n][1],i[n][0]]),a=this._map.project([i[n+1][1],i[n+1][0]]),s=this._map.unproject([(o.x+a.x)/2,(o.y+a.y)/2]);t.push({type:"Feature",properties:{meta:"midpoint",index:n+1},geometry:{type:"Point",coordinates:[s.lng,s.lat]}})}}}return t}},{key:"render",value:function(){var t=this.getAll();t.features=t.features.concat(this._addVertices(),this._addMidpoints()),this._map.fire("edit.feature.update",{geojson:t})}}]),t}();r["default"]=o,e.exports=r["default"]},{}],149:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),a=t("immutable"),s=i(a),u=t("../edit_store"),h=i(u),l=t("../util"),c=function(){function t(e,r,i,o){n(this,t),this._map=e,this.drawStore=r,this.coordinates=s["default"].fromJS(o?o.geometry.coordinates:[]),this.feature=s["default"].fromJS({type:"Feature",properties:{_drawid:o?o.properties._drawid:null},geometry:{type:i,coordinates:this.coordinates.toJS()}}),this.store=new h["default"](this._map,[this.feature.toJS()])}return o(t,[{key:"get",value:function(){return this.feature.toJS()}},{key:"_done",value:function(t){this.store.clear(),this.drawStore.set(this.feature.toJS()),this._map.fire("draw.end",{featureType:t})}},{key:"completeEdit",value:function(){this.store.clear(),this.drawStore.set(this.feature.toJS()),this._map.fire("edit.end")}},{key:"translate",value:function(t,e){this.translating||(this.translating=!0,this.initGeom=s["default"].fromJS(this.feature.toJS())),this.feature=s["default"].fromJS(l.translate(this.initGeom.toJS(),t,e,this._map)),this.store.update(this.feature.toJS())}}]),t}();r["default"]=c,e.exports=r["default"]},{"../edit_store":148,"../util":157,immutable:7}],150:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var n=t,o=e,a=r;s=h=u=void 0,i=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(a)}var h=Object.getPrototypeOf(n);if(null===h)return void 0;t=h,e=o,r=a,i=!0}},u=t("./geometry"),h=i(u),l=t("immutable"),c=i(l),f=t("../util"),d=function(t){function e(t,r,i){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r,"LineString",i),this.addPoint=this._addPoint.bind(this),this.onMouseMove=this._onMouseMove.bind(this),this.completeDraw=this._completeDraw.bind(this)}return o(e,t),a(e,[{key:"startDraw",value:function(){this._map.fire("draw.start",{featureType:"line"}),this._map.getContainer().classList.add("mapboxgl-draw-activated"),this._map.on("click",this.addPoint),this._map.on("dblclick",this.completeDraw)}},{key:"_addPoint",value:function(t){var e=[t.latLng.lng,t.latLng.lat];this.editting||(this.editting=!0,this.coordinates=this.coordinates.push(e),this._map.getContainer().addEventListener("mousemove",this.onMouseMove)),this.coordinates=this.coordinates.splice(-1,1,e),this.coordinates=this.coordinates.push(e),this.feature=this.feature.setIn(["geometry","coordinates"],this.coordinates),this.store.update(this.feature.toJS())}},{key:"_onMouseMove",value:function(t){var e=f.DOM.mousePos(t,this._map._container),r=this._map.unproject([e.x,e.y]),i=this.coordinates;i=i.splice(-1,1,[r.lng,r.lat]),this.store.update(this.feature.setIn(["geometry","coordinates"],i).toJS())}},{key:"_completeDraw",value:function(){this._map.getContainer().classList.remove("mapboxgl-draw-activated"),this._map.off("click",this.addPoint),this._map.off("dblclick",this.completeDraw),this._map.getContainer().removeEventListener("mousemove",this.onMouseMove),this.coordinates=this.coordinates.splice(-1,1),this.feature=this.feature.setIn(["geometry","coordinates"],this.coordinates),this._done("line")}},{key:"moveVertex",value:function(t,e,r){this.movingVertex||(this.movingVertex=!0,this.initCoords=this.feature.getIn(["geometry","coordinates",r]));var i=e.x-t.x,n=e.y-t.y,o=f.translatePoint(this.initCoords.toJS(),i,n,this._map);this.feature=this.feature.setIn(["geometry","coordinates",r],c["default"].fromJS(o)),this.store.update(this.feature.toJS())}},{key:"editAddVertex",value:function(t,e){t=this._map.unproject(t);var r=this.feature.getIn(["geometry","coordinates"]).splice(e,0,c["default"].fromJS([t.lng,t.lat]));this.feature=this.feature.setIn(["geometry","coordinates"],r),this.store.update(this.feature.toJS())}}]),e}(h["default"]);r["default"]=d,e.exports=r["default"]},{"../util":157,"./geometry":149,immutable:7}],151:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var n=t,o=e,a=r;s=h=u=void 0,i=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(a)}var h=Object.getPrototypeOf(n);if(null===h)return void 0;t=h,e=o,r=a,i=!0}},u=t("./geometry"),h=i(u),l=function(t){function e(t,r,i){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r,"Point",i),this.completeDraw=this._completeDraw.bind(this)}return o(e,t),a(e,[{key:"startDraw",value:function(){this._map.fire("draw.start",{featureType:"point"}),this._map.getContainer().classList.add("mapboxgl-draw-activated"),this._map.on("click",this.completeDraw)}},{key:"_completeDraw",value:function(t){this._map.getContainer().classList.remove("mapboxgl-draw-activated"),this._map.off("click",this.completeDraw),this.feature=this.feature.setIn(["geometry","coordinates"],[t.latLng.lng,t.latLng.lat]),this._done("point")}}]),e}(h["default"]);r["default"]=l,e.exports=r["default"]},{"./geometry":149}],152:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var n=t,o=e,a=r;s=h=u=void 0,i=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(a)}var h=Object.getPrototypeOf(n);if(null===h)return void 0;t=h,e=o,r=a,i=!0}},u=t("immutable"),h=i(u),l=t("./geometry"),c=i(l),f=t("../util"),d=function(t){function e(t,r,i){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r,"Polygon",i),this.addVertex=this._addVertex.bind(this),this.onMouseMove=this._onMouseMove.bind(this),this.completeDraw=this._completeDraw.bind(this)}return o(e,t),a(e,[{key:"startDraw",value:function(){this._map.fire("draw.start",{featureType:"polygon"}),this._map.getContainer().classList.add("mapboxgl-draw-activated"),this._map.on("click",this.addVertex),this._map.on("dblclick",this.completeDraw)}},{key:"_addVertex",value:function(t){var e=[t.latLng.lng,t.latLng.lat];if(this.editting){var r=this.coordinates.get(0).splice(-1,0,e);this.coordinates=this.coordinates.set(0,r)}else this.editting=!0,this.coordinates=h["default"].fromJS([[e,e]]),this._map.getContainer().addEventListener("mousemove",this.onMouseMove);this.feature=this.feature.setIn(["geometry","coordinates"],this.coordinates),this.store.update(this.feature.toJS())}},{key:"_onMouseMove",value:function(t){var e=f.DOM.mousePos(t,this._map._container),r=this._map.unproject([e.x,e.y]),i=this.coordinates.get(0).splice(-1,0,[r.lng,r.lat]),n=this.coordinates.set(0,i);this.store.update(this.feature.setIn(["geometry","coordinates"],n).toJS())}},{key:"_completeDraw",value:function(){this._map.getContainer().classList.remove("mapboxgl-draw-activated"),this._map.off("click",this.addVertex),this._map.off("dblclick",this.completeDraw),this._map.getContainer().removeEventListener("mousemove",this.onMouseMove),this._map.getContainer().classList.remove("mapboxgl-draw-activated"),this._done("polygon")}},{key:"moveVertex",value:function(t,e,r){this.movingVertex||(this.movingVertex=!0,this.initCoords=this.feature.getIn(["geometry","coordinates",0,r]));var i=e.x-t.x,n=e.y-t.y,o=f.translatePoint(this.initCoords.toJS(),i,n,this._map);this.feature=this.feature.setIn(["geometry","coordinates",0,r],h["default"].fromJS(o)),0===r&&(this.feature=this.feature.setIn(["geometry","coordinates",0,-1],h["default"].fromJS(o))),this.store.update(this.feature.toJS())}},{key:"editAddVertex",value:function(t,e){t=this._map.unproject(t);var r=this.feature.getIn(["geometry","coordinates",0]).splice(e,0,h["default"].fromJS([t.lng,t.lat]));this.feature=this.feature.setIn(["geometry","coordinates",0],r),this.store.update(this.feature.toJS())}}]),e}(c["default"]);r["default"]=d,e.exports=r["default"]},{"../util":157,"./geometry":149,immutable:7}],153:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function(t,e,r){for(var i=!0;i;){var n=t,o=e,a=r;s=h=u=void 0,i=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(a)}var h=Object.getPrototypeOf(n);if(null===h)return void 0;t=h,e=o,r=a,i=!0}},u=t("./geometry"),h=i(u),l=t("immutable"),c=i(l),f=t("../util"),d=function(t){function e(t,r,i){n(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r,"Polygon",i),this.onMouseDown=this._onMouseDown.bind(this),this.onMouseMove=this._onMouseMove.bind(this),this.completeDraw=this._completeDraw.bind(this)}return o(e,t),a(e,[{key:"startDraw",value:function(){this._map.fire("draw.start",{featureType:"square"}),this._map.getContainer().classList.add("mapboxgl-draw-activated"),this._map.getContainer().addEventListener("mousedown",this.onMouseDown,!0)}},{key:"_onMouseDown",value:function(t){this._map.getContainer().removeEventListener("mousedown",this.onMouseDown,!0),this._map.getContainer().addEventListener("mousemove",this.onMouseMove,!0);for(var e=f.DOM.mousePos(t,this._map._container),r=this._map.unproject([e.x,e.y]),i=[],n=-1;++n<5;)i.push([r.lng,r.lat]);this.coordinates=this.coordinates.push(c["default"].fromJS(i))}},{key:"_onMouseMove",value:function(t){t.stopPropagation(),t.preventDefault(),this.started||(this.started=!0,this._map.getContainer().addEventListener("mouseup",this.completeDraw,!0));var e=f.DOM.mousePos(t,this._map._container),r=this._map.unproject([e.x,e.y]),i=this.coordinates.get(0).get(0);this.coordinates=this.coordinates.setIn([0,1],[i.get(0),r.lat]),this.coordinates=this.coordinates.setIn([0,2],[r.lng,r.lat]),this.coordinates=this.coordinates.setIn([0,3],[r.lng,i.get(1)]),this.feature=this.feature.setIn(["geometry","coordinates"],this.coordinates),this.store.update(this.feature.toJS())}},{key:"_completeDraw",value:function(){this._map.getContainer().classList.remove("mapboxgl-draw-activated"),this._map.getContainer().removeEventListener("mousemove",this.onMouseMove,!0),this._map.getContainer().removeEventListener("mouseup",this.completeDraw,!0),this._done("square")}},{key:"moveVertex",value:function(t,e,r){this.movingVertex||(this.movingVertex=!0,this.initCoords=this.feature.getIn(["geometry","coordinates",0,r]));var i=e.x-t.x,n=e.y-t.y,o=f.translatePoint(this.initCoords.toJS(),i,n,this._map);this.feature=this.feature.setIn(["geometry","coordinates",0,r],c["default"].fromJS(o));var a=o[0],s=o[1];switch(r){case 0:this.feature=this._setV(1,[a,this._getV(1).get(1)]),this.feature=this._setV(3,[this._getV(3).get(0),s]);break;case 1:this.feature=this._setV(0,[a,this._getV(0).get(1)]),this.feature=this._setV(2,[this._getV(2).get(0),s]);break;case 2:this.feature=this._setV(1,[this._getV(1).get(0),s]),this.feature=this._setV(3,[a,this._getV(3).get(1)]);break;case 3:this.feature=this._setV(0,[this._getV(0).get(0),s]),this.feature=this._setV(2,[a,this._getV(2).get(1)])}this.feature=this._setV(4,this._getV(0).toJS()),this.store.update(this.feature.toJS())}},{key:"_setV",value:function(t,e){return this.feature.setIn(["geometry","coordinates",0,t],c["default"].fromJS(e))}},{key:"_getV",value:function(t){return this.feature.getIn(["geometry","coordinates",0,t])}}]),e}(h["default"]);r["default"]=d,e.exports=r["default"]},{"../util":157,"./geometry":149,immutable:7}],154:[function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),a=t("immutable"),s=i(a),u=t("hat"),h=i(u),l=function(){function t(e,r){var i=this;n(this,t),this._map=r,this.historyIndex=0,this.history=[s["default"].List([])],this.annotations=s["default"].List([]),e.length&&e.forEach(function(t){t.properties._drawid=h["default"](),i.history[0]=i.history[0].push(s["default"].fromJS(t))})}return o(t,[{key:"operation",value:function(t,e){this.annotations=this.annotations.slice(0,this.historyIndex+1),this.history=this.history.slice(0,this.historyIndex+1);var r=t(this.history[this.historyIndex]);this.history.push(r),this.annotations=this.annotations.push(e),this.historyIndex++,this.render()}},{key:"getAll",value:function(){return{type:"FeatureCollection",features:this.history[this.historyIndex].toJS()}}},{key:"get",value:function(t){return this.history[this.historyIndex].find(function(e){return e.get("properties").get("_drawid")===t}).toJS()}},{key:"clear",value:function(){this.operation(function(){return s["default"].List([])},"remove all geometries")}},{key:"clearAll",value:function(){this.historyIndex=0,this.history=[s["default"].fromJS([])],this.annotations=s["default"].List([])}},{key:"unset",value:function(t){this.operation(function(e){return e.filterNot(function(e){return e.get("properties")._drawid===t})},"Removed a feature")}},{key:"set",value:function(t){var e=this;this.operation(function(r){t=s["default"].fromJS(t),t=t.setIn(["properties","_drawid"],h["default"]());var i=e.history[e.historyIndex].findIndex(function(e){return e.get("properties")._drawid===t.get("properties").get("_drawid")});return i>-1?r.set(i,t):r.push(t)},"Added a "+t.geometry.type)}},{key:"edit",value:function(t){this.history.push(this.history[this.historyIndex++]);var e=this.historyIndex,r=this.history[e].find(function(e){return e.get("properties").get("_drawid")===t});return this.history[e]=this.history[e].filterNot(function(e){return e.get("properties").get("_drawid")===t}),this.render(),r.toJS()}},{key:"render",value:function(){this._map.fire("draw.feature.update",{geojson:this.getAll()})}},{key:"redo",value:function(){this.historyIndex<this.history.length&&this.historyIndex++}},{key:"undo",value:function(){this.historyIndex>0&&this.historyIndex--}}]),t}();r["default"]=l,e.exports=r["default"]},{hat:6,immutable:7}],155:[function(t,e,r){"use strict";e.exports=[{id:"gl-edit-line",type:"line",source:"edit",filter:["all",["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000000","line-dasharray":[0,2],"line-width":3},interactive:!0},{id:"gl-edit-polygon",type:"fill",source:"edit",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":"#000000","fill-opacity":.25},interactive:!0},{id:"gl-edit-polygon-stroke",type:"line",source:"edit",filter:["all",["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000000","line-dasharray":[2,2],"line-width":3},interactive:!0},{id:"gl-edit-points",type:"symbol",source:"edit",filter:["all",["==","$type","Point"],["!=","meta","midpoint"]],layout:{"icon-image":"circle.sdf","text-anchor":"top","icon-allow-overlap":!0},paint:{"icon-color":"#ffffff","icon-halo-color":"#000000","icon-halo-width":2,"icon-size":1.1},interactive:!0},{id:"gl-edit-points-mid",type:"symbol",source:"edit",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],layout:{"icon-image":"circle.sdf","text-anchor":"top","icon-allow-overlap":!0},paint:{"icon-color":"#000000","icon-size":1},interactive:!0}]},{}],156:[function(t,e,r){"use strict";e.exports=[{id:"gl-draw-polygons",type:"fill",source:"draw",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":"#ff00ff","fill-outline-color":"#ff00ff","fill-opacity":.25},interactive:!0},{id:"gl-draw-polygon-stroke",type:"line",source:"draw",filter:["all",["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ff00ff","line-width":2},interactive:!0},{id:"gl-draw-line",type:"line",source:"draw",filter:["all",["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ff00ff","line-width":2},interactive:!0},{id:"gl-draw-points",type:"symbol",source:"draw",filter:["all",["==","$type","Point"]],layout:{"icon-image":"circle.sdf","text-anchor":"top","icon-allow-overlap":!0},paint:{"icon-color":"#ff00ff","icon-size":1},interactive:!0}]},{}],157:[function(t,e,r){"use strict";function i(t){for(var e=0;e<t.length;e++)if(t[e]in o)return t[e]}var n=t("mapbox-gl");e.exports.DOM={},e.exports.DOM.mousePos=function(t,e){var r=e.getBoundingClientRect();return new n.Point(t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop)},e.exports.DOM.create=function(t,e,r,i){var n=document.createElement(t);if(e&&(n.className=e),i)for(var o in i)n.setAttribute(o,i[o]);return r&&r.appendChild(n),n},e.exports.DOM.destroy=function(t){t.parentElement.removeChild(t)},e.exports.DOM.removeClass=function(t,e){Array.prototype.forEach.call(t,function(t){t.classList.remove(e)})};var o=document.documentElement.style,a=i(["transform","WebkitTransform"]);e.exports.DOM.setTransform=function(t,e){t.style[a]=e};var s,u=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);e.exports.DOM.disableSelection=function(){u&&(s=o[u],o[u]="none")},e.exports.DOM.enableSelection=function(){u&&(o[u]=s)},e.exports.translate=function(t,e,r,i){var n=r.x-e.x,o=r.y-e.y,a=t.geometry;return"Polygon"===a.type?a.coordinates=a.coordinates.map(function(t){return t.map(function(t){return h(t,n,o,i)})}):"LineString"===a.type?a.coordinates=a.coordinates.map(function(t){return h(t,n,o,i)}):a.coordinates=h(a.coordinates,n,o,i),t.geometry=a,t};var h=function(t,e,r,i){var n=i.project([t[1],t[0]]);return n=i.unproject([n.x+e,n.y+r]),[n.lng,n.lat]};e.exports.translatePoint=h},{"mapbox-gl":29}]},{},[1]);
